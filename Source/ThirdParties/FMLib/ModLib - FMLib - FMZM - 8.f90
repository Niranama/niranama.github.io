
 MODULE ModLib_FMZM_8
    USE ModLib_FMZM_1

    INTERFACE OPERATOR (**)
       MODULE PROCEDURE FMPWR_IFM
       MODULE PROCEDURE FMPWR_IIM
       MODULE PROCEDURE FMPWR_IZM
       MODULE PROCEDURE FMPWR_RFM
       MODULE PROCEDURE FMPWR_RIM
       MODULE PROCEDURE FMPWR_RZM
       MODULE PROCEDURE FMPWR_DFM
       MODULE PROCEDURE FMPWR_DIM
       MODULE PROCEDURE FMPWR_DZM
       MODULE PROCEDURE FMPWR_ZFM
       MODULE PROCEDURE FMPWR_ZIM
       MODULE PROCEDURE FMPWR_ZZM
       MODULE PROCEDURE FMPWR_CFM
       MODULE PROCEDURE FMPWR_CIM
       MODULE PROCEDURE FMPWR_CZM
       MODULE PROCEDURE FMPWR_FMI
       MODULE PROCEDURE FMPWR_FMR
       MODULE PROCEDURE FMPWR_FMD
       MODULE PROCEDURE FMPWR_FMZ
       MODULE PROCEDURE FMPWR_FMC
       MODULE PROCEDURE FMPWR_FMFM
       MODULE PROCEDURE FMPWR_FMIM
       MODULE PROCEDURE FMPWR_FMZM
       MODULE PROCEDURE FMPWR_IMI
       MODULE PROCEDURE FMPWR_IMR
       MODULE PROCEDURE FMPWR_IMD
       MODULE PROCEDURE FMPWR_IMZ
       MODULE PROCEDURE FMPWR_IMC
       MODULE PROCEDURE FMPWR_IMFM
       MODULE PROCEDURE FMPWR_IMIM
       MODULE PROCEDURE FMPWR_IMZM
       MODULE PROCEDURE FMPWR_ZMI
       MODULE PROCEDURE FMPWR_ZMR
       MODULE PROCEDURE FMPWR_ZMD
       MODULE PROCEDURE FMPWR_ZMZ
       MODULE PROCEDURE FMPWR_ZMC
       MODULE PROCEDURE FMPWR_ZMFM
       MODULE PROCEDURE FMPWR_ZMIM
       MODULE PROCEDURE FMPWR_ZMZM
    END INTERFACE

   INTERFACE ABS
      MODULE PROCEDURE FMABS_FM
      MODULE PROCEDURE FMABS_IM
      MODULE PROCEDURE FMABS_ZM
      MODULE PROCEDURE FMABS_FM1
      MODULE PROCEDURE FMABS_IM1
      MODULE PROCEDURE FMABS_ZM1
      MODULE PROCEDURE FMABS_FM2
      MODULE PROCEDURE FMABS_IM2
      MODULE PROCEDURE FMABS_ZM2
   END INTERFACE

   INTERFACE ACOS
      MODULE PROCEDURE FMACOS_FM
      MODULE PROCEDURE FMACOS_ZM
      MODULE PROCEDURE FMACOS_FM1
      MODULE PROCEDURE FMACOS_ZM1
      MODULE PROCEDURE FMACOS_FM2
      MODULE PROCEDURE FMACOS_ZM2
   END INTERFACE

   INTERFACE ACOSH
      MODULE PROCEDURE FMACOSH_FM
      MODULE PROCEDURE FMACOSH_ZM
      MODULE PROCEDURE FMACOSH_FM1
      MODULE PROCEDURE FMACOSH_ZM1
      MODULE PROCEDURE FMACOSH_FM2
      MODULE PROCEDURE FMACOSH_ZM2
   END INTERFACE

   INTERFACE AIMAG
      MODULE PROCEDURE FMAIMAG_ZM
      MODULE PROCEDURE FMAIMAG_ZM1
      MODULE PROCEDURE FMAIMAG_ZM2
   END INTERFACE

   INTERFACE AINT
      MODULE PROCEDURE FMAINT_FM
      MODULE PROCEDURE FMAINT_ZM
      MODULE PROCEDURE FMAINT_FM1
      MODULE PROCEDURE FMAINT_ZM1
      MODULE PROCEDURE FMAINT_FM2
      MODULE PROCEDURE FMAINT_ZM2
   END INTERFACE

   INTERFACE ANINT
      MODULE PROCEDURE FMANINT_FM
      MODULE PROCEDURE FMANINT_ZM
      MODULE PROCEDURE FMANINT_FM1
      MODULE PROCEDURE FMANINT_ZM1
      MODULE PROCEDURE FMANINT_FM2
      MODULE PROCEDURE FMANINT_ZM2
   END INTERFACE

   INTERFACE ASIN
      MODULE PROCEDURE FMASIN_FM
      MODULE PROCEDURE FMASIN_ZM
      MODULE PROCEDURE FMASIN_FM1
      MODULE PROCEDURE FMASIN_ZM1
      MODULE PROCEDURE FMASIN_FM2
      MODULE PROCEDURE FMASIN_ZM2
   END INTERFACE

   INTERFACE ASINH
      MODULE PROCEDURE FMASINH_FM
      MODULE PROCEDURE FMASINH_ZM
      MODULE PROCEDURE FMASINH_FM1
      MODULE PROCEDURE FMASINH_ZM1
      MODULE PROCEDURE FMASINH_FM2
      MODULE PROCEDURE FMASINH_ZM2
   END INTERFACE

   INTERFACE ATAN
      MODULE PROCEDURE FMATAN_FM
      MODULE PROCEDURE FMATAN2_FM
      MODULE PROCEDURE FMATAN_ZM
      MODULE PROCEDURE FMATAN_FM1
      MODULE PROCEDURE FMATAN_ZM1
      MODULE PROCEDURE FMATAN_FM2
      MODULE PROCEDURE FMATAN_ZM2
   END INTERFACE

   INTERFACE ATANH
      MODULE PROCEDURE FMATANH_FM
      MODULE PROCEDURE FMATANH_ZM
      MODULE PROCEDURE FMATANH_FM1
      MODULE PROCEDURE FMATANH_ZM1
      MODULE PROCEDURE FMATANH_FM2
      MODULE PROCEDURE FMATANH_ZM2
   END INTERFACE

   INTERFACE ATAN2
      MODULE PROCEDURE FMATAN2_FM
   END INTERFACE

   INTERFACE BTEST
      MODULE PROCEDURE FMBTEST_IM
   END INTERFACE

   INTERFACE CEILING
      MODULE PROCEDURE FMCEILING_FM
      MODULE PROCEDURE FMCEILING_IM
      MODULE PROCEDURE FMCEILING_ZM
      MODULE PROCEDURE FMCEILING_FM1
      MODULE PROCEDURE FMCEILING_IM1
      MODULE PROCEDURE FMCEILING_ZM1
      MODULE PROCEDURE FMCEILING_FM2
      MODULE PROCEDURE FMCEILING_IM2
      MODULE PROCEDURE FMCEILING_ZM2
   END INTERFACE

   INTERFACE CMPLX
      MODULE PROCEDURE FMCMPLX_FM
      MODULE PROCEDURE FMCMPLX_IM
   END INTERFACE

   INTERFACE CONJG
      MODULE PROCEDURE FMCONJG_ZM
      MODULE PROCEDURE FMCONJG_ZM1
      MODULE PROCEDURE FMCONJG_ZM2
   END INTERFACE

   INTERFACE COS
      MODULE PROCEDURE FMCOS_FM
      MODULE PROCEDURE FMCOS_ZM
      MODULE PROCEDURE FMCOS_FM1
      MODULE PROCEDURE FMCOS_ZM1
      MODULE PROCEDURE FMCOS_FM2
      MODULE PROCEDURE FMCOS_ZM2
   END INTERFACE

   INTERFACE COSH
      MODULE PROCEDURE FMCOSH_FM
      MODULE PROCEDURE FMCOSH_ZM
      MODULE PROCEDURE FMCOSH_FM1
      MODULE PROCEDURE FMCOSH_ZM1
      MODULE PROCEDURE FMCOSH_FM2
      MODULE PROCEDURE FMCOSH_ZM2
   END INTERFACE

   INTERFACE DBLE
      MODULE PROCEDURE FMDBLE_FM
      MODULE PROCEDURE FMDBLE_IM
      MODULE PROCEDURE FMDBLE_ZM
   END INTERFACE

   INTERFACE DIGITS
      MODULE PROCEDURE FMDIGITS_FM
      MODULE PROCEDURE FMDIGITS_IM
      MODULE PROCEDURE FMDIGITS_ZM
   END INTERFACE

   INTERFACE DIM
      MODULE PROCEDURE FMDIM_FM
      MODULE PROCEDURE FMDIM_IM
   END INTERFACE

   INTERFACE DINT
      MODULE PROCEDURE FMDINT_FM
      MODULE PROCEDURE FMDINT_ZM
   END INTERFACE

   INTERFACE DOT_PRODUCT
      MODULE PROCEDURE FMDOTPRODUCT_FM
      MODULE PROCEDURE FMDOTPRODUCT_IM
      MODULE PROCEDURE FMDOTPRODUCT_ZM
   END INTERFACE

   INTERFACE EPSILON
      MODULE PROCEDURE FMEPSILON_FM
   END INTERFACE

   INTERFACE EXP
      MODULE PROCEDURE FMEXP_FM
      MODULE PROCEDURE FMEXP_ZM
      MODULE PROCEDURE FMEXP_FM1
      MODULE PROCEDURE FMEXP_ZM1
      MODULE PROCEDURE FMEXP_FM2
      MODULE PROCEDURE FMEXP_ZM2
   END INTERFACE

   INTERFACE EXPONENT
      MODULE PROCEDURE FMEXPONENT_FM
   END INTERFACE

   INTERFACE FLOOR
      MODULE PROCEDURE FMFLOOR_FM
      MODULE PROCEDURE FMFLOOR_IM
      MODULE PROCEDURE FMFLOOR_ZM
      MODULE PROCEDURE FMFLOOR_FM1
      MODULE PROCEDURE FMFLOOR_IM1
      MODULE PROCEDURE FMFLOOR_ZM1
      MODULE PROCEDURE FMFLOOR_FM2
      MODULE PROCEDURE FMFLOOR_IM2
      MODULE PROCEDURE FMFLOOR_ZM2
   END INTERFACE

   INTERFACE FRACTION
      MODULE PROCEDURE FMFRACTION_FM
      MODULE PROCEDURE FMFRACTION_ZM
      MODULE PROCEDURE FMFRACTION_FM1
      MODULE PROCEDURE FMFRACTION_ZM1
      MODULE PROCEDURE FMFRACTION_FM2
      MODULE PROCEDURE FMFRACTION_ZM2
   END INTERFACE

   INTERFACE HUGE
      MODULE PROCEDURE FMHUGE_FM
      MODULE PROCEDURE FMHUGE_IM
      MODULE PROCEDURE FMHUGE_ZM
   END INTERFACE

   INTERFACE HYPOT
      MODULE PROCEDURE FMHYPOT_FM
   END INTERFACE

   INTERFACE INT
      MODULE PROCEDURE FMINT_FM
      MODULE PROCEDURE FMINT_IM
      MODULE PROCEDURE FMINT_ZM
      MODULE PROCEDURE FMINT_FM1
      MODULE PROCEDURE FMINT_IM1
      MODULE PROCEDURE FMINT_ZM1
      MODULE PROCEDURE FMINT_FM2
      MODULE PROCEDURE FMINT_IM2
      MODULE PROCEDURE FMINT_ZM2
   END INTERFACE

   INTERFACE LOG
      MODULE PROCEDURE FMLOG_FM
      MODULE PROCEDURE FMLOG_ZM
      MODULE PROCEDURE FMLOG_FM1
      MODULE PROCEDURE FMLOG_ZM1
      MODULE PROCEDURE FMLOG_FM2
      MODULE PROCEDURE FMLOG_ZM2
   END INTERFACE

   INTERFACE LOG10
      MODULE PROCEDURE FMLOG10_FM
      MODULE PROCEDURE FMLOG10_ZM
      MODULE PROCEDURE FMLOG10_FM1
      MODULE PROCEDURE FMLOG10_ZM1
      MODULE PROCEDURE FMLOG10_FM2
      MODULE PROCEDURE FMLOG10_ZM2
   END INTERFACE

   INTERFACE MATMUL
      MODULE PROCEDURE FMMATMUL22_FM
      MODULE PROCEDURE FMMATMUL12_FM
      MODULE PROCEDURE FMMATMUL21_FM
      MODULE PROCEDURE FMMATMUL22_IM
      MODULE PROCEDURE FMMATMUL12_IM
      MODULE PROCEDURE FMMATMUL21_IM
      MODULE PROCEDURE FMMATMUL22_ZM
      MODULE PROCEDURE FMMATMUL12_ZM
      MODULE PROCEDURE FMMATMUL21_ZM
   END INTERFACE

   INTERFACE MAX
      MODULE PROCEDURE FMMAX_FM
      MODULE PROCEDURE FMMAX_IM
   END INTERFACE

   INTERFACE MAXEXPONENT
      MODULE PROCEDURE FMMAXEXPONENT_FM
   END INTERFACE

   INTERFACE MAXLOC
      MODULE PROCEDURE FMMAXLOC1_FM
      MODULE PROCEDURE FMMAXLOC2_FM
      MODULE PROCEDURE FMMAXLOC1_IM
      MODULE PROCEDURE FMMAXLOC2_IM
   END INTERFACE

   INTERFACE MAXVAL
      MODULE PROCEDURE FMMAXVAL1_FM
      MODULE PROCEDURE FMMAXVAL2_FM
      MODULE PROCEDURE FMMAXVAL1_IM
      MODULE PROCEDURE FMMAXVAL2_IM
   END INTERFACE

   INTERFACE MIN
      MODULE PROCEDURE FMMIN_FM
      MODULE PROCEDURE FMMIN_IM
   END INTERFACE

   INTERFACE MINEXPONENT
      MODULE PROCEDURE FMMINEXPONENT_FM
   END INTERFACE

   INTERFACE MINLOC
      MODULE PROCEDURE FMMINLOC1_FM
      MODULE PROCEDURE FMMINLOC2_FM
      MODULE PROCEDURE FMMINLOC1_IM
      MODULE PROCEDURE FMMINLOC2_IM
   END INTERFACE

   INTERFACE MINVAL
      MODULE PROCEDURE FMMINVAL1_FM
      MODULE PROCEDURE FMMINVAL2_FM
      MODULE PROCEDURE FMMINVAL1_IM
      MODULE PROCEDURE FMMINVAL2_IM
   END INTERFACE

   INTERFACE MOD
      MODULE PROCEDURE FMMOD_FM
      MODULE PROCEDURE FMMOD_IM
   END INTERFACE

   INTERFACE MODULO
      MODULE PROCEDURE FMMODULO_FM
      MODULE PROCEDURE FMMODULO_IM
   END INTERFACE

   INTERFACE NEAREST
      MODULE PROCEDURE FMNEAREST_FM
   END INTERFACE

   INTERFACE NINT
      MODULE PROCEDURE FMNINT_FM
      MODULE PROCEDURE FMNINT_IM
      MODULE PROCEDURE FMNINT_ZM
      MODULE PROCEDURE FMNINT_FM1
      MODULE PROCEDURE FMNINT_IM1
      MODULE PROCEDURE FMNINT_ZM1
      MODULE PROCEDURE FMNINT_FM2
      MODULE PROCEDURE FMNINT_IM2
      MODULE PROCEDURE FMNINT_ZM2
   END INTERFACE

   INTERFACE NORM2
      MODULE PROCEDURE FMNORM21_FM
   END INTERFACE

   INTERFACE PRECISION
      MODULE PROCEDURE FMPRECISION_FM
      MODULE PROCEDURE FMPRECISION_ZM
   END INTERFACE

   INTERFACE PRODUCT
      MODULE PROCEDURE FMPRODUCT1_FM
      MODULE PROCEDURE FMPRODUCT2_FM
      MODULE PROCEDURE FMPRODUCT1_IM
      MODULE PROCEDURE FMPRODUCT2_IM
      MODULE PROCEDURE FMPRODUCT1_ZM
      MODULE PROCEDURE FMPRODUCT2_ZM
   END INTERFACE

   INTERFACE RADIX
      MODULE PROCEDURE FMRADIX_FM
      MODULE PROCEDURE FMRADIX_IM
      MODULE PROCEDURE FMRADIX_ZM
   END INTERFACE

   INTERFACE RANGE
      MODULE PROCEDURE FMRANGE_FM
      MODULE PROCEDURE FMRANGE_IM
      MODULE PROCEDURE FMRANGE_ZM
   END INTERFACE

   INTERFACE REAL
      MODULE PROCEDURE FMREAL_FM
      MODULE PROCEDURE FMREAL_IM
      MODULE PROCEDURE FMREAL_ZM
   END INTERFACE

   INTERFACE RRSPACING
      MODULE PROCEDURE FMRRSPACING_FM
   END INTERFACE

   INTERFACE SCALE
      MODULE PROCEDURE FMSCALE_FM
      MODULE PROCEDURE FMSCALE_ZM
   END INTERFACE

   INTERFACE SETEXPONENT
      MODULE PROCEDURE FMSETEXPONENT_FM
   END INTERFACE

   INTERFACE SIGN
      MODULE PROCEDURE FMSIGN_FM
      MODULE PROCEDURE FMSIGN_IM
   END INTERFACE

 CONTAINS

!                                                                  **

   FUNCTION FMPWR_IFM(IVAL,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA,RETURN_VALUE
      INTEGER :: IVAL
      INTENT (IN) :: IVAL,MA
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMI2M(IVAL,MTLVFM)
      CALL FMPWR(MTLVFM,MA%MFM,RETURN_VALUE%MFM)
   END FUNCTION FMPWR_IFM

   FUNCTION FMPWR_IIM(IVAL,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA,RETURN_VALUE
      INTEGER :: IVAL
      INTENT (IN) :: IVAL,MA
      TYPE(MULTI), SAVE :: MTLVIM
      CALL FM_UNDEF_INP(MA)
      CALL IMI2M(IVAL,MTLVIM)
      CALL IMPWR(MTLVIM,MA%MIM,RETURN_VALUE%MIM)
   END FUNCTION FMPWR_IIM

   FUNCTION FMPWR_IZM(IVAL,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA,RETURN_VALUE
      INTEGER :: IVAL
      INTENT (IN) :: IVAL,MA
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FMI2M(IVAL,MTLVFM)
      CALL FMI2M(0,MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
      CALL ZMPWR(MTLVZM,MA%MZM,RETURN_VALUE%MZM)
   END FUNCTION FMPWR_IZM

   FUNCTION FMPWR_RFM(R,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA,RETURN_VALUE
      REAL :: R
      INTENT (IN) :: R,MA
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMSP2M(R,MTLVFM)
      CALL FMPWR(MTLVFM,MA%MFM,RETURN_VALUE%MFM)
   END FUNCTION FMPWR_RFM

   FUNCTION FMPWR_RIM(R,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: RETURN_VALUE
      TYPE (IM) :: MA
      REAL :: R
      INTENT (IN) :: R,MA
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMSP2M(R,MTLVFM)
      CALL IMI2FM(MA%MIM,MULVFM)
      CALL FMPWR(MTLVFM,MULVFM,RETURN_VALUE%MFM)
   END FUNCTION FMPWR_RIM

   FUNCTION FMPWR_RZM(R,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA,RETURN_VALUE
      REAL :: R
      INTENT (IN) :: R,MA
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FMSP2M(R,MTLVFM)
      CALL FMI2M(0,MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
      CALL ZMPWR(MTLVZM,MA%MZM,RETURN_VALUE%MZM)
   END FUNCTION FMPWR_RZM

   FUNCTION FMPWR_DFM(D,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA,RETURN_VALUE
      DOUBLE PRECISION :: D
      INTENT (IN) :: D,MA
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMDP2M(D,MTLVFM)
      CALL FMPWR(MTLVFM,MA%MFM,RETURN_VALUE%MFM)
   END FUNCTION FMPWR_DFM

   FUNCTION FMPWR_DIM(D,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: RETURN_VALUE
      TYPE (IM) :: MA
      DOUBLE PRECISION :: D
      INTENT (IN) :: D,MA
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMDP2M(D,MTLVFM)
      CALL IMI2FM(MA%MIM,MULVFM)
      CALL FMPWR(MTLVFM,MULVFM,RETURN_VALUE%MFM)
   END FUNCTION FMPWR_DIM

   FUNCTION FMPWR_DZM(D,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA,RETURN_VALUE
      DOUBLE PRECISION :: D
      INTENT (IN) :: D,MA
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FMDP2M(D,MTLVFM)
      CALL FMI2M(0,MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
      CALL ZMPWR(MTLVZM,MA%MZM,RETURN_VALUE%MZM)
   END FUNCTION FMPWR_DZM

   FUNCTION FMPWR_ZFM(Z,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: RETURN_VALUE
      TYPE (FM) :: MA
      COMPLEX :: Z
      INTENT (IN) :: Z,MA
      TYPE(MULTI), SAVE :: MULVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL ZMZ2M(Z,MTLVZM)
      CALL FMI2M(0,MULVFM)
      CALL ZMCMPX(MA%MFM,MULVFM,MULVZM)
      CALL ZMPWR(MTLVZM,MULVZM,RETURN_VALUE%MZM)
   END FUNCTION FMPWR_ZFM

   FUNCTION FMPWR_ZIM(Z,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: RETURN_VALUE
      TYPE (IM) :: MA
      COMPLEX :: Z
      INTENT (IN) :: Z,MA
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL ZMZ2M(Z,MTLVZM)
      CALL IMI2FM(MA%MIM,MTLVFM)
      CALL FMI2M(0,MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MULVZM)
      CALL ZMPWR(MTLVZM,MULVZM,RETURN_VALUE%MZM)
   END FUNCTION FMPWR_ZIM

   FUNCTION FMPWR_ZZM(Z,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA,RETURN_VALUE
      COMPLEX :: Z
      INTENT (IN) :: Z,MA
      TYPE(MULTI), SAVE :: MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL ZMZ2M(Z,MTLVZM)
      CALL ZMPWR(MTLVZM,MA%MZM,RETURN_VALUE%MZM)
   END FUNCTION FMPWR_ZZM

   FUNCTION FMPWR_CFM(C,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: RETURN_VALUE
      TYPE (FM) :: MA
      COMPLEX (KIND(0.0D0)) :: C
      INTENT (IN) :: C,MA
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FMDP2M(REAL(C,KIND(0.0D0)),MTLVFM)
      CALL FMDP2M(AIMAG(C),MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
      CALL FMI2M(0,MULVFM)
      CALL ZMCMPX(MA%MFM,MULVFM,MULVZM)
      CALL ZMPWR(MTLVZM,MULVZM,RETURN_VALUE%MZM)
   END FUNCTION FMPWR_CFM

   FUNCTION FMPWR_CIM(C,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: RETURN_VALUE
      TYPE (IM) :: MA
      COMPLEX (KIND(0.0D0)) :: C
      INTENT (IN) :: C,MA
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FMDP2M(REAL(C,KIND(0.0D0)),MTLVFM)
      CALL FMDP2M(AIMAG(C),MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
      CALL IMI2FM(MA%MIM,MTLVFM)
      CALL FMI2M(0,MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MULVZM)
      CALL ZMPWR(MTLVZM,MULVZM,RETURN_VALUE%MZM)
   END FUNCTION FMPWR_CIM

   FUNCTION FMPWR_CZM(C,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA,RETURN_VALUE
      COMPLEX (KIND(0.0D0)) :: C
      INTENT (IN) :: C,MA
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FMDP2M(REAL(C,KIND(0.0D0)),MTLVFM)
      CALL FMDP2M(AIMAG(C),MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
      CALL ZMPWR(MTLVZM,MA%MZM,RETURN_VALUE%MZM)
   END FUNCTION FMPWR_CZM

   FUNCTION FMPWR_FMI(MA,IVAL)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA,RETURN_VALUE
      INTEGER :: IVAL
      INTENT (IN) :: MA,IVAL
      CALL FM_UNDEF_INP(MA)
      CALL FMIPWR(MA%MFM,IVAL,RETURN_VALUE%MFM)
   END FUNCTION FMPWR_FMI

   FUNCTION FMPWR_FMR(MA,R)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA,RETURN_VALUE
      REAL :: R
      INTENT (IN) :: MA,R
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMSP2M(R,MTLVFM)
      CALL FMPWR(MA%MFM,MTLVFM,RETURN_VALUE%MFM)
   END FUNCTION FMPWR_FMR

   FUNCTION FMPWR_FMD(MA,D)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA,RETURN_VALUE
      DOUBLE PRECISION :: D
      INTENT (IN) :: MA,D
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMDP2M(D,MTLVFM)
      CALL FMPWR(MA%MFM,MTLVFM,RETURN_VALUE%MFM)
   END FUNCTION FMPWR_FMD

   FUNCTION FMPWR_FMZ(MA,Z)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: RETURN_VALUE
      TYPE (FM) :: MA
      COMPLEX :: Z
      INTENT (IN) :: MA,Z
      TYPE(MULTI), SAVE :: MULVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL ZMZ2M(Z,MTLVZM)
      CALL FMI2M(0,MULVFM)
      CALL ZMCMPX(MA%MFM,MULVFM,MULVZM)
      CALL ZMPWR(MULVZM,MTLVZM,RETURN_VALUE%MZM)
   END FUNCTION FMPWR_FMZ

   FUNCTION FMPWR_FMC(MA,C)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: RETURN_VALUE
      TYPE (FM) :: MA
      COMPLEX (KIND(0.0D0)) :: C
      INTENT (IN) :: MA,C
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FMDP2M(REAL(C,KIND(0.0D0)),MTLVFM)
      CALL FMDP2M(AIMAG(C),MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
      CALL FMI2M(0,MULVFM)
      CALL ZMCMPX(MA%MFM,MULVFM,MULVZM)
      CALL ZMPWR(MULVZM,MTLVZM,RETURN_VALUE%MZM)
   END FUNCTION FMPWR_FMC

   FUNCTION FMPWR_FMFM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA,MB,RETURN_VALUE
      INTENT (IN) :: MA,MB
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      CALL FMPWR(MA%MFM,MB%MFM,RETURN_VALUE%MFM)
   END FUNCTION FMPWR_FMFM

   FUNCTION FMPWR_FMIM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA,RETURN_VALUE
      TYPE (IM) :: MB
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      CALL IMI2FM(MB%MIM,MTLVFM)
      CALL FMPWR(MA%MFM,MTLVFM,RETURN_VALUE%MFM)
   END FUNCTION FMPWR_FMIM

   FUNCTION FMPWR_FMZM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA
      TYPE (ZM) :: MB,RETURN_VALUE
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      CALL FMI2M(0,MTLVFM)
      CALL ZMCMPX(MA%MFM,MTLVFM,MTLVZM)
      CALL ZMPWR(MTLVZM,MB%MZM,RETURN_VALUE%MZM)
   END FUNCTION FMPWR_FMZM

   FUNCTION FMPWR_IMI(MA,IVAL)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA,RETURN_VALUE
      INTEGER :: IVAL
      INTENT (IN) :: MA,IVAL
      TYPE(MULTI), SAVE :: MTLVIM
      CALL FM_UNDEF_INP(MA)
      CALL IMI2M(IVAL,MTLVIM)
      CALL IMPWR(MA%MIM,MTLVIM,RETURN_VALUE%MIM)
   END FUNCTION FMPWR_IMI

   FUNCTION FMPWR_IMR(MA,R)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: RETURN_VALUE
      TYPE (IM) :: MA
      REAL :: R
      INTENT (IN) :: MA,R
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMSP2M(R,MTLVFM)
      CALL IMI2FM(MA%MIM,MULVFM)
      CALL FMPWR(MULVFM,MTLVFM,RETURN_VALUE%MFM)
   END FUNCTION FMPWR_IMR

   FUNCTION FMPWR_IMD(MA,D)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: RETURN_VALUE
      TYPE (IM) :: MA
      DOUBLE PRECISION :: D
      INTENT (IN) :: MA,D
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMDP2M(D,MTLVFM)
      CALL IMI2FM(MA%MIM,MULVFM)
      CALL FMPWR(MULVFM,MTLVFM,RETURN_VALUE%MFM)
   END FUNCTION FMPWR_IMD

   FUNCTION FMPWR_IMZ(MA,Z)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: RETURN_VALUE
      TYPE (IM) :: MA
      COMPLEX :: Z
      INTENT (IN) :: MA,Z
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL ZMZ2M(Z,MTLVZM)
      CALL IMI2FM(MA%MIM,MTLVFM)
      CALL FMI2M(0,MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MULVZM)
      CALL ZMPWR(MULVZM,MTLVZM,RETURN_VALUE%MZM)
   END FUNCTION FMPWR_IMZ

   FUNCTION FMPWR_IMC(MA,C)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: RETURN_VALUE
      TYPE (IM) :: MA
      COMPLEX (KIND(0.0D0)) :: C
      INTENT (IN) :: MA,C
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FMDP2M(REAL(C,KIND(0.0D0)),MTLVFM)
      CALL FMDP2M(AIMAG(C),MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
      CALL IMI2FM(MA%MIM,MTLVFM)
      CALL FMI2M(0,MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MULVZM)
      CALL ZMPWR(MULVZM,MTLVZM,RETURN_VALUE%MZM)
   END FUNCTION FMPWR_IMC

   FUNCTION FMPWR_IMFM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA
      TYPE (FM) :: MB,RETURN_VALUE
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      CALL IMI2FM(MA%MIM,MTLVFM)
      CALL FMPWR(MTLVFM,MB%MFM,RETURN_VALUE%MFM)
   END FUNCTION FMPWR_IMFM

   FUNCTION FMPWR_IMIM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA,MB,RETURN_VALUE
      INTENT (IN) :: MA,MB
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      CALL IMPWR(MA%MIM,MB%MIM,RETURN_VALUE%MIM)
   END FUNCTION FMPWR_IMIM

   FUNCTION FMPWR_IMZM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA
      TYPE (ZM) :: MB,RETURN_VALUE
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      CALL IMI2FM(MA%MIM,MTLVFM)
      CALL FMI2M(0,MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MULVZM)
      CALL ZMPWR(MULVZM,MB%MZM,RETURN_VALUE%MZM)
   END FUNCTION FMPWR_IMZM

   FUNCTION FMPWR_ZMI(MA,IVAL)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA,RETURN_VALUE
      INTEGER :: IVAL
      INTENT (IN) :: MA,IVAL
      CALL FM_UNDEF_INP(MA)
      CALL ZMIPWR(MA%MZM,IVAL,RETURN_VALUE%MZM)
   END FUNCTION FMPWR_ZMI

   FUNCTION FMPWR_ZMR(MA,R)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA,RETURN_VALUE
      REAL :: R
      INTENT (IN) :: MA,R
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FMSP2M(R,MTLVFM)
      CALL FMI2M(0,MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
      CALL ZMPWR(MA%MZM,MTLVZM,RETURN_VALUE%MZM)
   END FUNCTION FMPWR_ZMR

   FUNCTION FMPWR_ZMD(MA,D)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA,RETURN_VALUE
      DOUBLE PRECISION :: D
      INTENT (IN) :: MA,D
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FMDP2M(D,MTLVFM)
      CALL FMI2M(0,MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
      CALL ZMPWR(MA%MZM,MTLVZM,RETURN_VALUE%MZM)
   END FUNCTION FMPWR_ZMD

   FUNCTION FMPWR_ZMZ(MA,Z)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA,RETURN_VALUE
      COMPLEX :: Z
      INTENT (IN) :: MA,Z
      TYPE(MULTI), SAVE :: MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL ZMZ2M(Z,MTLVZM)
      CALL ZMPWR(MA%MZM,MTLVZM,RETURN_VALUE%MZM)
   END FUNCTION FMPWR_ZMZ

   FUNCTION FMPWR_ZMC(MA,C)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA,RETURN_VALUE
      COMPLEX (KIND(0.0D0)) :: C
      INTENT (IN) :: MA,C
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FMDP2M(REAL(C,KIND(0.0D0)),MTLVFM)
      CALL FMDP2M(AIMAG(C),MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
      CALL ZMPWR(MA%MZM,MTLVZM,RETURN_VALUE%MZM)
   END FUNCTION FMPWR_ZMC

   FUNCTION FMPWR_ZMFM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MB
      TYPE (ZM) :: MA,RETURN_VALUE
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      CALL FMI2M(0,MTLVFM)
      CALL ZMCMPX(MB%MFM,MTLVFM,MTLVZM)
      CALL ZMPWR(MA%MZM,MTLVZM,RETURN_VALUE%MZM)
   END FUNCTION FMPWR_ZMFM

   FUNCTION FMPWR_ZMIM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MB
      TYPE (ZM) :: MA,RETURN_VALUE
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      CALL IMI2FM(MB%MIM,MTLVFM)
      CALL FMI2M(0,MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MULVZM)
      CALL ZMPWR(MA%MZM,MULVZM,RETURN_VALUE%MZM)
   END FUNCTION FMPWR_ZMIM

   FUNCTION FMPWR_ZMZM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA,MB,RETURN_VALUE
      INTENT (IN) :: MA,MB
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      CALL ZMPWR(MA%MZM,MB%MZM,RETURN_VALUE%MZM)
   END FUNCTION FMPWR_ZMZM

!                                                                 ABS

   FUNCTION FMABS_FM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA,RETURN_VALUE
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL FMABS(MA%MFM,RETURN_VALUE%MFM)
   END FUNCTION FMABS_FM

   FUNCTION FMABS_IM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA,RETURN_VALUE
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL IMABS(MA%MIM,RETURN_VALUE%MIM)
   END FUNCTION FMABS_IM

   FUNCTION FMABS_ZM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: RETURN_VALUE
      TYPE (ZM) :: MA
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL ZMABS(MA%MZM,RETURN_VALUE%MFM)
   END FUNCTION FMABS_ZM

   FUNCTION FMABS_FM1(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      DO J = 1, N
         CALL FMABS(MA(J)%MFM,RETURN_VALUE(J)%MFM)
      ENDDO
   END FUNCTION FMABS_FM1

   FUNCTION FMABS_IM1(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:) :: MA
      TYPE (IM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      DO J = 1, N
         CALL IMABS(MA(J)%MIM,RETURN_VALUE(J)%MIM)
      ENDDO
   END FUNCTION FMABS_IM1

   FUNCTION FMABS_ZM1(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      DO J = 1, N
         CALL ZMABS(MA(J)%MZM,RETURN_VALUE(J)%MFM)
      ENDDO
   END FUNCTION FMABS_ZM1

   FUNCTION FMABS_FM2(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMABS(MA(J,K)%MFM,RETURN_VALUE(J,K)%MFM)
         ENDDO
      ENDDO
   END FUNCTION FMABS_FM2

   FUNCTION FMABS_IM2(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:,:) :: MA
      TYPE (IM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL IMABS(MA(J,K)%MIM,RETURN_VALUE(J,K)%MIM)
         ENDDO
      ENDDO
   END FUNCTION FMABS_IM2

   FUNCTION FMABS_ZM2(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMABS(MA(J,K)%MZM,RETURN_VALUE(J,K)%MFM)
         ENDDO
      ENDDO
   END FUNCTION FMABS_ZM2

!                                                                ACOS

   FUNCTION FMACOS_FM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA,RETURN_VALUE
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL FMACOS(MA%MFM,RETURN_VALUE%MFM)
   END FUNCTION FMACOS_FM

   FUNCTION FMACOS_ZM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA,RETURN_VALUE
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL ZMACOS(MA%MZM,RETURN_VALUE%MZM)
   END FUNCTION FMACOS_ZM

   FUNCTION FMACOS_FM1(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      DO J = 1, N
         CALL FMACOS(MA(J)%MFM,RETURN_VALUE(J)%MFM)
      ENDDO
   END FUNCTION FMACOS_FM1

   FUNCTION FMACOS_ZM1(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      DO J = 1, N
         CALL ZMACOS(MA(J)%MZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMACOS_ZM1

   FUNCTION FMACOS_FM2(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMACOS(MA(J,K)%MFM,RETURN_VALUE(J,K)%MFM)
         ENDDO
      ENDDO
   END FUNCTION FMACOS_FM2

   FUNCTION FMACOS_ZM2(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMACOS(MA(J,K)%MZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMACOS_ZM2

!                                                                ACOSH

   FUNCTION FMACOSH_FM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA,RETURN_VALUE
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL FMACOSH(MA%MFM,RETURN_VALUE%MFM)
   END FUNCTION FMACOSH_FM

   FUNCTION FMACOSH_ZM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA,RETURN_VALUE
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL ZMACOSH(MA%MZM,RETURN_VALUE%MZM)
   END FUNCTION FMACOSH_ZM

   FUNCTION FMACOSH_FM1(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      DO J = 1, N
         CALL FMACOSH(MA(J)%MFM,RETURN_VALUE(J)%MFM)
      ENDDO
   END FUNCTION FMACOSH_FM1

   FUNCTION FMACOSH_ZM1(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      DO J = 1, N
         CALL ZMACOSH(MA(J)%MZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMACOSH_ZM1

   FUNCTION FMACOSH_FM2(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMACOSH(MA(J,K)%MFM,RETURN_VALUE(J,K)%MFM)
         ENDDO
      ENDDO
   END FUNCTION FMACOSH_FM2

   FUNCTION FMACOSH_ZM2(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMACOSH(MA(J,K)%MZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMACOSH_ZM2

!                                                               AIMAG

   FUNCTION FMAIMAG_ZM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: RETURN_VALUE
      TYPE (ZM) :: MA
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL ZMIMAG(MA%MZM,RETURN_VALUE%MFM)
   END FUNCTION FMAIMAG_ZM

   FUNCTION FMAIMAG_ZM1(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      DO J = 1, N
         CALL ZMIMAG(MA(J)%MZM,RETURN_VALUE(J)%MFM)
      ENDDO
   END FUNCTION FMAIMAG_ZM1

   FUNCTION FMAIMAG_ZM2(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMIMAG(MA(J,K)%MZM,RETURN_VALUE(J,K)%MFM)
         ENDDO
      ENDDO
   END FUNCTION FMAIMAG_ZM2

!                                                                AINT

   FUNCTION FMAINT_FM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA,RETURN_VALUE
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL FMINT(MA%MFM,RETURN_VALUE%MFM)
   END FUNCTION FMAINT_FM

   FUNCTION FMAINT_ZM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA,RETURN_VALUE
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL ZMINT(MA%MZM,RETURN_VALUE%MZM)
   END FUNCTION FMAINT_ZM

   FUNCTION FMAINT_FM1(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      DO J = 1, N
         CALL FMINT(MA(J)%MFM,RETURN_VALUE(J)%MFM)
      ENDDO
   END FUNCTION FMAINT_FM1

   FUNCTION FMAINT_ZM1(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      DO J = 1, N
         CALL ZMINT(MA(J)%MZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMAINT_ZM1

   FUNCTION FMAINT_FM2(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMINT(MA(J,K)%MFM,RETURN_VALUE(J,K)%MFM)
         ENDDO
      ENDDO
   END FUNCTION FMAINT_FM2

   FUNCTION FMAINT_ZM2(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMINT(MA(J,K)%MZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMAINT_ZM2

!                                                               ANINT

   FUNCTION FMANINT_FM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA,RETURN_VALUE
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL FMNINT(MA%MFM,RETURN_VALUE%MFM)
   END FUNCTION FMANINT_FM

   FUNCTION FMANINT_ZM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA,RETURN_VALUE
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL ZMNINT(MA%MZM,RETURN_VALUE%MZM)
   END FUNCTION FMANINT_ZM

   FUNCTION FMANINT_FM1(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      DO J = 1, N
         CALL FMNINT(MA(J)%MFM,RETURN_VALUE(J)%MFM)
      ENDDO
   END FUNCTION FMANINT_FM1

   FUNCTION FMANINT_ZM1(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      DO J = 1, N
         CALL ZMNINT(MA(J)%MZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMANINT_ZM1

   FUNCTION FMANINT_FM2(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMNINT(MA(J,K)%MFM,RETURN_VALUE(J,K)%MFM)
         ENDDO
      ENDDO
   END FUNCTION FMANINT_FM2

   FUNCTION FMANINT_ZM2(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMNINT(MA(J,K)%MZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMANINT_ZM2

!                                                                ASIN

   FUNCTION FMASIN_FM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA,RETURN_VALUE
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL FMASIN(MA%MFM,RETURN_VALUE%MFM)
   END FUNCTION FMASIN_FM

   FUNCTION FMASIN_ZM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA,RETURN_VALUE
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL ZMASIN(MA%MZM,RETURN_VALUE%MZM)
   END FUNCTION FMASIN_ZM

   FUNCTION FMASIN_FM1(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      DO J = 1, N
         CALL FMASIN(MA(J)%MFM,RETURN_VALUE(J)%MFM)
      ENDDO
   END FUNCTION FMASIN_FM1

   FUNCTION FMASIN_ZM1(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      DO J = 1, N
         CALL ZMASIN(MA(J)%MZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMASIN_ZM1

   FUNCTION FMASIN_FM2(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMASIN(MA(J,K)%MFM,RETURN_VALUE(J,K)%MFM)
         ENDDO
      ENDDO
   END FUNCTION FMASIN_FM2

   FUNCTION FMASIN_ZM2(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMASIN(MA(J,K)%MZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMASIN_ZM2

!                                                                ASINH

   FUNCTION FMASINH_FM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA,RETURN_VALUE
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL FMASINH(MA%MFM,RETURN_VALUE%MFM)
   END FUNCTION FMASINH_FM

   FUNCTION FMASINH_ZM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA,RETURN_VALUE
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL ZMASINH(MA%MZM,RETURN_VALUE%MZM)
   END FUNCTION FMASINH_ZM

   FUNCTION FMASINH_FM1(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      DO J = 1, N
         CALL FMASINH(MA(J)%MFM,RETURN_VALUE(J)%MFM)
      ENDDO
   END FUNCTION FMASINH_FM1

   FUNCTION FMASINH_ZM1(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      DO J = 1, N
         CALL ZMASINH(MA(J)%MZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMASINH_ZM1

   FUNCTION FMASINH_FM2(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMASINH(MA(J,K)%MFM,RETURN_VALUE(J,K)%MFM)
         ENDDO
      ENDDO
   END FUNCTION FMASINH_FM2

   FUNCTION FMASINH_ZM2(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMASINH(MA(J,K)%MZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMASINH_ZM2

!                                                                ATAN

   FUNCTION FMATAN_FM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA,RETURN_VALUE
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL FMATAN(MA%MFM,RETURN_VALUE%MFM)
   END FUNCTION FMATAN_FM

   FUNCTION FMATAN_ZM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA,RETURN_VALUE
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL ZMATAN(MA%MZM,RETURN_VALUE%MZM)
   END FUNCTION FMATAN_ZM

   FUNCTION FMATAN_FM1(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      DO J = 1, N
         CALL FMATAN(MA(J)%MFM,RETURN_VALUE(J)%MFM)
      ENDDO
   END FUNCTION FMATAN_FM1

   FUNCTION FMATAN_ZM1(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      DO J = 1, N
         CALL ZMATAN(MA(J)%MZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMATAN_ZM1

   FUNCTION FMATAN_FM2(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMATAN(MA(J,K)%MFM,RETURN_VALUE(J,K)%MFM)
         ENDDO
      ENDDO
   END FUNCTION FMATAN_FM2

   FUNCTION FMATAN_ZM2(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMATAN(MA(J,K)%MZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMATAN_ZM2

!                                                                ATANH

   FUNCTION FMATANH_FM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA,RETURN_VALUE
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL FMATANH(MA%MFM,RETURN_VALUE%MFM)
   END FUNCTION FMATANH_FM

   FUNCTION FMATANH_ZM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA,RETURN_VALUE
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL ZMATANH(MA%MZM,RETURN_VALUE%MZM)
   END FUNCTION FMATANH_ZM

   FUNCTION FMATANH_FM1(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      DO J = 1, N
         CALL FMATANH(MA(J)%MFM,RETURN_VALUE(J)%MFM)
      ENDDO
   END FUNCTION FMATANH_FM1

   FUNCTION FMATANH_ZM1(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      DO J = 1, N
         CALL ZMATANH(MA(J)%MZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMATANH_ZM1

   FUNCTION FMATANH_FM2(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMATANH(MA(J,K)%MFM,RETURN_VALUE(J,K)%MFM)
         ENDDO
      ENDDO
   END FUNCTION FMATANH_FM2

   FUNCTION FMATANH_ZM2(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMATANH(MA(J,K)%MZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMATANH_ZM2

!                                                               ATAN2

   FUNCTION FMATAN2_FM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA,MB,RETURN_VALUE
      INTENT (IN) :: MA,MB
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      CALL FMATN2(MA%MFM,MB%MFM,RETURN_VALUE%MFM)
   END FUNCTION FMATAN2_FM

!                                                               BTEST

   FUNCTION FMBTEST_IM(MA,POS)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA
      INTEGER :: POS
      LOGICAL :: RETURN_VALUE
      INTENT (IN) :: MA,POS
      TYPE(MULTI), SAVE :: MTLVIM,MULVIM,MVLVIM
      CALL FM_UNDEF_INP(MA)
      CALL IMI2M(2,MTLVIM)
      CALL IMI2M(POS,MULVIM)
      CALL IMPWR(MTLVIM,MULVIM,MVLVIM)
      CALL IMDIV(MA%MIM,MVLVIM,MULVIM)
      MULVIM%MP(1) = 1
      CALL IMMOD(MULVIM,MTLVIM,MVLVIM)
      IF (MVLVIM%MP(3) == 0) THEN
          RETURN_VALUE = .FALSE.
      ELSE
          RETURN_VALUE = .TRUE.
      ENDIF
   END FUNCTION FMBTEST_IM

!                                                             CEILING

   FUNCTION FMCEILING_FM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA,RETURN_VALUE
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMINT(MA%MFM,MTLVFM)
      CALL FMSUB(MA%MFM,MTLVFM,MULVFM)
      IF (MULVFM%MP(3) == 0) THEN
          CALL FMEQ(MA%MFM,RETURN_VALUE%MFM)
      ELSE IF (MA%MFM%MP(1) > 0) THEN
          CALL FMADDI(MTLVFM,1)
          CALL FMEQ(MTLVFM,RETURN_VALUE%MFM)
      ELSE
          CALL FMEQ(MTLVFM,RETURN_VALUE%MFM)
      ENDIF
   END FUNCTION FMCEILING_FM

   FUNCTION FMCEILING_IM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA,RETURN_VALUE
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL IMEQ(MA%MIM,RETURN_VALUE%MIM)
   END FUNCTION FMCEILING_IM

   FUNCTION FMCEILING_ZM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA,RETURN_VALUE
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MVLVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMINT(MA%MZM(1),MTLVFM)
      CALL FMSUB(MA%MZM(1),MTLVFM,MULVFM)
      IF (MULVFM%MP(3) == 0) THEN
          CALL FMEQ(MA%MZM(1),MVLVFM)
      ELSE IF (MA%MZM(1)%MP(1) > 0) THEN
          CALL FMADDI(MTLVFM,1)
          CALL FMEQ(MTLVFM,MVLVFM)
      ELSE
          CALL FMEQ(MTLVFM,MVLVFM)
      ENDIF
      CALL FMINT(MA%MZM(2),MTLVFM)
      CALL FMSUB(MA%MZM(2),MTLVFM,MULVFM)
      IF (MULVFM%MP(3) == 0) THEN
          CALL FMEQ(MA%MZM(2),MULVFM)
      ELSE IF (MA%MZM(2)%MP(1) > 0) THEN
          CALL FMADDI(MTLVFM,1)
          CALL FMEQ(MTLVFM,MULVFM)
      ELSE
          CALL FMEQ(MTLVFM,MULVFM)
      ENDIF
      CALL ZMCMPX(MVLVFM,MULVFM,RETURN_VALUE%MZM)
   END FUNCTION FMCEILING_ZM

   FUNCTION FMCEILING_FM1(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA
      TYPE(FM), SAVE :: MT_FM
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      DO J = 1, N
         CALL FM_EQ(FMCEILING_FM(MA(J)),MT_FM)
         CALL FMEQ(MT_FM%MFM,RETURN_VALUE(J)%MFM)
      ENDDO
   END FUNCTION FMCEILING_FM1

   FUNCTION FMCEILING_IM1(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:) :: MA
      TYPE (IM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA
      TYPE(IM), SAVE :: MT_IM
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      DO J = 1, N
         CALL IM_EQ(FMCEILING_IM(MA(J)),MT_IM)
         CALL IMEQ(MT_IM%MIM,RETURN_VALUE(J)%MIM)
      ENDDO
   END FUNCTION FMCEILING_IM1

   FUNCTION FMCEILING_ZM1(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA
      TYPE(ZM), SAVE :: MT_ZM
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      DO J = 1, N
         CALL ZM_EQ(FMCEILING_ZM(MA(J)),MT_ZM)
         CALL ZMEQ(MT_ZM%MZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMCEILING_ZM1

   FUNCTION FMCEILING_FM2(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA
      TYPE(FM), SAVE :: MT_FM
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FM_EQ(FMCEILING_FM(MA(J,K)),MT_FM)
            CALL FMEQ(MT_FM%MFM,RETURN_VALUE(J,K)%MFM)
         ENDDO
      ENDDO
   END FUNCTION FMCEILING_FM2

   FUNCTION FMCEILING_IM2(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:,:) :: MA
      TYPE (IM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA
      TYPE(IM), SAVE :: MT_IM
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL IM_EQ(FMCEILING_IM(MA(J,K)),MT_IM)
            CALL IMEQ(MT_IM%MIM,RETURN_VALUE(J,K)%MIM)
         ENDDO
      ENDDO
   END FUNCTION FMCEILING_IM2

   FUNCTION FMCEILING_ZM2(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA
      TYPE(ZM), SAVE :: MT_ZM
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZM_EQ(FMCEILING_ZM(MA(J,K)),MT_ZM)
            CALL ZMEQ(MT_ZM%MZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMCEILING_ZM2

!                                                               CMPLX

   FUNCTION FMCMPLX_FM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: RETURN_VALUE
      TYPE (FM) :: MA
      TYPE (FM), OPTIONAL :: MB
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      IF (PRESENT(MB)) THEN
          CALL FM_UNDEF_INP(MB)
          CALL ZMCMPX(MA%MFM,MB%MFM,RETURN_VALUE%MZM)
      ELSE
          CALL FMI2M(0,MTLVFM)
          CALL ZMCMPX(MA%MFM,MTLVFM,RETURN_VALUE%MZM)
      ENDIF
   END FUNCTION FMCMPLX_FM

   FUNCTION FMCMPLX_IM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: RETURN_VALUE
      TYPE (IM) :: MA
      TYPE (IM), OPTIONAL :: MB
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM
      CALL FM_UNDEF_INP(MA)
      IF (PRESENT(MB)) THEN
          CALL FM_UNDEF_INP(MB)
          CALL IMI2FM(MA%MIM,MTLVFM)
          CALL IMI2FM(MB%MIM,MULVFM)
          CALL ZMCMPX(MTLVFM,MULVFM,RETURN_VALUE%MZM)
      ELSE
          CALL IMI2FM(MA%MIM,MTLVFM)
          CALL FMI2M(0,MULVFM)
          CALL ZMCMPX(MTLVFM,MULVFM,RETURN_VALUE%MZM)
      ENDIF
   END FUNCTION FMCMPLX_IM

!                                                               CONJG

   FUNCTION FMCONJG_ZM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: RETURN_VALUE,MA
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL ZMCONJ(MA%MZM,RETURN_VALUE%MZM)
   END FUNCTION FMCONJG_ZM

   FUNCTION FMCONJG_ZM1(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      DO J = 1, N
         CALL ZMCONJ(MA(J)%MZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMCONJG_ZM1

   FUNCTION FMCONJG_ZM2(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMCONJ(MA(J,K)%MZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMCONJG_ZM2

!                                                                 COS

   FUNCTION FMCOS_FM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA,RETURN_VALUE
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL FMCOS(MA%MFM,RETURN_VALUE%MFM)
   END FUNCTION FMCOS_FM

   FUNCTION FMCOS_ZM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA,RETURN_VALUE
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL ZMCOS(MA%MZM,RETURN_VALUE%MZM)
   END FUNCTION FMCOS_ZM

   FUNCTION FMCOS_FM1(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      DO J = 1, N
         CALL FMCOS(MA(J)%MFM,RETURN_VALUE(J)%MFM)
      ENDDO
   END FUNCTION FMCOS_FM1

   FUNCTION FMCOS_ZM1(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      DO J = 1, N
         CALL ZMCOS(MA(J)%MZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMCOS_ZM1

   FUNCTION FMCOS_FM2(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMCOS(MA(J,K)%MFM,RETURN_VALUE(J,K)%MFM)
         ENDDO
      ENDDO
   END FUNCTION FMCOS_FM2

   FUNCTION FMCOS_ZM2(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMCOS(MA(J,K)%MZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMCOS_ZM2

!                                                                COSH

   FUNCTION FMCOSH_FM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA,RETURN_VALUE
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL FMCOSH(MA%MFM,RETURN_VALUE%MFM)
   END FUNCTION FMCOSH_FM

   FUNCTION FMCOSH_FM1(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      DO J = 1, N
         CALL FMCOSH(MA(J)%MFM,RETURN_VALUE(J)%MFM)
      ENDDO
   END FUNCTION FMCOSH_FM1

   FUNCTION FMCOSH_ZM1(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      DO J = 1, N
         CALL ZMCOSH(MA(J)%MZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMCOSH_ZM1

   FUNCTION FMCOSH_FM2(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMCOSH(MA(J,K)%MFM,RETURN_VALUE(J,K)%MFM)
         ENDDO
      ENDDO
   END FUNCTION FMCOSH_FM2

   FUNCTION FMCOSH_ZM2(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMCOSH(MA(J,K)%MZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMCOSH_ZM2

   FUNCTION FMCOSH_ZM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA,RETURN_VALUE
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL ZMCOSH(MA%MZM,RETURN_VALUE%MZM)
   END FUNCTION FMCOSH_ZM

!                                                                DBLE

   FUNCTION FMDBLE_FM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA,RETURN_VALUE
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL FMEQ(MA%MFM,RETURN_VALUE%MFM)
   END FUNCTION FMDBLE_FM

   FUNCTION FMDBLE_IM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: RETURN_VALUE
      TYPE (IM) :: MA
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL IMI2FM(MA%MIM,RETURN_VALUE%MFM)
   END FUNCTION FMDBLE_IM

   FUNCTION FMDBLE_ZM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: RETURN_VALUE
      TYPE (ZM) :: MA
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL ZMREAL(MA%MZM,RETURN_VALUE%MFM)
   END FUNCTION FMDBLE_ZM

!                                                              DIGITS

   FUNCTION FMDIGITS_FM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA
      INTEGER :: RETURN_VALUE
      INTENT (IN) :: MA
      RETURN_VALUE = NDIG
      IF (ALLOCATED(MA%MFM%MP)) THEN
          IF (SIZE(MA%MFM%MP) <= 2) RETURN_VALUE = RETURN_VALUE - 1
      ENDIF
   END FUNCTION FMDIGITS_FM

   FUNCTION FMDIGITS_IM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA
      INTEGER :: RETURN_VALUE
      INTENT (IN) :: MA

!             The number of possible digits for type(im) integers is limited only by the amount
!             of memory that can be allocated.  Return 10**6 since there is no fixed limit.

      RETURN_VALUE = 10**6
      IF (ALLOCATED(MA%MIM%MP)) THEN
          IF (SIZE(MA%MIM%MP) <= 2) RETURN_VALUE = RETURN_VALUE - 1
      ENDIF
   END FUNCTION FMDIGITS_IM

   FUNCTION FMDIGITS_ZM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      INTEGER :: RETURN_VALUE
      TYPE (ZM) :: MA
      INTENT (IN) :: MA
      RETURN_VALUE = NDIG
      IF (ALLOCATED(MA%MZM(1)%MP)) THEN
          IF (SIZE(MA%MZM(1)%MP) <= 2) RETURN_VALUE = RETURN_VALUE - 1
      ENDIF
   END FUNCTION FMDIGITS_ZM

!                                                                 DIM

   FUNCTION FMDIM_FM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA,MB,RETURN_VALUE
      INTENT (IN) :: MA,MB
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      CALL FMDIM(MA%MFM,MB%MFM,RETURN_VALUE%MFM)
   END FUNCTION FMDIM_FM

   FUNCTION FMDIM_IM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA,MB,RETURN_VALUE
      INTENT (IN) :: MA,MB
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      CALL IMDIM(MA%MIM,MB%MIM,RETURN_VALUE%MIM)
   END FUNCTION FMDIM_IM

!                                                                DINT

   FUNCTION FMDINT_FM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA,RETURN_VALUE
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL FMINT(MA%MFM,RETURN_VALUE%MFM)
   END FUNCTION FMDINT_FM

   FUNCTION FMDINT_ZM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA,RETURN_VALUE
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL ZMINT(MA%MZM,RETURN_VALUE%MZM)
   END FUNCTION FMDINT_ZM

!                                                         DOT_PRODUCT

   FUNCTION FMDOTPRODUCT_FM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA(:),MB(:),RETURN_VALUE
      INTEGER :: J,JA,JB,MXSAVE,ND2,NDSAVE
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MVLVFM,M3LVFM
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      IF (SIZE(MA) == SIZE(MB)) THEN
          NDSAVE = NDIG
          J = MAX(NGRD52,2)
          ND2 = MAX(2*NDIG+J,2)
          NDIG = ND2
          MXSAVE = MXEXP
          MXEXP = MXEXP2
          CALL FMI2M(0,M3LVFM)
          DO J = 1, SIZE(MA)
             JA = LBOUND(MA,DIM=1) + J - 1
             CALL FMEQU(MA(JA)%MFM,MULVFM,NDSAVE,NDIG)
             JB = LBOUND(MB,DIM=1) + J - 1
             CALL FMEQU(MB(JB)%MFM,MVLVFM,NDSAVE,NDIG)
             CALL FMMPY(MULVFM,MVLVFM,MTLVFM)
             CALL FMADD_R1(M3LVFM,MTLVFM)
          ENDDO
          MXEXP = MXSAVE
          CALL FMEQU(M3LVFM,RETURN_VALUE%MFM,NDIG,NDSAVE)
          NDIG = NDSAVE
      ELSE
          CALL FMI2M(1,MTLVFM)
          CALL FMI2M(0,MULVFM)
          CALL FMDIV(MTLVFM,MULVFM,RETURN_VALUE%MFM)
      ENDIF
   END FUNCTION FMDOTPRODUCT_FM

   FUNCTION FMDOTPRODUCT_IM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA(:),MB(:),RETURN_VALUE
      INTEGER :: J,JA,JB
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVIM,MULVIM,M3LVIM
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      IF (SIZE(MA) == SIZE(MB)) THEN
          CALL IMI2M(0,M3LVIM)
          DO J = 1, SIZE(MA)
             JA = LBOUND(MA,DIM=1) + J - 1
             JB = LBOUND(MB,DIM=1) + J - 1
             CALL IMMPY(MA(JA)%MIM,MB(JB)%MIM,MTLVIM)
             CALL IMADD(M3LVIM,MTLVIM,MULVIM)
             CALL IMEQ(MULVIM,M3LVIM)
          ENDDO
          CALL IMEQ(M3LVIM,RETURN_VALUE%MIM)
      ELSE
          CALL IMI2M(1,MTLVIM)
          CALL IMI2M(0,MULVIM)
          CALL IMDIV(MTLVIM,MULVIM,RETURN_VALUE%MIM)
      ENDIF
   END FUNCTION FMDOTPRODUCT_IM

   FUNCTION FMDOTPRODUCT_ZM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA(:),MB(:),RETURN_VALUE
      INTEGER :: J,JA,JB,MXSAVE,ND2,NDSAVE
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVZM(2),MULVZM(2),MVLVZM(2),M3LVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      IF (SIZE(MA) == SIZE(MB)) THEN
          NDSAVE = NDIG
          J = MAX(NGRD52,2)
          ND2 = MAX(2*NDIG+J,2)
          NDIG = ND2
          MXSAVE = MXEXP
          MXEXP = MXEXP2
          CALL ZMI2M(0,M3LVZM)
          DO J = 1, SIZE(MA)
             JA = LBOUND(MA,DIM=1) + J - 1
             CALL ZMEQU(MA(JA)%MZM,MULVZM,NDSAVE,NDIG)
             MULVZM(2)%MP(1) = -MULVZM(2)%MP(1)
             JB = LBOUND(MB,DIM=1) + J - 1
             CALL ZMEQU(MB(JB)%MZM,MVLVZM,NDSAVE,NDIG)
             CALL ZMMPY(MULVZM,MVLVZM,MTLVZM)
             CALL ZMADD(M3LVZM,MTLVZM,MULVZM)
             CALL ZMEQ(MULVZM,M3LVZM)
          ENDDO
          MXEXP = MXSAVE
          CALL ZMEQU(M3LVZM,RETURN_VALUE%MZM,NDIG,NDSAVE)
          NDIG = NDSAVE
      ELSE
          CALL ZMI2M(1,MTLVZM)
          CALL ZMI2M(0,MULVZM)
          CALL ZMDIV(MTLVZM,MULVZM,RETURN_VALUE%MZM)
      ENDIF
   END FUNCTION FMDOTPRODUCT_ZM

!                                                             EPSILON

   FUNCTION FMEPSILON_FM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA,RETURN_VALUE
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FMI2M(1,MTLVFM)
      IF (ALLOCATED(MA%MFM%MP)) THEN
          IF (SIZE(MA%MFM%MP) <= 2) CALL FMI2M(2,MTLVFM)
      ENDIF
      CALL FMULP(MTLVFM,RETURN_VALUE%MFM)
   END FUNCTION FMEPSILON_FM

!                                                                 EXP

   FUNCTION FMEXP_FM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA,RETURN_VALUE
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL FMEXP(MA%MFM,RETURN_VALUE%MFM)
   END FUNCTION FMEXP_FM

   FUNCTION FMEXP_ZM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA,RETURN_VALUE
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL ZMEXP(MA%MZM,RETURN_VALUE%MZM)
   END FUNCTION FMEXP_ZM

   FUNCTION FMEXP_FM1(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      DO J = 1, N
         CALL FMEXP(MA(J)%MFM,RETURN_VALUE(J)%MFM)
      ENDDO
   END FUNCTION FMEXP_FM1

   FUNCTION FMEXP_ZM1(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      DO J = 1, N
         CALL ZMEXP(MA(J)%MZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMEXP_ZM1

   FUNCTION FMEXP_FM2(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMEXP(MA(J,K)%MFM,RETURN_VALUE(J,K)%MFM)
         ENDDO
      ENDDO
   END FUNCTION FMEXP_FM2

   FUNCTION FMEXP_ZM2(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMEXP(MA(J,K)%MZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMEXP_ZM2

!                                                            EXPONENT

   FUNCTION FMEXPONENT_FM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA
      INTEGER :: RETURN_VALUE
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      RETURN_VALUE = INT(MA%MFM%MP(2))
   END FUNCTION FMEXPONENT_FM

!                                                               FLOOR

   FUNCTION FMFLOOR_FM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA,RETURN_VALUE
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMINT(MA%MFM,MTLVFM)
      CALL FMSUB(MA%MFM,MTLVFM,MULVFM)
      IF (MULVFM%MP(3) == 0) THEN
          CALL FMEQ(MA%MFM,RETURN_VALUE%MFM)
      ELSE IF (MA%MFM%MP(1) < 0) THEN
          CALL FMADDI(MTLVFM,-1)
          CALL FMEQ(MTLVFM,RETURN_VALUE%MFM)
      ELSE
          CALL FMEQ(MTLVFM,RETURN_VALUE%MFM)
      ENDIF
   END FUNCTION FMFLOOR_FM

   FUNCTION FMFLOOR_IM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA,RETURN_VALUE
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL IMEQ(MA%MIM,RETURN_VALUE%MIM)
   END FUNCTION FMFLOOR_IM

   FUNCTION FMFLOOR_ZM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA,RETURN_VALUE
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MVLVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMINT(MA%MZM(1),MTLVFM)
      CALL FMSUB(MA%MZM(1),MTLVFM,MULVFM)
      IF (MULVFM%MP(3) == 0) THEN
          CALL FMEQ(MA%MZM(1),MVLVFM)
      ELSE IF (MA%MZM(1)%MP(1) < 0) THEN
          CALL FMADDI(MTLVFM,-1)
          CALL FMEQ(MTLVFM,MVLVFM)
      ELSE
          CALL FMEQ(MTLVFM,MVLVFM)
      ENDIF
      CALL FMINT(MA%MZM(2),MTLVFM)
      CALL FMSUB(MA%MZM(2),MTLVFM,MULVFM)
      IF (MULVFM%MP(3) == 0) THEN
          CALL FMEQ(MA%MZM(2),MULVFM)
      ELSE IF (MA%MZM(2)%MP(1) < 0) THEN
          CALL FMADDI(MTLVFM,-1)
          CALL FMEQ(MTLVFM,MULVFM)
      ELSE
          CALL FMEQ(MTLVFM,MULVFM)
      ENDIF
      CALL ZMCMPX(MVLVFM,MULVFM,RETURN_VALUE%MZM)
   END FUNCTION FMFLOOR_ZM

   FUNCTION FMFLOOR_FM1(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA
      TYPE(FM), SAVE :: MT_FM
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      DO J = 1, N
         CALL FM_EQ(FMFLOOR_FM(MA(J)),MT_FM)
         CALL FMEQ(MT_FM%MFM,RETURN_VALUE(J)%MFM)
      ENDDO
   END FUNCTION FMFLOOR_FM1

   FUNCTION FMFLOOR_IM1(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:) :: MA
      TYPE (IM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA
      TYPE(IM), SAVE :: MT_IM
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      DO J = 1, N
         CALL IM_EQ(FMFLOOR_IM(MA(J)),MT_IM)
         CALL IMEQ(MT_IM%MIM,RETURN_VALUE(J)%MIM)
      ENDDO
   END FUNCTION FMFLOOR_IM1

   FUNCTION FMFLOOR_ZM1(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA
      TYPE(ZM), SAVE :: MT_ZM
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      DO J = 1, N
         CALL ZM_EQ(FMFLOOR_ZM(MA(J)),MT_ZM)
         CALL ZMEQ(MT_ZM%MZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMFLOOR_ZM1

   FUNCTION FMFLOOR_FM2(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA
      TYPE(FM), SAVE :: MT_FM
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FM_EQ(FMFLOOR_FM(MA(J,K)),MT_FM)
            CALL FMEQ(MT_FM%MFM,RETURN_VALUE(J,K)%MFM)
         ENDDO
      ENDDO
   END FUNCTION FMFLOOR_FM2

   FUNCTION FMFLOOR_IM2(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:,:) :: MA
      TYPE (IM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA
      TYPE(IM), SAVE :: MT_IM
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL IM_EQ(FMFLOOR_IM(MA(J,K)),MT_IM)
            CALL IMEQ(MT_IM%MIM,RETURN_VALUE(J,K)%MIM)
         ENDDO
      ENDDO
   END FUNCTION FMFLOOR_IM2

   FUNCTION FMFLOOR_ZM2(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA
      TYPE(ZM), SAVE :: MT_ZM
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZM_EQ(FMFLOOR_ZM(MA(J,K)),MT_ZM)
            CALL ZMEQ(MT_ZM%MZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMFLOOR_ZM2

!                                                            FRACTION

   FUNCTION FMFRACTION_FM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA,RETURN_VALUE
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMEQ(MA%MFM,MTLVFM)
      MTLVFM%MP(2) = 0
      CALL FMEQ(MTLVFM,RETURN_VALUE%MFM)
   END FUNCTION FMFRACTION_FM

   FUNCTION FMFRACTION_ZM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA,RETURN_VALUE
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL ZMEQ(MA%MZM,MTLVZM)
      MTLVZM(1)%MP(2) = 0
      MTLVZM(2)%MP(2) = 0
      CALL ZMEQ(MTLVZM,RETURN_VALUE%MZM)
   END FUNCTION FMFRACTION_ZM

   FUNCTION FMFRACTION_FM1(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA
      TYPE(FM), SAVE :: MT_FM
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      DO J = 1, N
         CALL FM_EQ(FMFRACTION_FM(MA(J)),MT_FM)
         CALL FMEQ(MT_FM%MFM,RETURN_VALUE(J)%MFM)
      ENDDO
   END FUNCTION FMFRACTION_FM1

   FUNCTION FMFRACTION_ZM1(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA
      TYPE(ZM), SAVE :: MT_ZM
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      DO J = 1, N
         CALL ZM_EQ(FMFRACTION_ZM(MA(J)),MT_ZM)
         CALL ZMEQ(MT_ZM%MZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMFRACTION_ZM1

   FUNCTION FMFRACTION_FM2(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA
      TYPE(FM), SAVE :: MT_FM
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FM_EQ(FMFRACTION_FM(MA(J,K)),MT_FM)
            CALL FMEQ(MT_FM%MFM,RETURN_VALUE(J,K)%MFM)
         ENDDO
      ENDDO
   END FUNCTION FMFRACTION_FM2

   FUNCTION FMFRACTION_ZM2(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA
      TYPE(ZM), SAVE :: MT_ZM
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZM_EQ(FMFRACTION_ZM(MA(J,K)),MT_ZM)
            CALL ZMEQ(MT_ZM%MZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMFRACTION_ZM2

!                                                                HUGE

   FUNCTION FMHUGE_FM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA,RETURN_VALUE
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FMBIG(RETURN_VALUE%MFM)
      IF (ALLOCATED(MA%MFM%MP)) THEN
          IF (SIZE(MA%MFM%MP) <= 2) THEN
              CALL FMI2M(1,MTLVFM)
              CALL FMSUB_R1(RETURN_VALUE%MFM,MTLVFM)
          ENDIF
      ENDIF
   END FUNCTION FMHUGE_FM

   FUNCTION FMHUGE_IM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA,RETURN_VALUE
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: MTLVIM,MULVIM
      CALL IMBIG(RETURN_VALUE%MIM)
      IF (ALLOCATED(MA%MIM%MP)) THEN
          IF (SIZE(MA%MIM%MP) <= 2) THEN
              CALL IMI2M(0,MTLVIM)
              CALL IMSUB(RETURN_VALUE%MIM,MTLVIM,MULVIM)
          ENDIF
      ENDIF
   END FUNCTION FMHUGE_IM

   FUNCTION FMHUGE_ZM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA,RETURN_VALUE
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: MTLVFM,MTLVZM(2)
      CALL FMBIG(MTLVFM)
      CALL ZMCMPX(MTLVFM,MTLVFM,RETURN_VALUE%MZM)
      IF (ALLOCATED(MA%MZM(1)%MP)) THEN
          IF (SIZE(MA%MZM(1)%MP) <= 2) THEN
              CALL ZMI2M(1,MTLVZM)
              CALL ZMSUB_R1(RETURN_VALUE%MZM,MTLVZM)
          ENDIF
      ENDIF
   END FUNCTION FMHUGE_ZM
!                                                               HYPOT

   FUNCTION FMHYPOT_FM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA,MB,RETURN_VALUE
      INTENT (IN) :: MA,MB
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      CALL FMHYPOT(MA%MFM,MB%MFM,RETURN_VALUE%MFM)
   END FUNCTION FMHYPOT_FM

!                                                                 INT

   FUNCTION FMINT_FM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA
      TYPE (IM) :: RETURN_VALUE
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMINT(MA%MFM,MTLVFM)
      CALL IMFM2I(MTLVFM,RETURN_VALUE%MIM)
   END FUNCTION FMINT_FM

   FUNCTION FMINT_IM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA,RETURN_VALUE
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL IMEQ(MA%MIM,RETURN_VALUE%MIM)
   END FUNCTION FMINT_IM

   FUNCTION FMINT_ZM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA
      TYPE (IM) :: RETURN_VALUE
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM
      CALL FM_UNDEF_INP(MA)
      CALL ZMREAL(MA%MZM,MTLVFM)
      CALL FMINT(MTLVFM,MULVFM)
      CALL IMFM2I(MULVFM,RETURN_VALUE%MIM)
   END FUNCTION FMINT_ZM

   FUNCTION FMINT_FM1(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      TYPE (IM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA
      TYPE(IM), SAVE :: MT_IM
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      DO J = 1, N
         CALL IM_EQ(FMINT_FM(MA(J)),MT_IM)
         CALL IMEQ(MT_IM%MIM,RETURN_VALUE(J)%MIM)
      ENDDO
   END FUNCTION FMINT_FM1

   FUNCTION FMINT_IM1(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:) :: MA
      TYPE (IM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA
      TYPE(IM), SAVE :: MT_IM
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      DO J = 1, N
         CALL IM_EQ(FMINT_IM(MA(J)),MT_IM)
         CALL IMEQ(MT_IM%MIM,RETURN_VALUE(J)%MIM)
      ENDDO
   END FUNCTION FMINT_IM1

   FUNCTION FMINT_ZM1(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      TYPE (IM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA
      TYPE(IM), SAVE :: MT_IM
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      DO J = 1, N
         CALL IM_EQ(FMINT_ZM(MA(J)),MT_IM)
         CALL IMEQ(MT_IM%MIM,RETURN_VALUE(J)%MIM)
      ENDDO
   END FUNCTION FMINT_ZM1

   FUNCTION FMINT_FM2(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      TYPE (IM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA
      TYPE(IM), SAVE :: MT_IM
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL IM_EQ(FMINT_FM(MA(J,K)),MT_IM)
            CALL IMEQ(MT_IM%MIM,RETURN_VALUE(J,K)%MIM)
         ENDDO
      ENDDO
   END FUNCTION FMINT_FM2

   FUNCTION FMINT_IM2(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:,:) :: MA
      TYPE (IM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA
      TYPE(IM), SAVE :: MT_IM
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL IM_EQ(FMINT_IM(MA(J,K)),MT_IM)
            CALL IMEQ(MT_IM%MIM,RETURN_VALUE(J,K)%MIM)
         ENDDO
      ENDDO
   END FUNCTION FMINT_IM2

   FUNCTION FMINT_ZM2(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      TYPE (IM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA
      TYPE(IM), SAVE :: MT_IM
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL IM_EQ(FMINT_ZM(MA(J,K)),MT_IM)
            CALL IMEQ(MT_IM%MIM,RETURN_VALUE(J,K)%MIM)
         ENDDO
      ENDDO
   END FUNCTION FMINT_ZM2

!                                                                 LOG

   FUNCTION FMLOG_FM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA,RETURN_VALUE
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL FMLN(MA%MFM,RETURN_VALUE%MFM)
   END FUNCTION FMLOG_FM

   FUNCTION FMLOG_FM1(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      DO J = 1, N
         CALL FMLN(MA(J)%MFM,RETURN_VALUE(J)%MFM)
      ENDDO
   END FUNCTION FMLOG_FM1

   FUNCTION FMLOG_ZM1(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      DO J = 1, N
         CALL ZMLN(MA(J)%MZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMLOG_ZM1

   FUNCTION FMLOG_FM2(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMLN(MA(J,K)%MFM,RETURN_VALUE(J,K)%MFM)
         ENDDO
      ENDDO
   END FUNCTION FMLOG_FM2

   FUNCTION FMLOG_ZM2(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMLN(MA(J,K)%MZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMLOG_ZM2

   FUNCTION FMLOG_ZM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA,RETURN_VALUE
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL ZMLN(MA%MZM,RETURN_VALUE%MZM)
   END FUNCTION FMLOG_ZM

!                                                               LOG10

   FUNCTION FMLOG10_FM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA,RETURN_VALUE
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL FMLG10(MA%MFM,RETURN_VALUE%MFM)
   END FUNCTION FMLOG10_FM

   FUNCTION FMLOG10_ZM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA,RETURN_VALUE
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL ZMLG10(MA%MZM,RETURN_VALUE%MZM)
   END FUNCTION FMLOG10_ZM

   FUNCTION FMLOG10_FM1(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      DO J = 1, N
         CALL FMLG10(MA(J)%MFM,RETURN_VALUE(J)%MFM)
      ENDDO
   END FUNCTION FMLOG10_FM1

   FUNCTION FMLOG10_ZM1(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      DO J = 1, N
         CALL ZMLG10(MA(J)%MZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMLOG10_ZM1

   FUNCTION FMLOG10_FM2(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMLG10(MA(J,K)%MFM,RETURN_VALUE(J,K)%MFM)
         ENDDO
      ENDDO
   END FUNCTION FMLOG10_FM2

   FUNCTION FMLOG10_ZM2(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMLG10(MA(J,K)%MZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMLOG10_ZM2

!                                                              MATMUL

   FUNCTION FMMATMUL22_FM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA(:,:),MB(:,:)
      TYPE (FM), DIMENSION(SIZE(MA,DIM=1),SIZE(MB,DIM=2)) :: RETURN_VALUE
      INTEGER :: I,J,K,MXSAVE,ND2,NDSAVE
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MVLVFM,MTLV01
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      IF (SIZE(MA,DIM=2) == SIZE(MB,DIM=1)) THEN
          NDSAVE = NDIG
          J = MAX(NGRD52,2)
          ND2 = MAX(2*NDIG+J,2)
          NDIG = ND2
          MXSAVE = MXEXP
          DO I = 1, SIZE(MA,DIM=1)
             DO J = 1, SIZE(MB,DIM=2)
                MXEXP = MXEXP2
                CALL FMI2M(0,MTLVFM)
                DO K = 1, SIZE(MA,DIM=2)
                   CALL FMEQU(MA(I,K)%MFM,MULVFM,NDSAVE,NDIG)
                   CALL FMEQU(MB(K,J)%MFM,MVLVFM,NDSAVE,NDIG)
                   CALL FMMPY(MULVFM,MVLVFM,MTLV01)
                   CALL FMADD_R1(MTLVFM,MTLV01)
                ENDDO
                MXEXP = MXSAVE
                CALL FMEQU(MTLVFM,RETURN_VALUE(I,J)%MFM,NDIG,NDSAVE)
             ENDDO
          ENDDO
          NDIG = NDSAVE
      ELSE
          CALL FMI2M(1,MTLVFM)
          CALL FMI2M(0,MULVFM)
          CALL FMDIV(MTLVFM,MULVFM,MVLVFM)
          DO I = 1, SIZE(MA,DIM=1)
             DO J = 1, SIZE(MB,DIM=2)
                CALL FMEQ(MVLVFM,RETURN_VALUE(I,J)%MFM)
             ENDDO
          ENDDO
      ENDIF
   END FUNCTION FMMATMUL22_FM

   FUNCTION FMMATMUL12_FM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA(:),MB(:,:)
      TYPE (FM), DIMENSION(SIZE(MB,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K,MXSAVE,ND2,NDSAVE
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MVLVFM,MTLV01
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      IF (SIZE(MA) == SIZE(MB,DIM=1)) THEN
          NDSAVE = NDIG
          J = MAX(NGRD52,2)
          ND2 = MAX(2*NDIG+J,2)
          NDIG = ND2
          MXSAVE = MXEXP
          DO J = 1, SIZE(MB,DIM=2)
             MXEXP = MXEXP2
             CALL FMI2M(0,MTLVFM)
             DO K = 1, SIZE(MA,DIM=1)
                CALL FMEQU(MA(K)%MFM,MULVFM,NDSAVE,NDIG)
                CALL FMEQU(MB(K,J)%MFM,MVLVFM,NDSAVE,NDIG)
                CALL FMMPY(MULVFM,MVLVFM,MTLV01)
                CALL FMADD_R1(MTLVFM,MTLV01)
             ENDDO
             MXEXP = MXSAVE
             CALL FMEQU(MTLVFM,RETURN_VALUE(J)%MFM,NDIG,NDSAVE)
          ENDDO
          NDIG = NDSAVE
      ELSE
          CALL FMST2M(' UNKNOWN ',MVLVFM)
          DO J = 1, SIZE(MB,DIM=2)
             CALL FMEQ(MVLVFM,RETURN_VALUE(J)%MFM)
          ENDDO
      ENDIF
   END FUNCTION FMMATMUL12_FM

   FUNCTION FMMATMUL21_FM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA(:,:),MB(:)
      TYPE (FM), DIMENSION(SIZE(MA,DIM=1)) :: RETURN_VALUE
      INTEGER :: J,K,MXSAVE,ND2,NDSAVE
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MVLVFM,MTLV01
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      IF (SIZE(MB) == SIZE(MA,DIM=2)) THEN
          NDSAVE = NDIG
          J = MAX(NGRD52,2)
          ND2 = MAX(2*NDIG+J,2)
          NDIG = ND2
          MXSAVE = MXEXP
          DO J = 1, SIZE(MA,DIM=1)
             MXEXP = MXEXP2
             CALL FMI2M(0,MTLVFM)
             DO K = 1, SIZE(MB,DIM=1)
                CALL FMEQU(MA(J,K)%MFM,MULVFM,NDSAVE,NDIG)
                CALL FMEQU(MB(K)%MFM,MVLVFM,NDSAVE,NDIG)
                CALL FMMPY(MULVFM,MVLVFM,MTLV01)
                CALL FMADD_R1(MTLVFM,MTLV01)
             ENDDO
             MXEXP = MXSAVE
             CALL FMEQU(MTLVFM,RETURN_VALUE(J)%MFM,NDIG,NDSAVE)
          ENDDO
          NDIG = NDSAVE
      ELSE
          CALL FMST2M(' UNKNOWN ',MVLVFM)
          DO J = 1, SIZE(MA,DIM=1)
             CALL FMEQ(MVLVFM,RETURN_VALUE(J)%MFM)
          ENDDO
      ENDIF
   END FUNCTION FMMATMUL21_FM

   FUNCTION FMMATMUL22_IM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA(:,:),MB(:,:)
      TYPE (IM), DIMENSION(SIZE(MA,DIM=1),SIZE(MB,DIM=2)) :: RETURN_VALUE
      INTEGER :: I,J,K
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVIM,MULVIM,M3LVIM,MTLV01
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      IF (SIZE(MA,DIM=2) == SIZE(MB,DIM=1)) THEN
          DO I = 1, SIZE(MA,DIM=1)
             DO J = 1, SIZE(MB,DIM=2)
                CALL IMI2M(0,MTLVIM)
                DO K = 1, SIZE(MA,DIM=2)
                   CALL IMMPY(MA(I,K)%MIM,MB(K,J)%MIM,MTLV01)
                   CALL IMADD(MTLVIM,MTLV01,MULVIM)
                   CALL IMEQ(MULVIM,MTLVIM)
                ENDDO
                CALL IMEQ(MTLVIM,RETURN_VALUE(I,J)%MIM)
             ENDDO
          ENDDO
      ELSE
          CALL IMI2M(1,MTLVIM)
          CALL IMI2M(0,MULVIM)
          CALL IMDIV(MTLVIM,MULVIM,M3LVIM)
          DO I = 1, SIZE(MA,DIM=1)
             DO J = 1, SIZE(MB,DIM=2)
                CALL IMEQ(M3LVIM,RETURN_VALUE(I,J)%MIM)
             ENDDO
          ENDDO
      ENDIF
   END FUNCTION FMMATMUL22_IM

   FUNCTION FMMATMUL12_IM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA(:),MB(:,:)
      TYPE (IM), DIMENSION(SIZE(MB,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVIM,MULVIM,MTLV01
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      IF (SIZE(MA) == SIZE(MB,DIM=1)) THEN
          DO J = 1, SIZE(MB,DIM=2)
             CALL IMI2M(0,MTLVIM)
             DO K = 1, SIZE(MA,DIM=1)
                CALL IMMPY(MA(K)%MIM,MB(K,J)%MIM,MTLV01)
                CALL IMADD(MTLVIM,MTLV01,MULVIM)
                CALL IMEQ(MULVIM,MTLVIM)
             ENDDO
             CALL IMEQ(MTLVIM,RETURN_VALUE(J)%MIM)
          ENDDO
      ELSE
          CALL IMST2M(' UNKNOWN ',MULVIM)
          DO J = 1, SIZE(MB,DIM=2)
             CALL IMEQ(MULVIM,RETURN_VALUE(J)%MIM)
          ENDDO
      ENDIF
   END FUNCTION FMMATMUL12_IM

   FUNCTION FMMATMUL21_IM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA(:,:),MB(:)
      TYPE (IM), DIMENSION(SIZE(MA,DIM=1)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVIM,MULVIM,MTLV01
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      IF (SIZE(MB) == SIZE(MA,DIM=2)) THEN
          DO J = 1, SIZE(MA,DIM=1)
             CALL IMI2M(0,MTLVIM)
             DO K = 1, SIZE(MB,DIM=1)
                CALL IMMPY(MA(J,K)%MIM,MB(K)%MIM,MTLV01)
                CALL IMADD(MTLVIM,MTLV01,MULVIM)
                CALL IMEQ(MULVIM,MTLVIM)
             ENDDO
             CALL IMEQ(MTLVIM,RETURN_VALUE(J)%MIM)
          ENDDO
      ELSE
          CALL IMST2M(' UNKNOWN ',MULVIM)
          DO J = 1, SIZE(MA,DIM=1)
             CALL IMEQ(MULVIM,RETURN_VALUE(J)%MIM)
          ENDDO
      ENDIF
   END FUNCTION FMMATMUL21_IM

   FUNCTION FMMATMUL22_ZM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA(:,:),MB(:,:)
      TYPE (ZM), DIMENSION(SIZE(MA,DIM=1),SIZE(MB,DIM=2)) :: RETURN_VALUE
      INTEGER :: I,J,K,MXSAVE,ND2,NDSAVE
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVZM(2),MULVZM(2),MVLVZM(2),MZLV02(2)
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      IF (SIZE(MA,DIM=2) == SIZE(MB,DIM=1)) THEN
          NDSAVE = NDIG
          J = MAX(NGRD52,2)
          ND2 = MAX(2*NDIG+J,2)
          NDIG = ND2
          MXSAVE = MXEXP
          DO I = 1, SIZE(MA,DIM=1)
             DO J = 1, SIZE(MB,DIM=2)
                MXEXP = MXEXP2
                CALL ZMI2M(0,MTLVZM)
                DO K = 1, SIZE(MA,DIM=2)
                   CALL ZMEQU(MA(I,K)%MZM,MULVZM,NDSAVE,NDIG)
                   CALL ZMEQU(MB(K,J)%MZM,MVLVZM,NDSAVE,NDIG)
                   CALL ZMMPY(MULVZM,MVLVZM,MZLV02)
                   CALL ZMADD(MTLVZM,MZLV02,MULVZM)
                   CALL ZMEQ(MULVZM,MTLVZM)
                ENDDO
                MXEXP = MXSAVE
                CALL ZMEQU(MTLVZM,RETURN_VALUE(I,J)%MZM,NDIG,NDSAVE)
             ENDDO
          ENDDO
          NDIG = NDSAVE
      ELSE
          CALL ZMI2M(1,MTLVZM)
          CALL ZMI2M(0,MULVZM)
          CALL ZMDIV(MTLVZM,MULVZM,MVLVZM)
          DO I = 1, SIZE(MA,DIM=1)
             DO J = 1, SIZE(MB,DIM=2)
                CALL ZMEQ(MVLVZM,RETURN_VALUE(I,J)%MZM)
             ENDDO
          ENDDO
      ENDIF
   END FUNCTION FMMATMUL22_ZM

   FUNCTION FMMATMUL12_ZM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA(:),MB(:,:)
      TYPE (ZM), DIMENSION(SIZE(MB,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K,MXSAVE,ND2,NDSAVE
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVZM(2),MULVZM(2),MVLVZM(2),MZLV01(2)
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      IF (SIZE(MA) == SIZE(MB,DIM=1)) THEN
          NDSAVE = NDIG
          J = MAX(NGRD52,2)
          ND2 = MAX(2*NDIG+J,2)
          NDIG = ND2
          MXSAVE = MXEXP
          DO J = 1, SIZE(MB,DIM=2)
             MXEXP = MXEXP2
             CALL ZMI2M(0,MTLVZM)
             DO K = 1, SIZE(MA,DIM=1)
                CALL ZMEQU(MA(K)%MZM,MULVZM,NDSAVE,NDIG)
                CALL ZMEQU(MB(K,J)%MZM,MVLVZM,NDSAVE,NDIG)
                CALL ZMMPY(MULVZM,MVLVZM,MZLV01)
                CALL ZMADD(MTLVZM,MZLV01,MULVZM)
                CALL ZMEQ(MULVZM,MTLVZM)
             ENDDO
             MXEXP = MXSAVE
             CALL ZMEQU(MTLVZM,RETURN_VALUE(J)%MZM,NDIG,NDSAVE)
          ENDDO
          NDIG = NDSAVE
      ELSE
          CALL ZMST2M(' UNKNOWN ',MVLVZM)
          DO J = 1, SIZE(MB,DIM=2)
             CALL ZMEQ(MVLVZM,RETURN_VALUE(J)%MZM)
          ENDDO
      ENDIF
   END FUNCTION FMMATMUL12_ZM

   FUNCTION FMMATMUL21_ZM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA(:,:),MB(:)
      TYPE (ZM), DIMENSION(SIZE(MA,DIM=1)) :: RETURN_VALUE
      INTEGER :: J,K,MXSAVE,ND2,NDSAVE
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVZM(2),MULVZM(2),MVLVZM(2),MZLV01(2)
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      IF (SIZE(MB) == SIZE(MA,DIM=2)) THEN
          NDSAVE = NDIG
          J = MAX(NGRD52,2)
          ND2 = MAX(2*NDIG+J,2)
          NDIG = ND2
          MXSAVE = MXEXP
          DO J = 1, SIZE(MA,DIM=1)
             MXEXP = MXEXP2
             CALL ZMI2M(0,MTLVZM)
             DO K = 1, SIZE(MB,DIM=1)
                CALL ZMEQU(MA(J,K)%MZM,MULVZM,NDSAVE,NDIG)
                CALL ZMEQU(MB(K)%MZM,MVLVZM,NDSAVE,NDIG)
                CALL ZMMPY(MULVZM,MVLVZM,MZLV01)
                CALL ZMADD(MTLVZM,MZLV01,MULVZM)
                CALL ZMEQ(MULVZM,MTLVZM)
             ENDDO
             MXEXP = MXSAVE
             CALL ZMEQU(MTLVZM,RETURN_VALUE(J)%MZM,NDIG,NDSAVE)
          ENDDO
          NDIG = NDSAVE
      ELSE
          CALL ZMST2M(' UNKNOWN ',MVLVZM)
          DO J = 1, SIZE(MA,DIM=1)
             CALL ZMEQ(MVLVZM,RETURN_VALUE(J)%MZM)
          ENDDO
      ENDIF
   END FUNCTION FMMATMUL21_ZM

!                                                                 MAX

   FUNCTION FMMAX_FM(MA,MB,MC,MD,ME,MF,MG,MH,MI,MJ)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA,MB,RETURN_VALUE
      TYPE (FM), OPTIONAL :: MC,MD,ME,MF,MG,MH,MI,MJ
      INTENT (IN) :: MA,MB,MC,MD,ME,MF,MG,MH,MI,MJ
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      CALL FMMAX(MA%MFM,MB%MFM,MTLVFM)
      IF (PRESENT(MC)) THEN
          CALL FM_UNDEF_INP(MC)
          CALL FMMAX(MTLVFM,MC%MFM,MULVFM)
          CALL FMEQ(MULVFM,MTLVFM)
      ENDIF
      IF (PRESENT(MD)) THEN
          CALL FM_UNDEF_INP(MD)
          CALL FMMAX(MTLVFM,MD%MFM,MULVFM)
          CALL FMEQ(MULVFM,MTLVFM)
      ENDIF
      IF (PRESENT(ME)) THEN
          CALL FM_UNDEF_INP(ME)
          CALL FMMAX(MTLVFM,ME%MFM,MULVFM)
          CALL FMEQ(MULVFM,MTLVFM)
      ENDIF
      IF (PRESENT(MF)) THEN
          CALL FM_UNDEF_INP(MF)
          CALL FMMAX(MTLVFM,MF%MFM,MULVFM)
          CALL FMEQ(MULVFM,MTLVFM)
      ENDIF
      IF (PRESENT(MG)) THEN
          CALL FM_UNDEF_INP(MG)
          CALL FMMAX(MTLVFM,MG%MFM,MULVFM)
          CALL FMEQ(MULVFM,MTLVFM)
      ENDIF
      IF (PRESENT(MH)) THEN
          CALL FM_UNDEF_INP(MH)
          CALL FMMAX(MTLVFM,MH%MFM,MULVFM)
          CALL FMEQ(MULVFM,MTLVFM)
      ENDIF
      IF (PRESENT(MI)) THEN
          CALL FM_UNDEF_INP(MI)
          CALL FMMAX(MTLVFM,MI%MFM,MULVFM)
          CALL FMEQ(MULVFM,MTLVFM)
      ENDIF
      IF (PRESENT(MJ)) THEN
          CALL FM_UNDEF_INP(MJ)
          CALL FMMAX(MTLVFM,MJ%MFM,MULVFM)
          CALL FMEQ(MULVFM,MTLVFM)
      ENDIF
      CALL FMEQ(MTLVFM,RETURN_VALUE%MFM)
   END FUNCTION FMMAX_FM

   FUNCTION FMMAX_IM(MA,MB,MC,MD,ME,MF,MG,MH,MI,MJ)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA,MB,RETURN_VALUE
      TYPE (IM), OPTIONAL :: MC,MD,ME,MF,MG,MH,MI,MJ
      INTENT (IN) :: MA,MB,MC,MD,ME,MF,MG,MH,MI,MJ
      TYPE(MULTI), SAVE :: MTLVIM,MULVIM
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      CALL IMMAX(MA%MIM,MB%MIM,MTLVIM)
      IF (PRESENT(MC)) THEN
          CALL FM_UNDEF_INP(MC)
          CALL IMMAX(MTLVIM,MC%MIM,MULVIM)
          CALL IMEQ(MULVIM,MTLVIM)
      ENDIF
      IF (PRESENT(MD)) THEN
          CALL FM_UNDEF_INP(MD)
          CALL IMMAX(MTLVIM,MD%MIM,MULVIM)
          CALL IMEQ(MULVIM,MTLVIM)
      ENDIF
      IF (PRESENT(ME)) THEN
          CALL FM_UNDEF_INP(ME)
          CALL IMMAX(MTLVIM,ME%MIM,MULVIM)
          CALL IMEQ(MULVIM,MTLVIM)
      ENDIF
      IF (PRESENT(MF)) THEN
          CALL FM_UNDEF_INP(MF)
          CALL IMMAX(MTLVIM,MF%MIM,MULVIM)
          CALL IMEQ(MULVIM,MTLVIM)
      ENDIF
      IF (PRESENT(MG)) THEN
          CALL FM_UNDEF_INP(MG)
          CALL IMMAX(MTLVIM,MG%MIM,MULVIM)
          CALL IMEQ(MULVIM,MTLVIM)
      ENDIF
      IF (PRESENT(MH)) THEN
          CALL FM_UNDEF_INP(MH)
          CALL IMMAX(MTLVIM,MH%MIM,MULVIM)
          CALL IMEQ(MULVIM,MTLVIM)
      ENDIF
      IF (PRESENT(MI)) THEN
          CALL FM_UNDEF_INP(MI)
          CALL IMMAX(MTLVIM,MI%MIM,MULVIM)
          CALL IMEQ(MULVIM,MTLVIM)
      ENDIF
      IF (PRESENT(MJ)) THEN
          CALL FM_UNDEF_INP(MJ)
          CALL IMMAX(MTLVIM,MJ%MIM,MULVIM)
          CALL IMEQ(MULVIM,MTLVIM)
      ENDIF
      CALL IMEQ(MTLVIM,RETURN_VALUE%MIM)
   END FUNCTION FMMAX_IM

!                                                         MAXEXPONENT

   FUNCTION FMMAXEXPONENT_FM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA
      INTEGER :: RETURN_VALUE
      INTENT (IN) :: MA
      RETURN_VALUE = INT(MXEXP) + 1
      IF (ALLOCATED(MA%MFM%MP)) THEN
          IF (SIZE(MA%MFM%MP) <= 2) RETURN_VALUE = RETURN_VALUE - 1
      ENDIF
   END FUNCTION FMMAXEXPONENT_FM

!                                                              MAXLOC

   FUNCTION FMMAXLOC1_FM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA(:)
      INTEGER :: RETURN_VALUE
      INTEGER :: J,JA
      LOGICAL, EXTERNAL :: FMCOMP
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: M3LVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMST2M(' -OVERFLOW ',M3LVFM)
      RETURN_VALUE = LBOUND(MA,DIM=1)
      DO J = 1, SIZE(MA)
         JA = LBOUND(MA,DIM=1) + J - 1
         IF (FMCOMP(MA(JA)%MFM,'>',M3LVFM)) THEN
             CALL FMEQ(MA(JA)%MFM,M3LVFM)
             RETURN_VALUE = JA
         ENDIF
      ENDDO
   END FUNCTION FMMAXLOC1_FM

   FUNCTION FMMAXLOC2_FM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA(:,:)
      INTEGER :: RETURN_VALUE(2)
      INTEGER :: J,K,JA,JB
      LOGICAL, EXTERNAL :: FMCOMP
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: M3LVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMST2M(' -OVERFLOW ',M3LVFM)
      RETURN_VALUE = (/ LBOUND(MA,DIM=1), LBOUND(MA,DIM=2) /)
      DO K = 1, SIZE(MA,DIM=2)
         DO J = 1, SIZE(MA,DIM=1)
            JA = LBOUND(MA,DIM=1) + J - 1
            JB = LBOUND(MA,DIM=2) + K - 1
            IF (FMCOMP(MA(JA,JB)%MFM,'>',M3LVFM)) THEN
                CALL FMEQ(MA(JA,JB)%MFM,M3LVFM)
                RETURN_VALUE = (/ JA, JB /)
            ENDIF
         ENDDO
      ENDDO
   END FUNCTION FMMAXLOC2_FM

   FUNCTION FMMAXLOC1_IM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA(:)
      INTEGER :: RETURN_VALUE
      INTEGER :: J,JA
      LOGICAL, EXTERNAL :: IMCOMP
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: M3LVIM
      CALL FM_UNDEF_INP(MA)
      CALL IMST2M(' -OVERFLOW ',M3LVIM)
      RETURN_VALUE = LBOUND(MA,DIM=1)
      DO J = 1, SIZE(MA)
         JA = LBOUND(MA,DIM=1) + J - 1
         IF (IMCOMP(MA(JA)%MIM,'>',M3LVIM)) THEN
             CALL IMEQ(MA(JA)%MIM,M3LVIM)
             RETURN_VALUE = JA
         ENDIF
      ENDDO
   END FUNCTION FMMAXLOC1_IM

   FUNCTION FMMAXLOC2_IM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA(:,:)
      INTEGER :: RETURN_VALUE(2)
      INTEGER :: J,K,JA,JB
      LOGICAL, EXTERNAL :: IMCOMP
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: M3LVIM
      CALL FM_UNDEF_INP(MA)
      CALL IMST2M(' -OVERFLOW ',M3LVIM)
      RETURN_VALUE = (/ LBOUND(MA,DIM=1), LBOUND(MA,DIM=2) /)
      DO K = 1, SIZE(MA,DIM=2)
         DO J = 1, SIZE(MA,DIM=1)
            JA = LBOUND(MA,DIM=1) + J - 1
            JB = LBOUND(MA,DIM=2) + K - 1
            IF (IMCOMP(MA(JA,JB)%MIM,'>',M3LVIM)) THEN
                CALL IMEQ(MA(JA,JB)%MIM,M3LVIM)
                RETURN_VALUE = (/ JA, JB /)
            ENDIF
         ENDDO
      ENDDO
   END FUNCTION FMMAXLOC2_IM

!                                                              MAXVAL

   FUNCTION FMMAXVAL1_FM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA(:),RETURN_VALUE
      INTEGER :: J,JA
      LOGICAL, EXTERNAL :: FMCOMP
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: M3LVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMST2M(' -OVERFLOW ',M3LVFM)
      DO J = 1, SIZE(MA)
         JA = LBOUND(MA,DIM=1) + J - 1
         IF (FMCOMP(MA(JA)%MFM,'>',M3LVFM)) CALL FMEQ(MA(JA)%MFM,M3LVFM)
      ENDDO
      CALL FMEQ(M3LVFM,RETURN_VALUE%MFM)
   END FUNCTION FMMAXVAL1_FM

   FUNCTION FMMAXVAL2_FM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA(:,:),RETURN_VALUE
      INTEGER :: J,K,JA,JB
      LOGICAL, EXTERNAL :: FMCOMP
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: M3LVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMST2M(' -OVERFLOW ',M3LVFM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            JA = LBOUND(MA,DIM=1) + J - 1
            JB = LBOUND(MA,DIM=2) + K - 1
            IF (FMCOMP(MA(JA,JB)%MFM,'>',M3LVFM)) CALL FMEQ(MA(JA,JB)%MFM,M3LVFM)
         ENDDO
      ENDDO
      CALL FMEQ(M3LVFM,RETURN_VALUE%MFM)
   END FUNCTION FMMAXVAL2_FM

   FUNCTION FMMAXVAL1_IM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA(:),RETURN_VALUE
      INTEGER :: J,JA
      LOGICAL, EXTERNAL :: IMCOMP
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: M3LVIM
      CALL FM_UNDEF_INP(MA)
      CALL IMST2M(' -OVERFLOW ',M3LVIM)
      DO J = 1, SIZE(MA)
         JA = LBOUND(MA,DIM=1) + J - 1
         IF (IMCOMP(MA(JA)%MIM,'>',M3LVIM)) CALL IMEQ(MA(JA)%MIM,M3LVIM)
      ENDDO
      CALL IMEQ(M3LVIM,RETURN_VALUE%MIM)
   END FUNCTION FMMAXVAL1_IM

   FUNCTION FMMAXVAL2_IM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA(:,:),RETURN_VALUE
      INTEGER :: J,K,JA,JB
      LOGICAL, EXTERNAL :: IMCOMP
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: M3LVIM
      CALL FM_UNDEF_INP(MA)
      CALL IMST2M(' -OVERFLOW ',M3LVIM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            JA = LBOUND(MA,DIM=1) + J - 1
            JB = LBOUND(MA,DIM=2) + K - 1
            IF (IMCOMP(MA(JA,JB)%MIM,'>',M3LVIM)) CALL IMEQ(MA(JA,JB)%MIM,M3LVIM)
         ENDDO
      ENDDO
      CALL IMEQ(M3LVIM,RETURN_VALUE%MIM)
   END FUNCTION FMMAXVAL2_IM

!                                                                 MIN

   FUNCTION FMMIN_FM(MA,MB,MC,MD,ME,MF,MG,MH,MI,MJ)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA,MB,RETURN_VALUE
      TYPE (FM), OPTIONAL :: MC,MD,ME,MF,MG,MH,MI,MJ
      INTENT (IN) :: MA,MB,MC,MD,ME,MF,MG,MH,MI,MJ
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      CALL FMMIN(MA%MFM,MB%MFM,MTLVFM)
      IF (PRESENT(MC)) THEN
          CALL FM_UNDEF_INP(MC)
          CALL FMMIN(MTLVFM,MC%MFM,MULVFM)
          CALL FMEQ(MULVFM,MTLVFM)
      ENDIF
      IF (PRESENT(MD)) THEN
          CALL FM_UNDEF_INP(MD)
          CALL FMMIN(MTLVFM,MD%MFM,MULVFM)
          CALL FMEQ(MULVFM,MTLVFM)
      ENDIF
      IF (PRESENT(ME)) THEN
          CALL FM_UNDEF_INP(ME)
          CALL FMMIN(MTLVFM,ME%MFM,MULVFM)
          CALL FMEQ(MULVFM,MTLVFM)
      ENDIF
      IF (PRESENT(MF)) THEN
          CALL FM_UNDEF_INP(MF)
          CALL FMMIN(MTLVFM,MF%MFM,MULVFM)
          CALL FMEQ(MULVFM,MTLVFM)
      ENDIF
      IF (PRESENT(MG)) THEN
          CALL FM_UNDEF_INP(MG)
          CALL FMMIN(MTLVFM,MG%MFM,MULVFM)
          CALL FMEQ(MULVFM,MTLVFM)
      ENDIF
      IF (PRESENT(MH)) THEN
          CALL FM_UNDEF_INP(MH)
          CALL FMMIN(MTLVFM,MH%MFM,MULVFM)
          CALL FMEQ(MULVFM,MTLVFM)
      ENDIF
      IF (PRESENT(MI)) THEN
          CALL FM_UNDEF_INP(MI)
          CALL FMMIN(MTLVFM,MI%MFM,MULVFM)
          CALL FMEQ(MULVFM,MTLVFM)
      ENDIF
      IF (PRESENT(MJ)) THEN
          CALL FM_UNDEF_INP(MJ)
          CALL FMMIN(MTLVFM,MJ%MFM,MULVFM)
          CALL FMEQ(MULVFM,MTLVFM)
      ENDIF
      CALL FMEQ(MTLVFM,RETURN_VALUE%MFM)
   END FUNCTION FMMIN_FM

   FUNCTION FMMIN_IM(MA,MB,MC,MD,ME,MF,MG,MH,MI,MJ)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA,MB,RETURN_VALUE
      TYPE (IM), OPTIONAL :: MC,MD,ME,MF,MG,MH,MI,MJ
      INTENT (IN) :: MA,MB,MC,MD,ME,MF,MG,MH,MI,MJ
      TYPE(MULTI), SAVE :: MTLVIM,MULVIM
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      CALL IMMIN(MA%MIM,MB%MIM,MTLVIM)
      IF (PRESENT(MC)) THEN
          CALL FM_UNDEF_INP(MC)
          CALL IMMIN(MTLVIM,MC%MIM,MULVIM)
          CALL IMEQ(MULVIM,MTLVIM)
      ENDIF
      IF (PRESENT(MD)) THEN
          CALL FM_UNDEF_INP(MD)
          CALL IMMIN(MTLVIM,MD%MIM,MULVIM)
          CALL IMEQ(MULVIM,MTLVIM)
      ENDIF
      IF (PRESENT(ME)) THEN
          CALL FM_UNDEF_INP(ME)
          CALL IMMIN(MTLVIM,ME%MIM,MULVIM)
          CALL IMEQ(MULVIM,MTLVIM)
      ENDIF
      IF (PRESENT(MF)) THEN
          CALL FM_UNDEF_INP(MF)
          CALL IMMIN(MTLVIM,MF%MIM,MULVIM)
          CALL IMEQ(MULVIM,MTLVIM)
      ENDIF
      IF (PRESENT(MG)) THEN
          CALL FM_UNDEF_INP(MG)
          CALL IMMIN(MTLVIM,MG%MIM,MULVIM)
          CALL IMEQ(MULVIM,MTLVIM)
      ENDIF
      IF (PRESENT(MH)) THEN
          CALL FM_UNDEF_INP(MH)
          CALL IMMIN(MTLVIM,MH%MIM,MULVIM)
          CALL IMEQ(MULVIM,MTLVIM)
      ENDIF
      IF (PRESENT(MI)) THEN
          CALL FM_UNDEF_INP(MI)
          CALL IMMIN(MTLVIM,MI%MIM,MULVIM)
          CALL IMEQ(MULVIM,MTLVIM)
      ENDIF
      IF (PRESENT(MJ)) THEN
          CALL FM_UNDEF_INP(MJ)
          CALL IMMIN(MTLVIM,MJ%MIM,MULVIM)
          CALL IMEQ(MULVIM,MTLVIM)
      ENDIF
      CALL IMEQ(MTLVIM,RETURN_VALUE%MIM)
   END FUNCTION FMMIN_IM

!                                                         MINEXPONENT

   FUNCTION FMMINEXPONENT_FM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA
      INTEGER :: RETURN_VALUE
      INTENT (IN) :: MA
      RETURN_VALUE = -INT(MXEXP)
      IF (ALLOCATED(MA%MFM%MP)) THEN
          IF (SIZE(MA%MFM%MP) <= 2) RETURN_VALUE = RETURN_VALUE - 1
      ENDIF
   END FUNCTION FMMINEXPONENT_FM

!                                                              MINVAL

   FUNCTION FMMINVAL1_FM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA(:),RETURN_VALUE
      INTEGER :: J,JA
      LOGICAL, EXTERNAL :: FMCOMP
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: M3LVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMST2M(' OVERFLOW ',M3LVFM)
      DO J = 1, SIZE(MA)
         JA = LBOUND(MA,DIM=1) + J - 1
         IF (FMCOMP(MA(JA)%MFM,'<',M3LVFM)) CALL FMEQ(MA(JA)%MFM,M3LVFM)
      ENDDO
      CALL FMEQ(M3LVFM,RETURN_VALUE%MFM)
   END FUNCTION FMMINVAL1_FM

   FUNCTION FMMINVAL2_FM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA(:,:),RETURN_VALUE
      INTEGER :: J,K,JA,JB
      LOGICAL, EXTERNAL :: FMCOMP
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: M3LVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMST2M(' OVERFLOW ',M3LVFM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            JA = LBOUND(MA,DIM=1) + J - 1
            JB = LBOUND(MA,DIM=2) + K - 1
            IF (FMCOMP(MA(JA,JB)%MFM,'<',M3LVFM)) CALL FMEQ(MA(JA,JB)%MFM,M3LVFM)
         ENDDO
      ENDDO
      CALL FMEQ(M3LVFM,RETURN_VALUE%MFM)
   END FUNCTION FMMINVAL2_FM

   FUNCTION FMMINVAL1_IM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA(:),RETURN_VALUE
      INTEGER :: J,JA
      LOGICAL, EXTERNAL :: IMCOMP
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: M3LVIM
      CALL FM_UNDEF_INP(MA)
      CALL IMST2M(' OVERFLOW ',M3LVIM)
      DO J = 1, SIZE(MA)
         JA = LBOUND(MA,DIM=1) + J - 1
         IF (IMCOMP(MA(JA)%MIM,'<',M3LVIM)) CALL IMEQ(MA(JA)%MIM,M3LVIM)
      ENDDO
      CALL IMEQ(M3LVIM,RETURN_VALUE%MIM)
   END FUNCTION FMMINVAL1_IM

   FUNCTION FMMINVAL2_IM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA(:,:),RETURN_VALUE
      INTEGER :: J,K,JA,JB
      LOGICAL, EXTERNAL :: IMCOMP
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: M3LVIM
      CALL FM_UNDEF_INP(MA)
      CALL IMST2M(' OVERFLOW ',M3LVIM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            JA = LBOUND(MA,DIM=1) + J - 1
            JB = LBOUND(MA,DIM=2) + K - 1
            IF (IMCOMP(MA(JA,JB)%MIM,'<',M3LVIM)) CALL IMEQ(MA(JA,JB)%MIM,M3LVIM)
         ENDDO
      ENDDO
      CALL IMEQ(M3LVIM,RETURN_VALUE%MIM)
   END FUNCTION FMMINVAL2_IM

!                                                              MINLOC

   FUNCTION FMMINLOC1_FM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA(:)
      INTEGER :: RETURN_VALUE
      INTEGER :: J,JA
      LOGICAL, EXTERNAL :: FMCOMP
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: M3LVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMST2M(' OVERFLOW ',M3LVFM)
      RETURN_VALUE = LBOUND(MA,DIM=1)
      DO J = 1, SIZE(MA)
         JA = LBOUND(MA,DIM=1) + J - 1
         IF (FMCOMP(MA(JA)%MFM,'<',M3LVFM)) THEN
             CALL FMEQ(MA(JA)%MFM,M3LVFM)
             RETURN_VALUE = JA
         ENDIF
      ENDDO
   END FUNCTION FMMINLOC1_FM

   FUNCTION FMMINLOC2_FM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA(:,:)
      INTEGER :: RETURN_VALUE(2)
      INTEGER :: J,K,JA,JB
      LOGICAL, EXTERNAL :: FMCOMP
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: M3LVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMST2M(' OVERFLOW ',M3LVFM)
      RETURN_VALUE = (/ LBOUND(MA,DIM=1), LBOUND(MA,DIM=2) /)
      DO K = 1, SIZE(MA,DIM=2)
         DO J = 1, SIZE(MA,DIM=1)
            JA = LBOUND(MA,DIM=1) + J - 1
            JB = LBOUND(MA,DIM=2) + K - 1
            IF (FMCOMP(MA(JA,JB)%MFM,'<',M3LVFM)) THEN
                CALL FMEQ(MA(JA,JB)%MFM,M3LVFM)
                RETURN_VALUE = (/ JA, JB /)
            ENDIF
         ENDDO
      ENDDO
   END FUNCTION FMMINLOC2_FM

   FUNCTION FMMINLOC1_IM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA(:)
      INTEGER :: RETURN_VALUE
      INTEGER :: J,JA
      LOGICAL, EXTERNAL :: IMCOMP
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: M3LVIM
      CALL FM_UNDEF_INP(MA)
      CALL IMST2M(' OVERFLOW ',M3LVIM)
      RETURN_VALUE = LBOUND(MA,DIM=1)
      DO J = 1, SIZE(MA)
         JA = LBOUND(MA,DIM=1) + J - 1
         IF (IMCOMP(MA(JA)%MIM,'<',M3LVIM)) THEN
             CALL IMEQ(MA(JA)%MIM,M3LVIM)
             RETURN_VALUE = JA
         ENDIF
      ENDDO
   END FUNCTION FMMINLOC1_IM

   FUNCTION FMMINLOC2_IM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA(:,:)
      INTEGER :: RETURN_VALUE(2)
      INTEGER :: J,K,JA,JB
      LOGICAL, EXTERNAL :: IMCOMP
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: M3LVIM
      CALL FM_UNDEF_INP(MA)
      CALL IMST2M(' OVERFLOW ',M3LVIM)
      RETURN_VALUE = (/ LBOUND(MA,DIM=1), LBOUND(MA,DIM=2) /)
      DO K = 1, SIZE(MA,DIM=2)
         DO J = 1, SIZE(MA,DIM=1)
            JA = LBOUND(MA,DIM=1) + J - 1
            JB = LBOUND(MA,DIM=2) + K - 1
            IF (IMCOMP(MA(JA,JB)%MIM,'<',M3LVIM)) THEN
                CALL IMEQ(MA(JA,JB)%MIM,M3LVIM)
                RETURN_VALUE = (/ JA, JB /)
            ENDIF
         ENDDO
      ENDDO
   END FUNCTION FMMINLOC2_IM

!                                                                 MOD

   FUNCTION FMMOD_FM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA,MB,RETURN_VALUE
      INTENT (IN) :: MA,MB
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      CALL FMMOD(MA%MFM,MB%MFM,RETURN_VALUE%MFM)
   END FUNCTION FMMOD_FM

   FUNCTION FMMOD_IM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA,MB,RETURN_VALUE
      INTENT (IN) :: MA,MB
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      CALL IMMOD(MA%MIM,MB%MIM,RETURN_VALUE%MIM)
   END FUNCTION FMMOD_IM

!                                                              MODULO

   FUNCTION FMMODULO_FM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA,MB,RETURN_VALUE
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      CALL FMMOD(MA%MFM,MB%MFM,MTLVFM)
      IF (MTLVFM%MP(3) /= 0) THEN
          IF ((MA%MFM%MP(3) > 0 .AND. MA%MFM%MP(1) > 0 .AND.  &
               MB%MFM%MP(3) > 0 .AND. MB%MFM%MP(1) < 0) .OR.  &
              (MA%MFM%MP(3) > 0 .AND. MA%MFM%MP(1) < 0 .AND.  &
               MB%MFM%MP(3) > 0 .AND. MB%MFM%MP(1) > 0)) THEN
              CALL FMADD_R1(MTLVFM,MB%MFM)
          ENDIF
      ENDIF
      CALL FMEQ(MTLVFM,RETURN_VALUE%MFM)
   END FUNCTION FMMODULO_FM

   FUNCTION FMMODULO_IM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA,MB,RETURN_VALUE
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVIM,MULVIM
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      CALL IMMOD(MA%MIM,MB%MIM,MTLVIM)
      IF (MTLVIM%MP(3) /= 0) THEN
          IF ((MA%MIM%MP(3) > 0 .AND. MA%MIM%MP(1) > 0 .AND.  &
               MB%MIM%MP(3) > 0 .AND. MB%MIM%MP(1) < 0) .OR.  &
              (MA%MIM%MP(3) > 0 .AND. MA%MIM%MP(1) < 0 .AND.  &
               MB%MIM%MP(3) > 0 .AND. MB%MIM%MP(1) > 0)) THEN
              CALL IMADD(MTLVIM,MB%MIM,MULVIM)
              CALL IMEQ(MULVIM,MTLVIM)
          ENDIF
      ENDIF
      CALL IMEQ(MTLVIM,RETURN_VALUE%MIM)
   END FUNCTION FMMODULO_IM

!                                                             NEAREST

   FUNCTION FMNEAREST_FM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA,MB,RETURN_VALUE
      INTEGER :: KRSAVE
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: M3LVFM
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      KRSAVE = KROUND
      CALL FMTINY(M3LVFM)
      IF (MA%MFM%MP(2) /= MEXPUN) THEN
          IF (MB%MFM%MP(1) > 0) THEN
              KROUND = 2
              CALL FMADD(MA%MFM,M3LVFM,RETURN_VALUE%MFM)
          ELSE
              KROUND = -1
              CALL FMSUB(MA%MFM,M3LVFM,RETURN_VALUE%MFM)
          ENDIF
      ELSE
          IF (MA%MFM%MP(1) > 0 .AND. MB%MFM%MP(1) > 0) THEN
              CALL FMEQ(M3LVFM,RETURN_VALUE%MFM)
          ELSE IF (MA%MFM%MP(1) > 0 .AND. MB%MFM%MP(1) < 0) THEN
              CALL FMI2M(0,RETURN_VALUE%MFM)
          ELSE IF (MA%MFM%MP(1) < 0 .AND. MB%MFM%MP(1) > 0) THEN
              CALL FMI2M(0,RETURN_VALUE%MFM)
          ELSE
              CALL FMMPYI_R1(M3LVFM,-1)
              CALL FMEQ(M3LVFM,RETURN_VALUE%MFM)
          ENDIF
      ENDIF
      KROUND = KRSAVE
   END FUNCTION FMNEAREST_FM

!                                                                NINT

   FUNCTION FMNINT_FM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA
      TYPE (IM) :: RETURN_VALUE
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMNINT(MA%MFM,MTLVFM)
      CALL IMFM2I(MTLVFM,RETURN_VALUE%MIM)
   END FUNCTION FMNINT_FM

   FUNCTION FMNINT_IM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA,RETURN_VALUE
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL IMEQ(MA%MIM,RETURN_VALUE%MIM)
   END FUNCTION FMNINT_IM

   FUNCTION FMNINT_ZM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA
      TYPE (IM) :: RETURN_VALUE
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM
      CALL FM_UNDEF_INP(MA)
      CALL ZMREAL(MA%MZM,MTLVFM)
      CALL FMNINT(MTLVFM,MULVFM)
      CALL IMFM2I(MULVFM,RETURN_VALUE%MIM)
   END FUNCTION FMNINT_ZM

   FUNCTION FMNINT_FM1(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      TYPE (IM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA
      TYPE(IM), SAVE :: MT_IM
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      DO J = 1, N
         CALL IM_EQ(FMNINT_FM(MA(J)),MT_IM)
         CALL IMEQ(MT_IM%MIM,RETURN_VALUE(J)%MIM)
      ENDDO
   END FUNCTION FMNINT_FM1

   FUNCTION FMNINT_IM1(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:) :: MA
      TYPE (IM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA
      TYPE(IM), SAVE :: MT_IM
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      DO J = 1, N
         CALL IM_EQ(FMNINT_IM(MA(J)),MT_IM)
         CALL IMEQ(MT_IM%MIM,RETURN_VALUE(J)%MIM)
      ENDDO
   END FUNCTION FMNINT_IM1

   FUNCTION FMNINT_ZM1(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      TYPE (IM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA
      TYPE(IM), SAVE :: MT_IM
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      DO J = 1, N
         CALL IM_EQ(FMNINT_ZM(MA(J)),MT_IM)
         CALL IMEQ(MT_IM%MIM,RETURN_VALUE(J)%MIM)
      ENDDO
   END FUNCTION FMNINT_ZM1

   FUNCTION FMNINT_FM2(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      TYPE (IM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA
      TYPE(IM), SAVE :: MT_IM
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL IM_EQ(FMNINT_FM(MA(J,K)),MT_IM)
            CALL IMEQ(MT_IM%MIM,RETURN_VALUE(J,K)%MIM)
         ENDDO
      ENDDO
   END FUNCTION FMNINT_FM2

   FUNCTION FMNINT_IM2(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:,:) :: MA
      TYPE (IM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA
      TYPE(IM), SAVE :: MT_IM
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL IM_EQ(FMNINT_IM(MA(J,K)),MT_IM)
            CALL IMEQ(MT_IM%MIM,RETURN_VALUE(J,K)%MIM)
         ENDDO
      ENDDO
   END FUNCTION FMNINT_IM2

   FUNCTION FMNINT_ZM2(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      TYPE (IM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA
      TYPE(IM), SAVE :: MT_IM
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL IM_EQ(FMNINT_ZM(MA(J,K)),MT_IM)
            CALL IMEQ(MT_IM%MIM,RETURN_VALUE(J,K)%MIM)
         ENDDO
      ENDDO
   END FUNCTION FMNINT_ZM2

!                                                             NORM2

   FUNCTION FMNORM21_FM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA(:),RETURN_VALUE
      TYPE(MULTI), ALLOCATABLE :: A(:)
      INTEGER :: J,JA,N
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL FMI2M(0,RETURN_VALUE%MFM)
      N = SIZE(MA)
      ALLOCATE(A(N))
      DO J = 1, N
         JA = LBOUND(MA,DIM=1) + J - 1
         CALL FMEQ(MA(JA)%MFM,A(J))
      ENDDO
      CALL FMNORM2(A,N,RETURN_VALUE%MFM)
      DEALLOCATE(A)
   END FUNCTION FMNORM21_FM

!                                                           PRECISION

   FUNCTION FMPRECISION_FM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA
      INTEGER :: RETURN_VALUE
      INTENT (IN) :: MA
      RETURN_VALUE = INT(LOG10(REAL(MBASE))*(NDIG-1) + 1)
      IF (ALLOCATED(MA%MFM%MP)) THEN
          IF (SIZE(MA%MFM%MP) <= 2) RETURN_VALUE = RETURN_VALUE - 1
      ENDIF
   END FUNCTION FMPRECISION_FM

   FUNCTION FMPRECISION_ZM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA
      INTEGER :: RETURN_VALUE
      INTENT (IN) :: MA
      RETURN_VALUE = INT(LOG10(REAL(MBASE))*(NDIG-1) + 1)
      IF (ALLOCATED(MA%MZM(1)%MP)) THEN
          IF (SIZE(MA%MZM(1)%MP) <= 2) RETURN_VALUE = RETURN_VALUE - 1
      ENDIF
   END FUNCTION FMPRECISION_ZM

!                                                             PRODUCT

   FUNCTION FMPRODUCT1_FM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA(:),RETURN_VALUE
      INTEGER :: J,JA,MXSAVE,ND2,NDSAVE
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: MULVFM,M3LVFM
      CALL FM_UNDEF_INP(MA)
      NDSAVE = NDIG
      J = MAX(NGRD52,2)
      ND2 = MAX(2*NDIG+J,2)
      NDIG = ND2
      MXSAVE = MXEXP
      MXEXP = MXEXP2
      CALL FMI2M(1,M3LVFM)
      DO J = 1, SIZE(MA)
         JA = LBOUND(MA,DIM=1) + J - 1
         CALL FMEQU(MA(JA)%MFM,MULVFM,NDSAVE,NDIG)
         CALL FMMPY_R1(M3LVFM,MULVFM)
      ENDDO
      MXEXP = MXSAVE
      CALL FMEQU(M3LVFM,RETURN_VALUE%MFM,NDIG,NDSAVE)
      NDIG = NDSAVE
   END FUNCTION FMPRODUCT1_FM

   FUNCTION FMPRODUCT2_FM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA(:,:),RETURN_VALUE
      INTEGER :: J,K,JA,JB,MXSAVE,ND2,NDSAVE
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: MULVFM,M3LVFM
      CALL FM_UNDEF_INP(MA)
      NDSAVE = NDIG
      J = MAX(NGRD52,2)
      ND2 = MAX(2*NDIG+J,2)
      NDIG = ND2
      MXSAVE = MXEXP
      MXEXP = MXEXP2
      CALL FMI2M(1,M3LVFM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            JA = LBOUND(MA,DIM=1) + J - 1
            JB = LBOUND(MA,DIM=2) + K - 1
            CALL FMEQU(MA(JA,JB)%MFM,MULVFM,NDSAVE,NDIG)
            CALL FMMPY_R1(M3LVFM,MULVFM)
         ENDDO
      ENDDO
      MXEXP = MXSAVE
      CALL FMEQU(M3LVFM,RETURN_VALUE%MFM,NDIG,NDSAVE)
      NDIG = NDSAVE
   END FUNCTION FMPRODUCT2_FM

   FUNCTION FMPRODUCT1_IM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA(:),RETURN_VALUE
      INTEGER :: J,JA
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: MTLVIM,M3LVIM
      CALL FM_UNDEF_INP(MA)
      CALL IMI2M(1,M3LVIM)
      DO J = 1, SIZE(MA)
         JA = LBOUND(MA,DIM=1) + J - 1
         CALL IMMPY(MA(JA)%MIM,M3LVIM,MTLVIM)
         CALL IMEQ(MTLVIM,M3LVIM)
      ENDDO
      CALL IMEQ(M3LVIM,RETURN_VALUE%MIM)
   END FUNCTION FMPRODUCT1_IM

   FUNCTION FMPRODUCT2_IM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA(:,:),RETURN_VALUE
      INTEGER :: J,K,JA,JB
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: MTLVIM,M3LVIM
      CALL FM_UNDEF_INP(MA)
      CALL IMI2M(1,M3LVIM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            JA = LBOUND(MA,DIM=1) + J - 1
            JB = LBOUND(MA,DIM=2) + K - 1
            CALL IMMPY(MA(JA,JB)%MIM,M3LVIM,MTLVIM)
            CALL IMEQ(MTLVIM,M3LVIM)
         ENDDO
      ENDDO
      CALL IMEQ(M3LVIM,RETURN_VALUE%MIM)
   END FUNCTION FMPRODUCT2_IM

   FUNCTION FMPRODUCT1_ZM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA(:),RETURN_VALUE
      INTEGER :: J,JA,MXSAVE,ND2,NDSAVE
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: MTLVZM(2),MULVZM(2),M3LVZM(2)
      CALL FM_UNDEF_INP(MA)
      NDSAVE = NDIG
      J = MAX(NGRD52,2)
      ND2 = MAX(2*NDIG+J,2)
      NDIG = ND2
      MXSAVE = MXEXP
      MXEXP = MXEXP2
      CALL ZMI2M(1,M3LVZM)
      DO J = 1, SIZE(MA)
         JA = LBOUND(MA,DIM=1) + J - 1
         CALL ZMEQU(MA(JA)%MZM,MULVZM,NDSAVE,NDIG)
         CALL ZMMPY(MULVZM,M3LVZM,MTLVZM)
         CALL ZMEQ(MTLVZM,M3LVZM)
      ENDDO
      MXEXP = MXSAVE
      CALL ZMEQU(M3LVZM,RETURN_VALUE%MZM,NDIG,NDSAVE)
      NDIG = NDSAVE
   END FUNCTION FMPRODUCT1_ZM

   FUNCTION FMPRODUCT2_ZM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA(:,:),RETURN_VALUE
      INTEGER :: J,K,JA,JB,MXSAVE,ND2,NDSAVE
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: MTLVZM(2),MULVZM(2),M3LVZM(2)
      CALL FM_UNDEF_INP(MA)
      NDSAVE = NDIG
      J = MAX(NGRD52,2)
      ND2 = MAX(2*NDIG+J,2)
      NDIG = ND2
      MXSAVE = MXEXP
      MXEXP = MXEXP2
      CALL ZMI2M(1,M3LVZM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            JA = LBOUND(MA,DIM=1) + J - 1
            JB = LBOUND(MA,DIM=2) + K - 1
            CALL ZMEQU(MA(JA,JB)%MZM,MULVZM,NDSAVE,NDIG)
            CALL ZMMPY(MULVZM,M3LVZM,MTLVZM)
            CALL ZMEQ(MTLVZM,M3LVZM)
         ENDDO
      ENDDO
      MXEXP = MXSAVE
      CALL ZMEQU(M3LVZM,RETURN_VALUE%MZM,NDIG,NDSAVE)
      NDIG = NDSAVE
   END FUNCTION FMPRODUCT2_ZM

!                                                               RADIX

   FUNCTION FMRADIX_FM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA
      INTEGER :: RETURN_VALUE
      INTENT (IN) :: MA
      RETURN_VALUE = INT(MBASE)
      IF (ALLOCATED(MA%MFM%MP)) THEN
          IF (SIZE(MA%MFM%MP) <= 2) RETURN_VALUE = RETURN_VALUE - 1
      ENDIF
   END FUNCTION FMRADIX_FM

   FUNCTION FMRADIX_IM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA
      INTEGER :: RETURN_VALUE
      INTENT (IN) :: MA
      RETURN_VALUE = INT(MBASE)
      IF (ALLOCATED(MA%MIM%MP)) THEN
          IF (SIZE(MA%MIM%MP) <= 2) RETURN_VALUE = RETURN_VALUE - 1
      ENDIF
   END FUNCTION FMRADIX_IM

   FUNCTION FMRADIX_ZM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA
      INTEGER :: RETURN_VALUE
      INTENT (IN) :: MA
      RETURN_VALUE = INT(MBASE)
      IF (ALLOCATED(MA%MZM(1)%MP)) THEN
          IF (SIZE(MA%MZM(1)%MP) <= 2) RETURN_VALUE = RETURN_VALUE - 1
      ENDIF
   END FUNCTION FMRADIX_ZM

!                                                               RANGE

   FUNCTION FMRANGE_FM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA
      INTEGER :: RETURN_VALUE
      INTENT (IN) :: MA
      RETURN_VALUE = NINT((MXEXP+1)*LOG10(DBLE(MBASE))) - 1
      IF (ALLOCATED(MA%MFM%MP)) THEN
          IF (SIZE(MA%MFM%MP) <= 2) RETURN_VALUE = RETURN_VALUE - 1
      ENDIF
   END FUNCTION FMRANGE_FM

   FUNCTION FMRANGE_IM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA
      INTEGER :: RETURN_VALUE
      INTENT (IN) :: MA

!             The number of possible digits for type(im) integers is limited only by the amount
!             of memory that can be allocated.  Return 10**6 since there is no fixed limit.

      RETURN_VALUE = 10**6
      IF (ALLOCATED(MA%MIM%MP)) THEN
          IF (SIZE(MA%MIM%MP) <= 2) RETURN_VALUE = RETURN_VALUE - 1
      ENDIF
   END FUNCTION FMRANGE_IM

   FUNCTION FMRANGE_ZM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA
      INTEGER :: RETURN_VALUE
      INTENT (IN) :: MA
      RETURN_VALUE = NINT((MXEXP+1)*LOG10(DBLE(MBASE))) - 1
      IF (ALLOCATED(MA%MZM(1)%MP)) THEN
          IF (SIZE(MA%MZM(1)%MP) <= 2) RETURN_VALUE = RETURN_VALUE - 1
      ENDIF
   END FUNCTION FMRANGE_ZM


!                                                                REAL

   FUNCTION FMREAL_FM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA,RETURN_VALUE
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL FMEQ(MA%MFM,RETURN_VALUE%MFM)
   END FUNCTION FMREAL_FM

   FUNCTION FMREAL_IM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: RETURN_VALUE
      TYPE (IM) :: MA
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL IMI2FM(MA%MIM,RETURN_VALUE%MFM)
   END FUNCTION FMREAL_IM

   FUNCTION FMREAL_ZM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: RETURN_VALUE
      TYPE (ZM) :: MA
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL ZMREAL(MA%MZM,RETURN_VALUE%MFM)
   END FUNCTION FMREAL_ZM

!                                                           RRSPACING

   FUNCTION FMRRSPACING_FM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA,RETURN_VALUE
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMABS(MA%MFM,MTLVFM)
      MTLVFM%MP(2) = NDIG
      CALL FMEQ(MTLVFM,RETURN_VALUE%MFM)
   END FUNCTION FMRRSPACING_FM

!                                                               SCALE

   FUNCTION FMSCALE_FM(MA,L)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA,RETURN_VALUE
      INTEGER :: L
      INTENT (IN) :: MA,L
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MVLVFM,M3LVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMEQ(MA%MFM,MTLVFM)
      IF (ABS(MTLVFM%MP(2)+L) < MXEXP) THEN
          MTLVFM%MP(2) = MTLVFM%MP(2) + L
          CALL FMEQ(MTLVFM,RETURN_VALUE%MFM)
      ELSE
          CALL FMI2M(INT(MBASE),MULVFM)
          CALL FMIPWR(MULVFM,L,MVLVFM)
          CALL FMMPY(MA%MFM,MVLVFM,M3LVFM)
          CALL FMEQ(M3LVFM,RETURN_VALUE%MFM)
      ENDIF
   END FUNCTION FMSCALE_FM

   FUNCTION FMSCALE_ZM(MA,L)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      INTEGER :: L
      TYPE (ZM) :: MA,RETURN_VALUE
      INTENT (IN) :: MA,L
      TYPE(MULTI), SAVE :: MTLVZM(2),MULVZM(2),MVLVZM(2),M3LVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL ZMEQ(MA%MZM,MTLVZM)
      IF (ABS(MTLVZM(1)%MP(2)+L) < MXEXP .AND. &
          ABS(MTLVZM(2)%MP(2)+L) < MXEXP) THEN
          MTLVZM(1)%MP(2) = MTLVZM(1)%MP(2) + L
          MTLVZM(2)%MP(2) = MTLVZM(2)%MP(2) + L
          CALL ZMEQ(MTLVZM,RETURN_VALUE%MZM)
      ELSE
          CALL ZMI2M(INT(MBASE),MULVZM)
          CALL ZMIPWR(MULVZM,L,MVLVZM)
          CALL ZMMPY(MA%MZM,MVLVZM,M3LVZM)
          CALL ZMEQ(M3LVZM,RETURN_VALUE%MZM)
      ENDIF
   END FUNCTION FMSCALE_ZM

!                                                         SETEXPONENT

   FUNCTION FMSETEXPONENT_FM(MA,L)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA,RETURN_VALUE
      INTEGER :: L
      INTENT (IN) :: MA,L
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMEQ(MA%MFM,MTLVFM)
      MTLVFM%MP(2) = L
      CALL FMEQ(MTLVFM,RETURN_VALUE%MFM)
   END FUNCTION FMSETEXPONENT_FM

!                                                                SIGN

   FUNCTION FMSIGN_FM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA,MB,RETURN_VALUE
      INTENT (IN) :: MA,MB
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      CALL FMSIGN(MA%MFM,MB%MFM,RETURN_VALUE%MFM)
   END FUNCTION FMSIGN_FM

   FUNCTION FMSIGN_IM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA,MB,RETURN_VALUE
      INTENT (IN) :: MA,MB
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      CALL IMSIGN(MA%MIM,MB%MIM,RETURN_VALUE%MIM)
   END FUNCTION FMSIGN_IM

 END MODULE ModLib_FMZM_8
