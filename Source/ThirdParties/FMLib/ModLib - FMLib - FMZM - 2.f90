
 MODULE ModLib_FMZM_2
    USE ModLib_FMZM_1

!   These abbreviations are used for operations on the various data types.

!   I    Integer
!   R    Real
!   D    Double Precision
!   Z    Complex
!   C    Complex Double Precision
!   FM   Multiple precision real
!   IM   Multiple precision integer
!   ZM   Multiple precision complex

!   For example, the "=" procedure FMEQ_FMD is for statements like X = A, where X is type FM
!   and A is type Double Precision.

!   Digits refer to the number of dimensions (rank) for an array.
!   FMEQ_FM1R handles statements like A = 1.0, where A is a 1-dimensional array of type FM and the
!   right side (1.0) is real.  Like the ordinary Fortran array syntax, this sets all the elements
!   of array A to 1.0.

    INTERFACE ASSIGNMENT (=)
       MODULE PROCEDURE FMEQ_IFM
       MODULE PROCEDURE FMEQ_IIM
       MODULE PROCEDURE FMEQ_IZM
       MODULE PROCEDURE FMEQ_RFM
       MODULE PROCEDURE FMEQ_RIM
       MODULE PROCEDURE FMEQ_RZM
       MODULE PROCEDURE FMEQ_DFM
       MODULE PROCEDURE FMEQ_DIM
       MODULE PROCEDURE FMEQ_DZM
       MODULE PROCEDURE FMEQ_ZFM
       MODULE PROCEDURE FMEQ_ZIM
       MODULE PROCEDURE FMEQ_ZZM
       MODULE PROCEDURE FMEQ_CFM
       MODULE PROCEDURE FMEQ_CIM
       MODULE PROCEDURE FMEQ_CZM
       MODULE PROCEDURE FMEQ_FMI
       MODULE PROCEDURE FMEQ_FMR
       MODULE PROCEDURE FMEQ_FMD
       MODULE PROCEDURE FMEQ_FMZ
       MODULE PROCEDURE FMEQ_FMC
       MODULE PROCEDURE FMEQ_FMFM
       MODULE PROCEDURE FMEQ_FMIM
       MODULE PROCEDURE FMEQ_FMZM
       MODULE PROCEDURE FMEQ_IMI
       MODULE PROCEDURE FMEQ_IMR
       MODULE PROCEDURE FMEQ_IMD
       MODULE PROCEDURE FMEQ_IMZ
       MODULE PROCEDURE FMEQ_IMC
       MODULE PROCEDURE FMEQ_IMFM
       MODULE PROCEDURE FMEQ_IMIM
       MODULE PROCEDURE FMEQ_IMZM
       MODULE PROCEDURE FMEQ_ZMI
       MODULE PROCEDURE FMEQ_ZMR
       MODULE PROCEDURE FMEQ_ZMD
       MODULE PROCEDURE FMEQ_ZMZ
       MODULE PROCEDURE FMEQ_ZMC
       MODULE PROCEDURE FMEQ_ZMFM
       MODULE PROCEDURE FMEQ_ZMIM
       MODULE PROCEDURE FMEQ_ZMZM
       MODULE PROCEDURE FMEQ_FM1I
       MODULE PROCEDURE FMEQ_FM1R
       MODULE PROCEDURE FMEQ_FM1D
       MODULE PROCEDURE FMEQ_FM1Z
       MODULE PROCEDURE FMEQ_FM1C
       MODULE PROCEDURE FMEQ_I1FM
       MODULE PROCEDURE FMEQ_R1FM
       MODULE PROCEDURE FMEQ_D1FM
       MODULE PROCEDURE FMEQ_Z1FM
       MODULE PROCEDURE FMEQ_C1FM
       MODULE PROCEDURE FMEQ_FM1FM
       MODULE PROCEDURE FMEQ_FM1IM
       MODULE PROCEDURE FMEQ_FM1ZM
       MODULE PROCEDURE FMEQ_IM1FM
       MODULE PROCEDURE FMEQ_ZM1FM
       MODULE PROCEDURE FMEQ_FM1I1
       MODULE PROCEDURE FMEQ_FM1R1
       MODULE PROCEDURE FMEQ_FM1D1
       MODULE PROCEDURE FMEQ_FM1Z1
       MODULE PROCEDURE FMEQ_FM1C1
       MODULE PROCEDURE FMEQ_I1FM1
       MODULE PROCEDURE FMEQ_R1FM1
       MODULE PROCEDURE FMEQ_D1FM1
       MODULE PROCEDURE FMEQ_Z1FM1
       MODULE PROCEDURE FMEQ_C1FM1
       MODULE PROCEDURE FMEQ_FM1FM1
       MODULE PROCEDURE FMEQ_FM1IM1
       MODULE PROCEDURE FMEQ_FM1ZM1
       MODULE PROCEDURE FMEQ_IM1FM1
       MODULE PROCEDURE FMEQ_ZM1FM1
       MODULE PROCEDURE FMEQ_IM1I
       MODULE PROCEDURE FMEQ_IM1R
       MODULE PROCEDURE FMEQ_IM1D
       MODULE PROCEDURE FMEQ_IM1Z
       MODULE PROCEDURE FMEQ_IM1C
       MODULE PROCEDURE FMEQ_I1IM
       MODULE PROCEDURE FMEQ_R1IM
       MODULE PROCEDURE FMEQ_D1IM
       MODULE PROCEDURE FMEQ_Z1IM
       MODULE PROCEDURE FMEQ_C1IM
       MODULE PROCEDURE FMEQ_IM1IM
       MODULE PROCEDURE FMEQ_IM1ZM
       MODULE PROCEDURE FMEQ_ZM1IM
       MODULE PROCEDURE FMEQ_IM1I1
       MODULE PROCEDURE FMEQ_IM1R1
       MODULE PROCEDURE FMEQ_IM1D1
       MODULE PROCEDURE FMEQ_IM1Z1
       MODULE PROCEDURE FMEQ_IM1C1
       MODULE PROCEDURE FMEQ_I1IM1
       MODULE PROCEDURE FMEQ_R1IM1
       MODULE PROCEDURE FMEQ_D1IM1
       MODULE PROCEDURE FMEQ_Z1IM1
       MODULE PROCEDURE FMEQ_C1IM1
       MODULE PROCEDURE FMEQ_IM1IM1
       MODULE PROCEDURE FMEQ_IM1ZM1
       MODULE PROCEDURE FMEQ_ZM1IM1
       MODULE PROCEDURE FMEQ_ZM1I
       MODULE PROCEDURE FMEQ_ZM1R
       MODULE PROCEDURE FMEQ_ZM1D
       MODULE PROCEDURE FMEQ_ZM1Z
       MODULE PROCEDURE FMEQ_ZM1C
       MODULE PROCEDURE FMEQ_I1ZM
       MODULE PROCEDURE FMEQ_R1ZM
       MODULE PROCEDURE FMEQ_D1ZM
       MODULE PROCEDURE FMEQ_Z1ZM
       MODULE PROCEDURE FMEQ_C1ZM
       MODULE PROCEDURE FMEQ_ZM1ZM
       MODULE PROCEDURE FMEQ_ZM1I1
       MODULE PROCEDURE FMEQ_ZM1R1
       MODULE PROCEDURE FMEQ_ZM1D1
       MODULE PROCEDURE FMEQ_ZM1Z1
       MODULE PROCEDURE FMEQ_ZM1C1
       MODULE PROCEDURE FMEQ_I1ZM1
       MODULE PROCEDURE FMEQ_R1ZM1
       MODULE PROCEDURE FMEQ_D1ZM1
       MODULE PROCEDURE FMEQ_Z1ZM1
       MODULE PROCEDURE FMEQ_C1ZM1
       MODULE PROCEDURE FMEQ_ZM1ZM1
       MODULE PROCEDURE FMEQ_FM2I
       MODULE PROCEDURE FMEQ_FM2R
       MODULE PROCEDURE FMEQ_FM2D
       MODULE PROCEDURE FMEQ_FM2Z
       MODULE PROCEDURE FMEQ_FM2C
       MODULE PROCEDURE FMEQ_I2FM
       MODULE PROCEDURE FMEQ_R2FM
       MODULE PROCEDURE FMEQ_D2FM
       MODULE PROCEDURE FMEQ_Z2FM
       MODULE PROCEDURE FMEQ_C2FM
       MODULE PROCEDURE FMEQ_FM2FM
       MODULE PROCEDURE FMEQ_FM2IM
       MODULE PROCEDURE FMEQ_FM2ZM
       MODULE PROCEDURE FMEQ_IM2FM
       MODULE PROCEDURE FMEQ_ZM2FM
       MODULE PROCEDURE FMEQ_FM2I2
       MODULE PROCEDURE FMEQ_FM2R2
       MODULE PROCEDURE FMEQ_FM2D2
       MODULE PROCEDURE FMEQ_FM2Z2
       MODULE PROCEDURE FMEQ_FM2C2
       MODULE PROCEDURE FMEQ_I2FM2
       MODULE PROCEDURE FMEQ_R2FM2
       MODULE PROCEDURE FMEQ_D2FM2
       MODULE PROCEDURE FMEQ_Z2FM2
       MODULE PROCEDURE FMEQ_C2FM2
       MODULE PROCEDURE FMEQ_FM2FM2
       MODULE PROCEDURE FMEQ_FM2IM2
       MODULE PROCEDURE FMEQ_FM2ZM2
       MODULE PROCEDURE FMEQ_IM2FM2
       MODULE PROCEDURE FMEQ_ZM2FM2
       MODULE PROCEDURE FMEQ_IM2I
       MODULE PROCEDURE FMEQ_IM2R
       MODULE PROCEDURE FMEQ_IM2D
       MODULE PROCEDURE FMEQ_IM2Z
       MODULE PROCEDURE FMEQ_IM2C
       MODULE PROCEDURE FMEQ_I2IM
       MODULE PROCEDURE FMEQ_R2IM
       MODULE PROCEDURE FMEQ_D2IM
       MODULE PROCEDURE FMEQ_Z2IM
       MODULE PROCEDURE FMEQ_C2IM
       MODULE PROCEDURE FMEQ_IM2IM
       MODULE PROCEDURE FMEQ_IM2ZM
       MODULE PROCEDURE FMEQ_ZM2IM
       MODULE PROCEDURE FMEQ_IM2I2
       MODULE PROCEDURE FMEQ_IM2R2
       MODULE PROCEDURE FMEQ_IM2D2
       MODULE PROCEDURE FMEQ_IM2Z2
       MODULE PROCEDURE FMEQ_IM2C2
       MODULE PROCEDURE FMEQ_I2IM2
       MODULE PROCEDURE FMEQ_R2IM2
       MODULE PROCEDURE FMEQ_D2IM2
       MODULE PROCEDURE FMEQ_Z2IM2
       MODULE PROCEDURE FMEQ_C2IM2
       MODULE PROCEDURE FMEQ_IM2IM2
       MODULE PROCEDURE FMEQ_IM2ZM2
       MODULE PROCEDURE FMEQ_ZM2IM2
       MODULE PROCEDURE FMEQ_ZM2I
       MODULE PROCEDURE FMEQ_ZM2R
       MODULE PROCEDURE FMEQ_ZM2D
       MODULE PROCEDURE FMEQ_ZM2Z
       MODULE PROCEDURE FMEQ_ZM2C
       MODULE PROCEDURE FMEQ_I2ZM
       MODULE PROCEDURE FMEQ_R2ZM
       MODULE PROCEDURE FMEQ_D2ZM
       MODULE PROCEDURE FMEQ_Z2ZM
       MODULE PROCEDURE FMEQ_C2ZM
       MODULE PROCEDURE FMEQ_ZM2ZM
       MODULE PROCEDURE FMEQ_ZM2I2
       MODULE PROCEDURE FMEQ_ZM2R2
       MODULE PROCEDURE FMEQ_ZM2D2
       MODULE PROCEDURE FMEQ_ZM2Z2
       MODULE PROCEDURE FMEQ_ZM2C2
       MODULE PROCEDURE FMEQ_I2ZM2
       MODULE PROCEDURE FMEQ_R2ZM2
       MODULE PROCEDURE FMEQ_D2ZM2
       MODULE PROCEDURE FMEQ_Z2ZM2
       MODULE PROCEDURE FMEQ_C2ZM2
       MODULE PROCEDURE FMEQ_ZM2ZM2
    END INTERFACE

    INTERFACE OPERATOR (==)
       MODULE PROCEDURE FMLEQ_IFM
       MODULE PROCEDURE FMLEQ_IIM
       MODULE PROCEDURE FMLEQ_IZM
       MODULE PROCEDURE FMLEQ_RFM
       MODULE PROCEDURE FMLEQ_RIM
       MODULE PROCEDURE FMLEQ_RZM
       MODULE PROCEDURE FMLEQ_DFM
       MODULE PROCEDURE FMLEQ_DIM
       MODULE PROCEDURE FMLEQ_DZM
       MODULE PROCEDURE FMLEQ_ZFM
       MODULE PROCEDURE FMLEQ_ZIM
       MODULE PROCEDURE FMLEQ_ZZM
       MODULE PROCEDURE FMLEQ_CFM
       MODULE PROCEDURE FMLEQ_CIM
       MODULE PROCEDURE FMLEQ_CZM
       MODULE PROCEDURE FMLEQ_FMI
       MODULE PROCEDURE FMLEQ_FMR
       MODULE PROCEDURE FMLEQ_FMD
       MODULE PROCEDURE FMLEQ_FMZ
       MODULE PROCEDURE FMLEQ_FMC
       MODULE PROCEDURE FMLEQ_FMFM
       MODULE PROCEDURE FMLEQ_FMIM
       MODULE PROCEDURE FMLEQ_FMZM
       MODULE PROCEDURE FMLEQ_IMI
       MODULE PROCEDURE FMLEQ_IMR
       MODULE PROCEDURE FMLEQ_IMD
       MODULE PROCEDURE FMLEQ_IMZ
       MODULE PROCEDURE FMLEQ_IMC
       MODULE PROCEDURE FMLEQ_IMFM
       MODULE PROCEDURE FMLEQ_IMIM
       MODULE PROCEDURE FMLEQ_IMZM
       MODULE PROCEDURE FMLEQ_ZMI
       MODULE PROCEDURE FMLEQ_ZMR
       MODULE PROCEDURE FMLEQ_ZMD
       MODULE PROCEDURE FMLEQ_ZMZ
       MODULE PROCEDURE FMLEQ_ZMC
       MODULE PROCEDURE FMLEQ_ZMFM
       MODULE PROCEDURE FMLEQ_ZMIM
       MODULE PROCEDURE FMLEQ_ZMZM
    END INTERFACE

!  The next two functions are no longer needed in version 1.4.
!  Dummy versions of the individual procedures are included for compatibility with version 1.3.

    INTERFACE FM_ENTER_USER_FUNCTION
       MODULE PROCEDURE FM_ENTER_USER_FUNCTION_FM
       MODULE PROCEDURE FM_ENTER_USER_FUNCTION_FM1
       MODULE PROCEDURE FM_ENTER_USER_FUNCTION_FM2
       MODULE PROCEDURE FM_ENTER_USER_FUNCTION_IM
       MODULE PROCEDURE FM_ENTER_USER_FUNCTION_IM1
       MODULE PROCEDURE FM_ENTER_USER_FUNCTION_IM2
       MODULE PROCEDURE FM_ENTER_USER_FUNCTION_ZM
       MODULE PROCEDURE FM_ENTER_USER_FUNCTION_ZM1
       MODULE PROCEDURE FM_ENTER_USER_FUNCTION_ZM2
    END INTERFACE

    INTERFACE FM_EXIT_USER_FUNCTION
       MODULE PROCEDURE FM_EXIT_USER_FUNCTION_FM
       MODULE PROCEDURE FM_EXIT_USER_FUNCTION_FM1
       MODULE PROCEDURE FM_EXIT_USER_FUNCTION_FM2
       MODULE PROCEDURE FM_EXIT_USER_FUNCTION_IM
       MODULE PROCEDURE FM_EXIT_USER_FUNCTION_IM1
       MODULE PROCEDURE FM_EXIT_USER_FUNCTION_IM2
       MODULE PROCEDURE FM_EXIT_USER_FUNCTION_ZM
       MODULE PROCEDURE FM_EXIT_USER_FUNCTION_ZM1
       MODULE PROCEDURE FM_EXIT_USER_FUNCTION_ZM2
    END INTERFACE


 CONTAINS

   SUBROUTINE FM_ENTER_USER_FUNCTION_FM(F_NAME)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: F_NAME
      IF (.NOT. ALLOCATED(F_NAME%MFM%MP) .AND. NDIG < 0) WRITE (*,*) ' Invalid NDIG = ', NDIG
   END SUBROUTINE FM_ENTER_USER_FUNCTION_FM

   SUBROUTINE FM_ENTER_USER_FUNCTION_FM1(F_NAME)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: F_NAME
      IF (SIZE(F_NAME) < 0 .AND. NDIG < 0) WRITE (*,*) ' Invalid NDIG = ', NDIG
   END SUBROUTINE FM_ENTER_USER_FUNCTION_FM1

   SUBROUTINE FM_ENTER_USER_FUNCTION_FM2(F_NAME)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: F_NAME
      IF (SIZE(F_NAME) < 0 .AND. NDIG < 0) WRITE (*,*) ' Invalid NDIG = ', NDIG
   END SUBROUTINE FM_ENTER_USER_FUNCTION_FM2

   SUBROUTINE FM_ENTER_USER_FUNCTION_IM(F_NAME)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: F_NAME
      IF (.NOT. ALLOCATED(F_NAME%MIM%MP) .AND. NDIG < 0) WRITE (*,*) ' Invalid NDIG = ', NDIG
   END SUBROUTINE FM_ENTER_USER_FUNCTION_IM

   SUBROUTINE FM_ENTER_USER_FUNCTION_IM1(F_NAME)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:) :: F_NAME
      IF (SIZE(F_NAME) < 0 .AND. NDIG < 0) WRITE (*,*) ' Invalid NDIG = ', NDIG
   END SUBROUTINE FM_ENTER_USER_FUNCTION_IM1

   SUBROUTINE FM_ENTER_USER_FUNCTION_IM2(F_NAME)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:,:) :: F_NAME
      IF (SIZE(F_NAME) < 0 .AND. NDIG < 0) WRITE (*,*) ' Invalid NDIG = ', NDIG
   END SUBROUTINE FM_ENTER_USER_FUNCTION_IM2

   SUBROUTINE FM_ENTER_USER_FUNCTION_ZM(F_NAME)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: F_NAME
      IF (.NOT. ALLOCATED(F_NAME%MZM(1)%MP) .AND. NDIG < 0) WRITE (*,*) ' Invalid NDIG = ', NDIG
   END SUBROUTINE FM_ENTER_USER_FUNCTION_ZM

   SUBROUTINE FM_ENTER_USER_FUNCTION_ZM1(F_NAME)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: F_NAME
      IF (SIZE(F_NAME) < 0 .AND. NDIG < 0) WRITE (*,*) ' Invalid NDIG = ', NDIG
   END SUBROUTINE FM_ENTER_USER_FUNCTION_ZM1

   SUBROUTINE FM_ENTER_USER_FUNCTION_ZM2(F_NAME)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: F_NAME
      IF (SIZE(F_NAME) < 0 .AND. NDIG < 0) WRITE (*,*) ' Invalid NDIG = ', NDIG
   END SUBROUTINE FM_ENTER_USER_FUNCTION_ZM2

   SUBROUTINE FM_EXIT_USER_FUNCTION_FM(F_NAME)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: F_NAME
      IF (.NOT. ALLOCATED(F_NAME%MFM%MP) .AND. NDIG < 0) WRITE (*,*) ' Invalid NDIG = ', NDIG
   END SUBROUTINE FM_EXIT_USER_FUNCTION_FM

   SUBROUTINE FM_EXIT_USER_FUNCTION_FM1(F_NAME)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: F_NAME
      IF (SIZE(F_NAME) < 0 .AND. NDIG < 0) WRITE (*,*) ' Invalid NDIG = ', NDIG
   END SUBROUTINE FM_EXIT_USER_FUNCTION_FM1

   SUBROUTINE FM_EXIT_USER_FUNCTION_FM2(F_NAME)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: F_NAME
      IF (SIZE(F_NAME) < 0 .AND. NDIG < 0) WRITE (*,*) ' Invalid NDIG = ', NDIG
   END SUBROUTINE FM_EXIT_USER_FUNCTION_FM2

   SUBROUTINE FM_EXIT_USER_FUNCTION_IM(F_NAME)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: F_NAME
      IF (.NOT. ALLOCATED(F_NAME%MIM%MP) .AND. NDIG < 0) WRITE (*,*) ' Invalid NDIG = ', NDIG
   END SUBROUTINE FM_EXIT_USER_FUNCTION_IM

   SUBROUTINE FM_EXIT_USER_FUNCTION_IM1(F_NAME)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:) :: F_NAME
      IF (SIZE(F_NAME) < 0 .AND. NDIG < 0) WRITE (*,*) ' Invalid NDIG = ', NDIG
   END SUBROUTINE FM_EXIT_USER_FUNCTION_IM1

   SUBROUTINE FM_EXIT_USER_FUNCTION_IM2(F_NAME)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:,:) :: F_NAME
      IF (SIZE(F_NAME) < 0 .AND. NDIG < 0) WRITE (*,*) ' Invalid NDIG = ', NDIG
   END SUBROUTINE FM_EXIT_USER_FUNCTION_IM2

   SUBROUTINE FM_EXIT_USER_FUNCTION_ZM(F_NAME)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: F_NAME
      IF (.NOT. ALLOCATED(F_NAME%MZM(1)%MP) .AND. NDIG < 0) WRITE (*,*) ' Invalid NDIG = ', NDIG
   END SUBROUTINE FM_EXIT_USER_FUNCTION_ZM

   SUBROUTINE FM_EXIT_USER_FUNCTION_ZM1(F_NAME)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: F_NAME
      IF (SIZE(F_NAME) < 0 .AND. NDIG < 0) WRITE (*,*) ' Invalid NDIG = ', NDIG
   END SUBROUTINE FM_EXIT_USER_FUNCTION_ZM1

   SUBROUTINE FM_EXIT_USER_FUNCTION_ZM2(F_NAME)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: F_NAME
      IF (SIZE(F_NAME) < 0 .AND. NDIG < 0) WRITE (*,*) ' Invalid NDIG = ', NDIG
   END SUBROUTINE FM_EXIT_USER_FUNCTION_ZM2

   SUBROUTINE FM_ENTER_USER_ROUTINE
      USE ModLib_FMVALS
      IMPLICIT NONE
      IF (NDIG < 0) WRITE (*,*) ' Invalid NDIG = ', NDIG
   END SUBROUTINE FM_ENTER_USER_ROUTINE

   SUBROUTINE FM_EXIT_USER_ROUTINE
      USE ModLib_FMVALS
      IMPLICIT NONE
      IF (NDIG < 0) WRITE (*,*) ' Invalid NDIG = ', NDIG
   END SUBROUTINE FM_EXIT_USER_ROUTINE


!                                                                   =

   SUBROUTINE FMEQ_IFM(IVAL,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA
      INTEGER :: IVAL
      INTENT (INOUT) :: IVAL
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL FMM2I(MA%MFM,IVAL)
   END SUBROUTINE FMEQ_IFM

   SUBROUTINE FMEQ_IIM(IVAL,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA
      INTEGER :: IVAL
      INTENT (INOUT) :: IVAL
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL IMM2I(MA%MIM,IVAL)
   END SUBROUTINE FMEQ_IIM

   SUBROUTINE FMEQ_IZM(IVAL,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA
      INTEGER :: IVAL
      INTENT (INOUT) :: IVAL
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL ZMM2I(MA%MZM,IVAL)
   END SUBROUTINE FMEQ_IZM

   SUBROUTINE FMEQ_RFM(R,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA
      REAL :: R
      INTENT (INOUT) :: R
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL FMM2SP(MA%MFM,R)
   END SUBROUTINE FMEQ_RFM

   SUBROUTINE FMEQ_RIM(R,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA
      REAL :: R
      INTENT (INOUT) :: R
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL IMI2FM(MA%MIM,MTLVFM)
      CALL FMM2SP(MTLVFM,R)
   END SUBROUTINE FMEQ_RIM

   SUBROUTINE FMEQ_RZM(R,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA
      REAL :: R
      INTENT (INOUT) :: R
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL ZMREAL(MA%MZM,MTLVFM)
      CALL FMM2SP(MTLVFM,R)
   END SUBROUTINE FMEQ_RZM

   SUBROUTINE FMEQ_DFM(D,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA
      DOUBLE PRECISION :: D
      INTENT (INOUT) :: D
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL FMM2DP(MA%MFM,D)
   END SUBROUTINE FMEQ_DFM

   SUBROUTINE FMEQ_DIM(D,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA
      DOUBLE PRECISION :: D
      INTENT (INOUT) :: D
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL IMM2DP(MA%MIM,D)
   END SUBROUTINE FMEQ_DIM

   SUBROUTINE FMEQ_DZM(D,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA
      DOUBLE PRECISION :: D
      INTENT (INOUT) :: D
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL ZMREAL(MA%MZM,MTLVFM)
      CALL FMM2DP(MTLVFM,D)
   END SUBROUTINE FMEQ_DZM

   SUBROUTINE FMEQ_ZFM(Z,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA
      COMPLEX :: Z
      REAL :: R
      INTENT (INOUT) :: Z
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL FMM2SP(MA%MFM,R)
      Z = CMPLX( R , 0.0 )
   END SUBROUTINE FMEQ_ZFM

   SUBROUTINE FMEQ_ZIM(Z,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA
      COMPLEX :: Z
      DOUBLE PRECISION :: D
      INTENT (INOUT) :: Z
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL IMM2DP(MA%MIM,D)
      Z = CMPLX( REAL(D) , 0.0 )
   END SUBROUTINE FMEQ_ZIM

   SUBROUTINE FMEQ_ZZM(Z,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA
      COMPLEX :: Z
      INTENT (INOUT) :: Z
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL ZMM2Z(MA%MZM,Z)
   END SUBROUTINE FMEQ_ZZM

   SUBROUTINE FMEQ_CFM(C,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA
      COMPLEX (KIND(0.0D0)) :: C
      DOUBLE PRECISION :: D
      INTENT (INOUT) :: C
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL FMM2DP(MA%MFM,D)
      C = CMPLX( D , 0.0D0 , KIND(0.0D0) )
   END SUBROUTINE FMEQ_CFM

   SUBROUTINE FMEQ_CIM(C,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA
      COMPLEX (KIND(0.0D0)) :: C
      DOUBLE PRECISION :: D
      INTENT (INOUT) :: C
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL IMM2DP(MA%MIM,D)
      C = CMPLX( D , 0.0D0 , KIND(0.0D0) )
   END SUBROUTINE FMEQ_CIM

   SUBROUTINE FMEQ_CZM(C,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA
      COMPLEX (KIND(0.0D0)) :: C
      DOUBLE PRECISION :: D1,D2
      INTENT (INOUT) :: C
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL ZMREAL(MA%MZM,MTLVFM)
      CALL FMM2DP(MTLVFM,D1)
      CALL ZMIMAG(MA%MZM,MTLVFM)
      CALL FMM2DP(MTLVFM,D2)
      C = CMPLX( D1 , D2 , KIND(0.0D0) )
   END SUBROUTINE FMEQ_CZM

   SUBROUTINE FMEQ_FMI(MA,IVAL)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA
      INTEGER :: IVAL
      INTENT (INOUT) :: MA
      INTENT (IN) :: IVAL
      CALL FMI2M(IVAL,MA%MFM)
   END SUBROUTINE FMEQ_FMI

   SUBROUTINE FMEQ_FMR(MA,R)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA
      REAL :: R
      INTENT (INOUT) :: MA
      INTENT (IN) :: R
      CALL FMSP2M(R,MA%MFM)
   END SUBROUTINE FMEQ_FMR

   SUBROUTINE FMEQ_FMD(MA,D)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA
      DOUBLE PRECISION :: D
      INTENT (INOUT) :: MA
      INTENT (IN) :: D
      CALL FMDP2M(D,MA%MFM)
   END SUBROUTINE FMEQ_FMD

   SUBROUTINE FMEQ_FMZ(MA,Z)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA
      COMPLEX :: Z
      REAL :: R
      INTENT (INOUT) :: MA
      INTENT (IN) :: Z
      R = REAL(Z)
      CALL FMSP2M(R,MA%MFM)
   END SUBROUTINE FMEQ_FMZ

   SUBROUTINE FMEQ_FMC(MA,C)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA
      COMPLEX (KIND(0.0D0)) :: C
      DOUBLE PRECISION :: D
      INTENT (INOUT) :: MA
      INTENT (IN) :: C
      D = REAL(C,KIND(0.0D0))
      CALL FMDP2M(D,MA%MFM)
   END SUBROUTINE FMEQ_FMC

   SUBROUTINE FMEQ_FMFM(MA,MB)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA,MB
      INTENT (INOUT) :: MA
      INTENT (IN) :: MB
      CALL FM_UNDEF_INP(MB)
      CALL FMEQ(MB%MFM,MA%MFM)
   END SUBROUTINE FMEQ_FMFM

   SUBROUTINE FMEQ_FMIM(MA,MB)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA
      TYPE (IM) :: MB
      INTENT (INOUT) :: MA
      INTENT (IN) :: MB
      CALL FM_UNDEF_INP(MB)
      CALL IMI2FM(MB%MIM,MA%MFM)
   END SUBROUTINE FMEQ_FMIM

   SUBROUTINE FMEQ_FMZM(MA,MB)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA
      TYPE (ZM) :: MB
      INTENT (INOUT) :: MA
      INTENT (IN) :: MB
      CALL FM_UNDEF_INP(MB)
      CALL ZMREAL(MB%MZM,MA%MFM)
   END SUBROUTINE FMEQ_FMZM

   SUBROUTINE FMEQ_IMI(MA,IVAL)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA
      INTEGER :: IVAL
      INTENT (INOUT) :: MA
      INTENT (IN) :: IVAL
      CALL IMI2M(IVAL,MA%MIM)
   END SUBROUTINE FMEQ_IMI

   SUBROUTINE FMEQ_IMR(MA,R)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA
      INTEGER :: IVAL
      REAL :: R
      CHARACTER(25) :: ST
      INTENT (INOUT) :: MA
      INTENT (IN) :: R
      IF (ABS(R) < HUGE(1)) THEN
          IVAL = INT(R)
          CALL IMI2M(IVAL,MA%MIM)
      ELSE
          WRITE (ST,'(E25.16)') R
          CALL IMST2M(ST,MA%MIM)
      ENDIF
   END SUBROUTINE FMEQ_IMR

   SUBROUTINE FMEQ_IMD(MA,D)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA
      INTEGER :: IVAL
      DOUBLE PRECISION :: D
      CHARACTER(25) :: ST
      INTENT (INOUT) :: MA
      INTENT (IN) :: D
      IF (ABS(D) < HUGE(1)) THEN
          IVAL = INT(D)
          CALL IMI2M(IVAL,MA%MIM)
      ELSE
          WRITE (ST,'(E25.16)') D
          CALL IMST2M(ST,MA%MIM)
      ENDIF
   END SUBROUTINE FMEQ_IMD

   SUBROUTINE FMEQ_IMZ(MA,Z)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA
      COMPLEX :: Z
      REAL :: R
      CHARACTER(25) :: ST
      INTEGER :: IVAL
      INTENT (INOUT) :: MA
      INTENT (IN) :: Z
      R = REAL(Z)
      IF (ABS(R) < HUGE(1)) THEN
          IVAL = INT(R)
          CALL IMI2M(IVAL,MA%MIM)
      ELSE
          WRITE (ST,'(E25.16)') R
          CALL IMST2M(ST,MA%MIM)
      ENDIF
   END SUBROUTINE FMEQ_IMZ

   SUBROUTINE FMEQ_IMC(MA,C)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA
      COMPLEX (KIND(0.0D0)) :: C
      DOUBLE PRECISION :: D
      CHARACTER(25) :: ST
      INTEGER :: IVAL
      INTENT (INOUT) :: MA
      INTENT (IN) :: C
      D = REAL(C,KIND(0.0D0))
      IF (ABS(D) < HUGE(1)) THEN
          IVAL = INT(D)
          CALL IMI2M(IVAL,MA%MIM)
      ELSE
          WRITE (ST,'(E25.16)') D
          CALL IMST2M(ST,MA%MIM)
      ENDIF
   END SUBROUTINE FMEQ_IMC

   SUBROUTINE FMEQ_IMFM(MA,MB)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA
      TYPE (FM) :: MB
      INTENT (INOUT) :: MA
      INTENT (IN) :: MB
      CALL FM_UNDEF_INP(MB)
      CALL IMFM2I(MB%MFM,MA%MIM)
   END SUBROUTINE FMEQ_IMFM

   SUBROUTINE FMEQ_IMIM(MA,MB)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA,MB
      INTENT (INOUT) :: MA
      INTENT (IN) :: MB
      CALL FM_UNDEF_INP(MB)
      CALL IMEQ(MB%MIM,MA%MIM)
   END SUBROUTINE FMEQ_IMIM

   SUBROUTINE FMEQ_IMZM(MA,MB)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA
      TYPE (ZM) :: MB
      INTENT (INOUT) :: MA
      INTENT (IN) :: MB
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MB)
      CALL ZMREAL(MB%MZM,MTLVFM)
      CALL IMFM2I(MTLVFM,MA%MIM)
   END SUBROUTINE FMEQ_IMZM

   SUBROUTINE FMEQ_ZMI(MA,IVAL)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA
      INTEGER :: IVAL
      INTENT (INOUT) :: MA
      INTENT (IN) :: IVAL
      CALL ZMI2M(IVAL,MA%MZM)
   END SUBROUTINE FMEQ_ZMI

   SUBROUTINE FMEQ_ZMR(MA,R)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA
      REAL :: R
      COMPLEX :: Z
      INTENT (INOUT) :: MA
      INTENT (IN) :: R
      Z = CMPLX(R,0.0)
      CALL ZMZ2M(Z,MA%MZM)
   END SUBROUTINE FMEQ_ZMR

   SUBROUTINE FMEQ_ZMD(MA,D)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA
      DOUBLE PRECISION :: D
      INTENT (INOUT) :: MA
      INTENT (IN) :: D
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM
      CALL FMDP2M(D,MTLVFM)
      CALL FMDP2M(0.0D0,MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MA%MZM)
   END SUBROUTINE FMEQ_ZMD

   SUBROUTINE FMEQ_ZMZ(MA,Z)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA
      COMPLEX :: Z
      INTENT (INOUT) :: MA
      INTENT (IN) :: Z
      CALL ZMZ2M(Z,MA%MZM)
   END SUBROUTINE FMEQ_ZMZ

   SUBROUTINE FMEQ_ZMC(MA,C)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA
      COMPLEX (KIND(0.0D0)) :: C
      DOUBLE PRECISION :: D
      INTENT (INOUT) :: MA
      INTENT (IN) :: C
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM
      D = REAL(C,KIND(0.0D0))
      CALL FMDP2M(D,MTLVFM)
      D = AIMAG(C)
      CALL FMDP2M(D,MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MA%MZM)
   END SUBROUTINE FMEQ_ZMC

   SUBROUTINE FMEQ_ZMFM(MA,MB)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MB
      TYPE (ZM) :: MA
      INTENT (INOUT) :: MA
      INTENT (IN) :: MB
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM
      CALL FM_UNDEF_INP(MB)
      CALL FMEQ(MB%MFM,MTLVFM)
      CALL FMI2M(0,MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MA%MZM)
   END SUBROUTINE FMEQ_ZMFM

   SUBROUTINE FMEQ_ZMIM(MA,MB)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MB
      TYPE (ZM) :: MA
      INTENT (INOUT) :: MA
      INTENT (IN) :: MB
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM
      CALL FM_UNDEF_INP(MB)
      CALL IMI2FM(MB%MIM,MTLVFM)
      CALL FMI2M(0,MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MA%MZM)
   END SUBROUTINE FMEQ_ZMIM

   SUBROUTINE FMEQ_ZMZM(MA,MB)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA,MB
      INTENT (INOUT) :: MA
      INTENT (IN) :: MB
      TYPE(MULTI), SAVE :: MTLVZM(2)
      CALL FM_UNDEF_INP(MB)
      CALL ZMEQ(MB%MZM,MTLVZM)
      CALL ZMEQ(MTLVZM,MA%MZM)
   END SUBROUTINE FMEQ_ZMZM

!             Array equal assignments for FM.

!             (1) rank 1  =  rank 0

   SUBROUTINE FMEQ_FM1I(MA,IVAL)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      INTEGER :: IVAL,J,N
      INTENT (INOUT) :: MA
      INTENT (IN) :: IVAL
      TYPE(MULTI), SAVE :: MTLVFM
      N = SIZE(MA)
      CALL FMI2M(IVAL,MTLVFM)
      DO J = 1, N
         CALL FMEQ(MTLVFM,MA(J)%MFM)
      ENDDO
   END SUBROUTINE FMEQ_FM1I

   SUBROUTINE FMEQ_FM1R(MA,R)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      INTEGER :: J,N
      REAL :: R
      INTENT (INOUT) :: MA
      INTENT (IN) :: R
      TYPE(MULTI), SAVE :: MTLVFM
      N = SIZE(MA)
      CALL FMSP2M(R,MTLVFM)
      DO J = 1, N
         CALL FMEQ(MTLVFM,MA(J)%MFM)
      ENDDO
   END SUBROUTINE FMEQ_FM1R

   SUBROUTINE FMEQ_FM1D(MA,D)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      INTEGER :: J,N
      DOUBLE PRECISION :: D
      INTENT (INOUT) :: MA
      INTENT (IN) :: D
      TYPE(MULTI), SAVE :: MTLVFM
      N = SIZE(MA)
      CALL FMDP2M(D,MTLVFM)
      DO J = 1, N
         CALL FMEQ(MTLVFM,MA(J)%MFM)
      ENDDO
   END SUBROUTINE FMEQ_FM1D

   SUBROUTINE FMEQ_FM1Z(MA,Z)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      INTEGER :: J,N
      COMPLEX :: Z
      INTENT (INOUT) :: MA
      INTENT (IN) :: Z
      TYPE(MULTI), SAVE :: MTLVFM
      N = SIZE(MA)
      CALL FMSP2M(REAL(Z),MTLVFM)
      DO J = 1, N
         CALL FMEQ(MTLVFM,MA(J)%MFM)
      ENDDO
   END SUBROUTINE FMEQ_FM1Z

   SUBROUTINE FMEQ_FM1C(MA,C)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      INTEGER :: J,N
      COMPLEX (KIND(0.0D0)) :: C
      INTENT (INOUT) :: MA
      INTENT (IN) :: C
      TYPE(MULTI), SAVE :: MTLVFM
      N = SIZE(MA)
      CALL FMDP2M(REAL(C,KIND(0.0D0)),MTLVFM)
      DO J = 1, N
         CALL FMEQ(MTLVFM,MA(J)%MFM)
      ENDDO
   END SUBROUTINE FMEQ_FM1C

   SUBROUTINE FMEQ_I1FM(IVAL,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA
      INTEGER, DIMENSION(:) :: IVAL
      INTEGER :: J,K,N
      INTENT (INOUT) :: IVAL
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      N = SIZE(IVAL)
      CALL FMM2I(MA%MFM,K)
      DO J = 1, N
         IVAL(J) = K
      ENDDO
   END SUBROUTINE FMEQ_I1FM

   SUBROUTINE FMEQ_R1FM(R,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA
      REAL, DIMENSION(:) :: R
      REAL :: R2
      INTEGER :: J,N
      INTENT (INOUT) :: R
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      N = SIZE(R)
      CALL FMM2SP(MA%MFM,R2)
      DO J = 1, N
         R(J) = R2
      ENDDO
   END SUBROUTINE FMEQ_R1FM

   SUBROUTINE FMEQ_D1FM(D,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA
      DOUBLE PRECISION, DIMENSION(:) :: D
      DOUBLE PRECISION :: D2
      INTEGER :: J,N
      INTENT (INOUT) :: D
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      N = SIZE(D)
      CALL FMM2DP(MA%MFM,D2)
      DO J = 1, N
         D(J) = D2
      ENDDO
   END SUBROUTINE FMEQ_D1FM

   SUBROUTINE FMEQ_Z1FM(Z,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA
      COMPLEX, DIMENSION(:) :: Z
      REAL :: R2
      INTEGER :: J,N
      INTENT (INOUT) :: Z
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      N = SIZE(Z)
      CALL FMM2SP(MA%MFM,R2)
      DO J = 1, N
         Z(J) = R2
      ENDDO
   END SUBROUTINE FMEQ_Z1FM

   SUBROUTINE FMEQ_C1FM(C,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA
      COMPLEX (KIND(0.0D0)), DIMENSION(:) :: C
      DOUBLE PRECISION :: D2
      INTEGER :: J,N
      INTENT (INOUT) :: C
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      N = SIZE(C)
      CALL FMM2DP(MA%MFM,D2)
      DO J = 1, N
         C(J) = D2
      ENDDO
   END SUBROUTINE FMEQ_C1FM

   SUBROUTINE FMEQ_FM1FM(MA,MB)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      TYPE (FM) :: MB
      INTEGER :: J,N
      INTENT (INOUT) :: MA
      INTENT (IN) :: MB
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MB)
      N = SIZE(MA)
      CALL FMEQ(MB%MFM,MTLVFM)
      DO J = 1, N
         CALL FMEQ(MTLVFM,MA(J)%MFM)
      ENDDO
   END SUBROUTINE FMEQ_FM1FM

   SUBROUTINE FMEQ_FM1IM(MA,MB)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      TYPE (IM) :: MB
      INTEGER :: J,N
      INTENT (INOUT) :: MA
      INTENT (IN) :: MB
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MB)
      N = SIZE(MA)
      CALL IMI2FM(MB%MIM,MTLVFM)
      DO J = 1, N
         CALL FMEQ(MTLVFM,MA(J)%MFM)
      ENDDO
   END SUBROUTINE FMEQ_FM1IM

   SUBROUTINE FMEQ_FM1ZM(MA,MB)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      TYPE (ZM) :: MB
      INTEGER :: J,N
      INTENT (INOUT) :: MA
      INTENT (IN) :: MB
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MB)
      N = SIZE(MA)
      CALL ZMREAL(MB%MZM,MTLVFM)
      DO J = 1, N
         CALL FMEQ(MTLVFM,MA(J)%MFM)
      ENDDO
   END SUBROUTINE FMEQ_FM1ZM

   SUBROUTINE FMEQ_IM1FM(MA,MB)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:) :: MA
      TYPE (FM) :: MB
      INTEGER :: J,N
      INTENT (INOUT) :: MA
      INTENT (IN) :: MB
      TYPE(MULTI), SAVE :: MTLVIM
      CALL FM_UNDEF_INP(MB)
      N = SIZE(MA)
      CALL IMFM2I(MB%MFM,MTLVIM)
      DO J = 1, N
         CALL IMEQ(MTLVIM,MA(J)%MIM)
      ENDDO
   END SUBROUTINE FMEQ_IM1FM

   SUBROUTINE FMEQ_ZM1FM(MA,MB)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      TYPE (FM) :: MB
      INTEGER :: J,N
      INTENT (INOUT) :: MA
      INTENT (IN) :: MB
      TYPE(MULTI), SAVE :: MTLVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MB)
      N = SIZE(MA)
      CALL FMI2M(0,MTLVFM)
      CALL ZMCMPX(MB%MFM,MTLVFM,MTLVZM)
      DO J = 1, N
         CALL ZMEQ(MTLVZM,MA(J)%MZM)
      ENDDO
   END SUBROUTINE FMEQ_ZM1FM

!             (2) rank 1  =  rank 1

   SUBROUTINE FMEQ_FM1I1(MA,IVAL)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      INTEGER, DIMENSION(:) :: IVAL
      INTEGER :: J,N
      INTENT (INOUT) :: MA
      INTENT (IN) :: IVAL
      TYPE(MULTI), SAVE :: MTLVFM
      IF (SIZE(MA) /= SIZE(IVAL)) THEN
          CALL FMST2M(' UNKNOWN ',MTLVFM)
          DO J = 1, SIZE(MA)
             CALL FMEQ(MTLVFM,MA(J)%MFM)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(MA)
      DO J = 1, N
         CALL FMI2M(IVAL(J),MA(J)%MFM)
      ENDDO
   END SUBROUTINE FMEQ_FM1I1

   SUBROUTINE FMEQ_FM1R1(MA,R)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      INTEGER :: J,N
      REAL, DIMENSION(:) :: R
      INTENT (INOUT) :: MA
      INTENT (IN) :: R
      TYPE(MULTI), SAVE :: MTLVFM
      IF (SIZE(MA) /= SIZE(R)) THEN
          CALL FMST2M(' UNKNOWN ',MTLVFM)
          DO J = 1, SIZE(MA)
             CALL FMEQ(MTLVFM,MA(J)%MFM)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(MA)
      DO J = 1, N
         CALL FMSP2M(R(J),MA(J)%MFM)
      ENDDO
   END SUBROUTINE FMEQ_FM1R1

   SUBROUTINE FMEQ_FM1D1(MA,D)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      INTEGER :: J,N
      DOUBLE PRECISION, DIMENSION(:) :: D
      INTENT (INOUT) :: MA
      INTENT (IN) :: D
      TYPE(MULTI), SAVE :: MTLVFM
      IF (SIZE(MA) /= SIZE(D)) THEN
          CALL FMST2M(' UNKNOWN ',MTLVFM)
          DO J = 1, SIZE(MA)
             CALL FMEQ(MTLVFM,MA(J)%MFM)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(MA)
      DO J = 1, N
         CALL FMDP2M(D(J),MA(J)%MFM)
      ENDDO
   END SUBROUTINE FMEQ_FM1D1

   SUBROUTINE FMEQ_FM1Z1(MA,Z)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      INTEGER :: J,N
      COMPLEX, DIMENSION(:) :: Z
      INTENT (INOUT) :: MA
      INTENT (IN) :: Z
      TYPE(MULTI), SAVE :: MTLVFM
      IF (SIZE(MA) /= SIZE(Z)) THEN
          CALL FMST2M(' UNKNOWN ',MTLVFM)
          DO J = 1, SIZE(MA)
             CALL FMEQ(MTLVFM,MA(J)%MFM)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(MA)
      DO J = 1, N
         CALL FMSP2M(REAL(Z(J)),MA(J)%MFM)
      ENDDO
   END SUBROUTINE FMEQ_FM1Z1

   SUBROUTINE FMEQ_FM1C1(MA,C)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      INTEGER :: J,N
      COMPLEX (KIND(0.0D0)), DIMENSION(:) :: C
      INTENT (INOUT) :: MA
      INTENT (IN) :: C
      TYPE(MULTI), SAVE :: MTLVFM
      IF (SIZE(MA) /= SIZE(C)) THEN
          CALL FMST2M(' UNKNOWN ',MTLVFM)
          DO J = 1, SIZE(MA)
             CALL FMEQ(MTLVFM,MA(J)%MFM)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(MA)
      DO J = 1, N
         CALL FMDP2M(REAL(C(J),KIND(0.0D0)),MA(J)%MFM)
      ENDDO
   END SUBROUTINE FMEQ_FM1C1

   SUBROUTINE FMEQ_I1FM1(IVAL,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      INTEGER, DIMENSION(:) :: IVAL
      INTEGER :: J,N
      INTENT (INOUT) :: IVAL
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA) /= SIZE(IVAL)) THEN
          DO J = 1, SIZE(IVAL)
             IVAL(J) = IUNKNO
          ENDDO
          RETURN
      ENDIF
      N = SIZE(IVAL)
      DO J = 1, N
         CALL FMM2I(MA(J)%MFM,IVAL(J))
      ENDDO
   END SUBROUTINE FMEQ_I1FM1

   SUBROUTINE FMEQ_R1FM1(R,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      REAL, DIMENSION(:) :: R
      INTEGER :: J,N
      INTENT (INOUT) :: R
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA) /= SIZE(R)) THEN
          DO J = 1, SIZE(R)
             R(J) = RUNKNO
          ENDDO
          RETURN
      ENDIF
      N = SIZE(R)
      DO J = 1, N
         CALL FMM2SP(MA(J)%MFM,R(J))
      ENDDO
   END SUBROUTINE FMEQ_R1FM1

   SUBROUTINE FMEQ_D1FM1(D,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      DOUBLE PRECISION, DIMENSION(:) :: D
      INTEGER :: J,N
      INTENT (INOUT) :: D
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA) /= SIZE(D)) THEN
          DO J = 1, SIZE(D)
             D(J) = RUNKNO
          ENDDO
          RETURN
      ENDIF
      N = SIZE(D)
      DO J = 1, N
         CALL FMM2DP(MA(J)%MFM,D(J))
      ENDDO
   END SUBROUTINE FMEQ_D1FM1

   SUBROUTINE FMEQ_Z1FM1(Z,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      COMPLEX, DIMENSION(:) :: Z
      REAL :: R
      INTEGER :: J,N
      INTENT (INOUT) :: Z
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA) /= SIZE(Z)) THEN
          DO J = 1, SIZE(Z)
             Z(J) = CMPLX(RUNKNO,RUNKNO)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(Z)
      DO J = 1, N
         CALL FMM2SP(MA(J)%MFM,R)
         Z(J) = CMPLX(R,0.0)
      ENDDO
   END SUBROUTINE FMEQ_Z1FM1

   SUBROUTINE FMEQ_C1FM1(C,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      COMPLEX (KIND(0.0D0)), DIMENSION(:) :: C
      REAL (KIND(0.0D0)) :: D
      INTEGER :: J,N
      INTENT (INOUT) :: C
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA) /= SIZE(C)) THEN
          DO J = 1, SIZE(C)
             D = RUNKNO
             C(J) = CMPLX(D,D , KIND(0.0D0))
          ENDDO
          RETURN
      ENDIF
      N = SIZE(C)
      DO J = 1, N
         CALL FMM2DP(MA(J)%MFM,D)
         C(J) = CMPLX(D,0.0D0 , KIND(0.0D0))
      ENDDO
   END SUBROUTINE FMEQ_C1FM1

   SUBROUTINE FMEQ_FM1FM1(MA,MB)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      TYPE (FM), DIMENSION(:) :: MB
      TYPE (FM), ALLOCATABLE, DIMENSION(:) :: TEMP
      INTEGER :: J,N
      INTENT (INOUT) :: MA
      INTENT (IN) :: MB
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MB)
      IF (SIZE(MA) /= SIZE(MB)) THEN
          CALL FMST2M(' UNKNOWN ',MTLVFM)
          DO J = 1, SIZE(MA)
             CALL FMEQ(MTLVFM,MA(J)%MFM)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(MA)

!             To avoid problems when lhs and rhs are overlapping parts of the same array, move MB
!             to a temporary array before re-defining any of MA.

      ALLOCATE(TEMP(N))
      DO J = 1, N
         CALL FMEQ(MB(J)%MFM,TEMP(J)%MFM)
      ENDDO
      DO J = 1, N
         CALL FMEQ(TEMP(J)%MFM,MA(J)%MFM)
      ENDDO
      DEALLOCATE(TEMP)
   END SUBROUTINE FMEQ_FM1FM1

   SUBROUTINE FMEQ_FM1IM1(MA,MB)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      TYPE (IM), DIMENSION(:) :: MB
      INTEGER :: J,N
      INTENT (INOUT) :: MA
      INTENT (IN) :: MB
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MB)
      IF (SIZE(MA) /= SIZE(MB)) THEN
          CALL FMST2M(' UNKNOWN ',MTLVFM)
          DO J = 1, SIZE(MA)
             CALL FMEQ(MTLVFM,MA(J)%MFM)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(MA)
      DO J = 1, N
         CALL IMI2FM(MB(J)%MIM,MA(J)%MFM)
      ENDDO
   END SUBROUTINE FMEQ_FM1IM1

   SUBROUTINE FMEQ_FM1ZM1(MA,MB)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      TYPE (ZM), DIMENSION(:) :: MB
      INTEGER :: J,N
      INTENT (INOUT) :: MA
      INTENT (IN) :: MB
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MB)
      IF (SIZE(MA) /= SIZE(MB)) THEN
          CALL FMST2M(' UNKNOWN ',MTLVFM)
          DO J = 1, SIZE(MA)
             CALL FMEQ(MTLVFM,MA(J)%MFM)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(MA)
      DO J = 1, N
         CALL ZMREAL(MB(J)%MZM,MA(J)%MFM)
      ENDDO
   END SUBROUTINE FMEQ_FM1ZM1

   SUBROUTINE FMEQ_IM1FM1(MA,MB)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:) :: MA
      TYPE (FM), DIMENSION(:) :: MB
      INTEGER :: J,N
      INTENT (INOUT) :: MA
      INTENT (IN) :: MB
      TYPE(MULTI), SAVE :: MTLVIM
      CALL FM_UNDEF_INP(MB)
      IF (SIZE(MA) /= SIZE(MB)) THEN
          CALL IMST2M(' UNKNOWN ',MTLVIM)
          DO J = 1, SIZE(MA)
             CALL IMEQ(MTLVIM,MA(J)%MIM)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(MA)
      DO J = 1, N
         CALL IMFM2I(MB(J)%MFM,MA(J)%MIM)
      ENDDO
   END SUBROUTINE FMEQ_IM1FM1

   SUBROUTINE FMEQ_ZM1FM1(MA,MB)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      TYPE (FM), DIMENSION(:) :: MB
      INTEGER :: J,N
      INTENT (INOUT) :: MA
      INTENT (IN) :: MB
      TYPE(MULTI), SAVE :: MTLVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MB)
      IF (SIZE(MA) /= SIZE(MB)) THEN
          CALL ZMST2M(' UNKNOWN + UNKNOWN i ',MTLVZM)
          DO J = 1, SIZE(MA)
             CALL ZMEQ(MTLVZM,MA(J)%MZM)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(MA)
      CALL FMI2M(0,MTLVFM)
      DO J = 1, N
         CALL ZMCMPX(MB(J)%MFM,MTLVFM,MA(J)%MZM)
      ENDDO
   END SUBROUTINE FMEQ_ZM1FM1

!             (3) rank 2  =  rank 0

   SUBROUTINE FMEQ_FM2I(MA,IVAL)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      INTEGER :: IVAL,J,K
      INTENT (INOUT) :: MA
      INTENT (IN) :: IVAL
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FMI2M(IVAL,MTLVFM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMEQ(MTLVFM,MA(J,K)%MFM)
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_FM2I

   SUBROUTINE FMEQ_FM2R(MA,R)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      INTEGER :: J,K
      REAL :: R
      INTENT (INOUT) :: MA
      INTENT (IN) :: R
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FMSP2M(R,MTLVFM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMEQ(MTLVFM,MA(J,K)%MFM)
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_FM2R

   SUBROUTINE FMEQ_FM2D(MA,D)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      INTEGER :: J,K
      DOUBLE PRECISION :: D
      INTENT (INOUT) :: MA
      INTENT (IN) :: D
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FMDP2M(D,MTLVFM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMEQ(MTLVFM,MA(J,K)%MFM)
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_FM2D

   SUBROUTINE FMEQ_FM2Z(MA,Z)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      INTEGER :: J,K
      COMPLEX :: Z
      INTENT (INOUT) :: MA
      INTENT (IN) :: Z
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FMSP2M(REAL(Z),MTLVFM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMEQ(MTLVFM,MA(J,K)%MFM)
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_FM2Z

   SUBROUTINE FMEQ_FM2C(MA,C)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      INTEGER :: J,K
      COMPLEX (KIND(0.0D0)) :: C
      INTENT (INOUT) :: MA
      INTENT (IN) :: C
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FMDP2M(REAL(C,KIND(0.0D0)),MTLVFM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMEQ(MTLVFM,MA(J,K)%MFM)
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_FM2C

   SUBROUTINE FMEQ_I2FM(IVAL,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA
      INTEGER, DIMENSION(:,:) :: IVAL
      INTEGER :: J,K,L
      INTENT (INOUT) :: IVAL
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL FMM2I(MA%MFM,L)
      DO J = 1, SIZE(IVAL,DIM=1)
         DO K = 1, SIZE(IVAL,DIM=2)
            IVAL(J,K) = L
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_I2FM

   SUBROUTINE FMEQ_R2FM(R,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA
      REAL, DIMENSION(:,:) :: R
      REAL :: R2
      INTEGER :: J,K
      INTENT (INOUT) :: R
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL FMM2SP(MA%MFM,R2)
      DO J = 1, SIZE(R,DIM=1)
         DO K = 1, SIZE(R,DIM=2)
            R(J,K) = R2
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_R2FM

   SUBROUTINE FMEQ_D2FM(D,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA
      DOUBLE PRECISION, DIMENSION(:,:) :: D
      DOUBLE PRECISION :: D2
      INTEGER :: J,K
      INTENT (INOUT) :: D
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL FMM2DP(MA%MFM,D2)
      DO J = 1, SIZE(D,DIM=1)
         DO K = 1, SIZE(D,DIM=2)
            D(J,K) = D2
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_D2FM

   SUBROUTINE FMEQ_Z2FM(Z,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA
      COMPLEX, DIMENSION(:,:) :: Z
      REAL :: R2
      INTEGER :: J,K
      INTENT (INOUT) :: Z
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL FMM2SP(MA%MFM,R2)
      DO J = 1, SIZE(Z,DIM=1)
         DO K = 1, SIZE(Z,DIM=2)
            Z(J,K) = R2
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_Z2FM

   SUBROUTINE FMEQ_C2FM(C,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA
      COMPLEX (KIND(0.0D0)), DIMENSION(:,:) :: C
      DOUBLE PRECISION :: D2
      INTEGER :: J,K
      INTENT (INOUT) :: C
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL FMM2DP(MA%MFM,D2)
      DO J = 1, SIZE(C,DIM=1)
         DO K = 1, SIZE(C,DIM=2)
            C(J,K) = D2
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_C2FM

   SUBROUTINE FMEQ_FM2FM(MA,MB)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      TYPE (FM) :: MB
      INTEGER :: J,K
      INTENT (INOUT) :: MA
      INTENT (IN) :: MB
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MB)
      CALL FMEQ(MB%MFM,MTLVFM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMEQ(MTLVFM,MA(J,K)%MFM)
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_FM2FM

   SUBROUTINE FMEQ_FM2IM(MA,MB)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      TYPE (IM) :: MB
      INTEGER :: J,K
      INTENT (INOUT) :: MA
      INTENT (IN) :: MB
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MB)
      CALL IMI2FM(MB%MIM,MTLVFM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMEQ(MTLVFM,MA(J,K)%MFM)
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_FM2IM

   SUBROUTINE FMEQ_FM2ZM(MA,MB)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      TYPE (ZM) :: MB
      INTEGER :: J,K
      INTENT (INOUT) :: MA
      INTENT (IN) :: MB
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MB)
      CALL ZMREAL(MB%MZM,MTLVFM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMEQ(MTLVFM,MA(J,K)%MFM)
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_FM2ZM

   SUBROUTINE FMEQ_IM2FM(MA,MB)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:,:) :: MA
      TYPE (FM) :: MB
      INTEGER :: J,K
      INTENT (INOUT) :: MA
      INTENT (IN) :: MB
      TYPE(MULTI), SAVE :: MTLVIM
      CALL FM_UNDEF_INP(MB)
      CALL IMFM2I(MB%MFM,MTLVIM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL IMEQ(MTLVIM,MA(J,K)%MIM)
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_IM2FM

   SUBROUTINE FMEQ_ZM2FM(MA,MB)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      TYPE (FM) :: MB
      INTEGER :: J,K
      INTENT (INOUT) :: MA
      INTENT (IN) :: MB
      TYPE(MULTI), SAVE :: MTLVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MB)
      CALL FMI2M(0,MTLVFM)
      CALL ZMCMPX(MB%MFM,MTLVFM,MTLVZM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMEQ(MTLVZM,MA(J,K)%MZM)
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_ZM2FM

!             (4) rank 2  =  rank 2

   SUBROUTINE FMEQ_FM2I2(MA,IVAL)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      INTEGER, DIMENSION(:,:) :: IVAL
      INTEGER :: J,K
      INTENT (INOUT) :: MA
      INTENT (IN) :: IVAL
      TYPE(MULTI), SAVE :: MTLVFM
      IF (SIZE(MA,DIM=1) /= SIZE(IVAL,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(IVAL,DIM=2)) THEN
          CALL FMST2M(' UNKNOWN ',MTLVFM)
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                CALL FMEQ(MTLVFM,MA(J,K)%MFM)
             ENDDO
          ENDDO
          RETURN
      ENDIF
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMI2M(IVAL(J,K),MA(J,K)%MFM)
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_FM2I2

   SUBROUTINE FMEQ_FM2R2(MA,R)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      INTEGER :: J,K
      REAL, DIMENSION(:,:) :: R
      INTENT (INOUT) :: MA
      INTENT (IN) :: R
      TYPE(MULTI), SAVE :: MTLVFM
      IF (SIZE(MA,DIM=1) /= SIZE(R,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(R,DIM=2)) THEN
          CALL FMST2M(' UNKNOWN ',MTLVFM)
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                CALL FMEQ(MTLVFM,MA(J,K)%MFM)
             ENDDO
          ENDDO
          RETURN
      ENDIF
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMSP2M(R(J,K),MA(J,K)%MFM)
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_FM2R2

   SUBROUTINE FMEQ_FM2D2(MA,D)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      INTEGER :: J,K
      DOUBLE PRECISION, DIMENSION(:,:) :: D
      INTENT (INOUT) :: MA
      INTENT (IN) :: D
      TYPE(MULTI), SAVE :: MTLVFM
      IF (SIZE(MA,DIM=1) /= SIZE(D,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(D,DIM=2)) THEN
          CALL FMST2M(' UNKNOWN ',MTLVFM)
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                CALL FMEQ(MTLVFM,MA(J,K)%MFM)
             ENDDO
          ENDDO
          RETURN
      ENDIF
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMDP2M(D(J,K),MA(J,K)%MFM)
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_FM2D2

   SUBROUTINE FMEQ_FM2Z2(MA,Z)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      INTEGER :: J,K
      COMPLEX, DIMENSION(:,:) :: Z
      INTENT (INOUT) :: MA
      INTENT (IN) :: Z
      TYPE(MULTI), SAVE :: MTLVFM
      IF (SIZE(MA,DIM=1) /= SIZE(Z,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(Z,DIM=2)) THEN
          CALL FMST2M(' UNKNOWN ',MTLVFM)
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                CALL FMEQ(MTLVFM,MA(J,K)%MFM)
             ENDDO
          ENDDO
          RETURN
      ENDIF
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMSP2M(REAL(Z(J,K)),MA(J,K)%MFM)
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_FM2Z2

   SUBROUTINE FMEQ_FM2C2(MA,C)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      INTEGER :: J,K
      COMPLEX (KIND(0.0D0)), DIMENSION(:,:) :: C
      INTENT (INOUT) :: MA
      INTENT (IN) :: C
      TYPE(MULTI), SAVE :: MTLVFM
      IF (SIZE(MA,DIM=1) /= SIZE(C,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(C,DIM=2)) THEN
          CALL FMST2M(' UNKNOWN ',MTLVFM)
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                CALL FMEQ(MTLVFM,MA(J,K)%MFM)
             ENDDO
          ENDDO
          RETURN
      ENDIF
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMDP2M(REAL(C(J,K),KIND(0.0D0)),MA(J,K)%MFM)
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_FM2C2

   SUBROUTINE FMEQ_I2FM2(IVAL,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      INTEGER, DIMENSION(:,:) :: IVAL
      INTEGER :: J,K
      INTENT (INOUT) :: IVAL
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA,DIM=1) /= SIZE(IVAL,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(IVAL,DIM=2)) THEN
          DO J = 1, SIZE(IVAL,DIM=1)
             DO K = 1, SIZE(IVAL,DIM=2)
                IVAL(J,K) = IUNKNO
             ENDDO
          ENDDO
          RETURN
      ENDIF
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMM2I(MA(J,K)%MFM,IVAL(J,K))
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_I2FM2

   SUBROUTINE FMEQ_R2FM2(R,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      REAL, DIMENSION(:,:) :: R
      INTEGER :: J,K
      INTENT (INOUT) :: R
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA,DIM=1) /= SIZE(R,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(R,DIM=2)) THEN
          DO J = 1, SIZE(R,DIM=1)
             DO K = 1, SIZE(R,DIM=2)
                R(J,K) = RUNKNO
             ENDDO
          ENDDO
          RETURN
      ENDIF
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMM2SP(MA(J,K)%MFM,R(J,K))
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_R2FM2

   SUBROUTINE FMEQ_D2FM2(D,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      DOUBLE PRECISION, DIMENSION(:,:) :: D
      INTEGER :: J,K
      INTENT (INOUT) :: D
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA,DIM=1) /= SIZE(D,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(D,DIM=2)) THEN
          DO J = 1, SIZE(D,DIM=1)
             DO K = 1, SIZE(D,DIM=2)
                D(J,K) = RUNKNO
             ENDDO
          ENDDO
          RETURN
      ENDIF
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMM2DP(MA(J,K)%MFM,D(J,K))
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_D2FM2

   SUBROUTINE FMEQ_Z2FM2(Z,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      COMPLEX, DIMENSION(:,:) :: Z
      REAL :: R
      INTEGER :: J,K
      INTENT (INOUT) :: Z
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA,DIM=1) /= SIZE(Z,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(Z,DIM=2)) THEN
          DO J = 1, SIZE(Z,DIM=1)
             DO K = 1, SIZE(Z,DIM=2)
                Z(J,K) = CMPLX(RUNKNO,RUNKNO)
             ENDDO
          ENDDO
          RETURN
      ENDIF
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMM2SP(MA(J,K)%MFM,R)
            Z(J,K) = CMPLX(R,0.0)
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_Z2FM2

   SUBROUTINE FMEQ_C2FM2(C,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      COMPLEX (KIND(0.0D0)), DIMENSION(:,:) :: C
      REAL (KIND(0.0D0)) :: D
      INTEGER :: J,K
      INTENT (INOUT) :: C
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA,DIM=1) /= SIZE(C,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(C,DIM=2)) THEN
          DO J = 1, SIZE(C,DIM=1)
             DO K = 1, SIZE(C,DIM=2)
                D = RUNKNO
                C(J,K) = CMPLX(D,D , KIND(0.0D0))
             ENDDO
          ENDDO
          RETURN
      ENDIF
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMM2DP(MA(J,K)%MFM,D)
            C(J,K) = CMPLX(D,0.0D0 , KIND(0.0D0))
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_C2FM2

   SUBROUTINE FMEQ_FM2FM2(MA,MB)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      TYPE (FM), DIMENSION(:,:) :: MB
      TYPE (FM), ALLOCATABLE, DIMENSION(:,:) :: TEMP
      INTEGER :: J,K
      INTENT (INOUT) :: MA
      INTENT (IN) :: MB
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MB)
      IF (SIZE(MA,DIM=1) /= SIZE(MB,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(MB,DIM=2)) THEN
          CALL FMST2M(' UNKNOWN ',MTLVFM)
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                CALL FMEQ(MTLVFM,MA(J,K)%MFM)
             ENDDO
          ENDDO
          RETURN
      ENDIF

!             To avoid problems when lhs and rhs are overlapping parts of the same array, move MB
!             to a temporary array before re-defining any of MA.

      ALLOCATE(TEMP(SIZE(MA,DIM=1),SIZE(MA,DIM=2)))
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMEQ(MB(J,K)%MFM,TEMP(J,K)%MFM)
         ENDDO
      ENDDO
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMEQ(TEMP(J,K)%MFM,MA(J,K)%MFM)
         ENDDO
      ENDDO
      DEALLOCATE(TEMP)
   END SUBROUTINE FMEQ_FM2FM2

   SUBROUTINE FMEQ_FM2IM2(MA,MB)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      TYPE (IM), DIMENSION(:,:) :: MB
      INTEGER :: J,K
      INTENT (INOUT) :: MA
      INTENT (IN) :: MB
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MB)
      IF (SIZE(MA,DIM=1) /= SIZE(MB,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(MB,DIM=2)) THEN
          CALL FMST2M(' UNKNOWN ',MTLVFM)
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                CALL FMEQ(MTLVFM,MA(J,K)%MFM)
             ENDDO
          ENDDO
          RETURN
      ENDIF
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL IMI2FM(MB(J,K)%MIM,MA(J,K)%MFM)
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_FM2IM2

   SUBROUTINE FMEQ_FM2ZM2(MA,MB)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      TYPE (ZM), DIMENSION(:,:) :: MB
      INTEGER :: J,K
      INTENT (INOUT) :: MA
      INTENT (IN) :: MB
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MB)
      IF (SIZE(MA,DIM=1) /= SIZE(MB,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(MB,DIM=2)) THEN
          CALL FMST2M(' UNKNOWN ',MTLVFM)
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                CALL FMEQ(MTLVFM,MA(J,K)%MFM)
             ENDDO
          ENDDO
          RETURN
      ENDIF
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMREAL(MB(J,K)%MZM,MA(J,K)%MFM)
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_FM2ZM2

   SUBROUTINE FMEQ_IM2FM2(MA,MB)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:,:) :: MA
      TYPE (FM), DIMENSION(:,:) :: MB
      INTEGER :: J,K
      INTENT (INOUT) :: MA
      INTENT (IN) :: MB
      TYPE(MULTI), SAVE :: MTLVIM
      CALL FM_UNDEF_INP(MB)
      IF (SIZE(MA,DIM=1) /= SIZE(MB,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(MB,DIM=2)) THEN
          CALL IMST2M(' UNKNOWN ',MTLVIM)
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                CALL IMEQ(MTLVIM,MA(J,K)%MIM)
             ENDDO
          ENDDO
          RETURN
      ENDIF
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL IMFM2I(MB(J,K)%MFM,MA(J,K)%MIM)
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_IM2FM2

   SUBROUTINE FMEQ_ZM2FM2(MA,MB)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      TYPE (FM), DIMENSION(:,:) :: MB
      INTEGER :: J,K
      INTENT (INOUT) :: MA
      INTENT (IN) :: MB
      TYPE(MULTI), SAVE :: MTLVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MB)
      IF (SIZE(MA,DIM=1) /= SIZE(MB,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(MB,DIM=2)) THEN
          CALL ZMST2M(' UNKNOWN + UNKNOWN i ',MTLVZM)
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                CALL ZMEQ(MTLVZM,MA(J,K)%MZM)
             ENDDO
          ENDDO
          RETURN
      ENDIF
      CALL FMI2M(0,MTLVFM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMCMPX(MB(J,K)%MFM,MTLVFM,MA(J,K)%MZM)
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_ZM2FM2

!             Array equal assignments for IM.

!             (1) rank 1  =  rank 0

   SUBROUTINE FMEQ_IM1I(MA,IVAL)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:) :: MA
      INTEGER :: IVAL,J,N
      INTENT (INOUT) :: MA
      INTENT (IN) :: IVAL
      TYPE(MULTI), SAVE :: MTLVIM
      N = SIZE(MA)
      CALL IMI2M(IVAL,MTLVIM)
      DO J = 1, N
         CALL IMEQ(MTLVIM,MA(J)%MIM)
      ENDDO
   END SUBROUTINE FMEQ_IM1I

   SUBROUTINE FMEQ_IM1R(MA,R)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:) :: MA
      INTEGER :: J,N
      REAL :: R
      INTENT (INOUT) :: MA
      INTENT (IN) :: R
      TYPE(MULTI), SAVE :: MTLVFM,MTLVIM
      N = SIZE(MA)
      CALL FMSP2M(R,MTLVFM)
      CALL IMFM2I(MTLVFM,MTLVIM)
      DO J = 1, N
         CALL IMEQ(MTLVIM,MA(J)%MIM)
      ENDDO
   END SUBROUTINE FMEQ_IM1R

   SUBROUTINE FMEQ_IM1D(MA,D)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:) :: MA
      INTEGER :: J,N
      DOUBLE PRECISION :: D
      INTENT (INOUT) :: MA
      INTENT (IN) :: D
      TYPE(MULTI), SAVE :: MTLVFM,MTLVIM
      N = SIZE(MA)
      CALL FMDP2M(D,MTLVFM)
      CALL IMFM2I(MTLVFM,MTLVIM)
      DO J = 1, N
         CALL IMEQ(MTLVIM,MA(J)%MIM)
      ENDDO
   END SUBROUTINE FMEQ_IM1D

   SUBROUTINE FMEQ_IM1Z(MA,Z)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:) :: MA
      INTEGER :: J,N
      COMPLEX :: Z
      INTENT (INOUT) :: MA
      INTENT (IN) :: Z
      TYPE(MULTI), SAVE :: MTLVFM,MTLVIM
      N = SIZE(MA)
      CALL FMSP2M(REAL(Z),MTLVFM)
      CALL IMFM2I(MTLVFM,MTLVIM)
      DO J = 1, N
         CALL IMEQ(MTLVIM,MA(J)%MIM)
      ENDDO
   END SUBROUTINE FMEQ_IM1Z

   SUBROUTINE FMEQ_IM1C(MA,C)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:) :: MA
      INTEGER :: J,N
      COMPLEX (KIND(0.0D0)) :: C
      INTENT (INOUT) :: MA
      INTENT (IN) :: C
      TYPE(MULTI), SAVE :: MTLVFM,MTLVIM
      N = SIZE(MA)
      CALL FMDP2M(REAL(C,KIND(0.0D0)),MTLVFM)
      CALL IMFM2I(MTLVFM,MTLVIM)
      DO J = 1, N
         CALL IMEQ(MTLVIM,MA(J)%MIM)
      ENDDO
   END SUBROUTINE FMEQ_IM1C

   SUBROUTINE FMEQ_I1IM(IVAL,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA
      INTEGER, DIMENSION(:) :: IVAL
      INTEGER :: J,K,N
      INTENT (INOUT) :: IVAL
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      N = SIZE(IVAL)
      CALL IMM2I(MA%MIM,K)
      DO J = 1, N
         IVAL(J) = K
      ENDDO
   END SUBROUTINE FMEQ_I1IM

   SUBROUTINE FMEQ_R1IM(R,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA
      REAL, DIMENSION(:) :: R
      REAL :: R2
      INTEGER :: J,N
      INTENT (INOUT) :: R
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      N = SIZE(R)
      CALL IMI2FM(MA%MIM,MTLVFM)
      CALL FMM2SP(MTLVFM,R2)
      DO J = 1, N
         R(J) = R2
      ENDDO
   END SUBROUTINE FMEQ_R1IM

   SUBROUTINE FMEQ_D1IM(D,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA
      DOUBLE PRECISION, DIMENSION(:) :: D
      DOUBLE PRECISION :: D2
      INTEGER :: J,N
      INTENT (INOUT) :: D
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      N = SIZE(D)
      CALL IMI2FM(MA%MIM,MTLVFM)
      CALL FMM2DP(MTLVFM,D2)
      DO J = 1, N
         D(J) = D2
      ENDDO
   END SUBROUTINE FMEQ_D1IM

   SUBROUTINE FMEQ_Z1IM(Z,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA
      COMPLEX, DIMENSION(:) :: Z
      REAL :: R2
      INTEGER :: J,N
      INTENT (INOUT) :: Z
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      N = SIZE(Z)
      CALL IMI2FM(MA%MIM,MTLVFM)
      CALL FMM2SP(MTLVFM,R2)
      DO J = 1, N
         Z(J) = R2
      ENDDO
   END SUBROUTINE FMEQ_Z1IM

   SUBROUTINE FMEQ_C1IM(C,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA
      COMPLEX (KIND(0.0D0)), DIMENSION(:) :: C
      DOUBLE PRECISION :: D2
      INTEGER :: J,N
      INTENT (INOUT) :: C
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      N = SIZE(C)
      CALL IMI2FM(MA%MIM,MTLVFM)
      CALL FMM2DP(MTLVFM,D2)
      DO J = 1, N
         C(J) = D2
      ENDDO
   END SUBROUTINE FMEQ_C1IM

   SUBROUTINE FMEQ_IM1IM(MA,MB)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:) :: MA
      TYPE (IM) :: MB
      INTEGER :: J,N
      INTENT (INOUT) :: MA
      INTENT (IN) :: MB
      TYPE(MULTI), SAVE :: MTLVIM
      CALL FM_UNDEF_INP(MB)
      N = SIZE(MA)
      CALL IMEQ(MB%MIM,MTLVIM)
      DO J = 1, N
         CALL IMEQ(MTLVIM,MA(J)%MIM)
      ENDDO
   END SUBROUTINE FMEQ_IM1IM

   SUBROUTINE FMEQ_IM1ZM(MA,MB)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:) :: MA
      TYPE (ZM) :: MB
      INTEGER :: J,N
      INTENT (INOUT) :: MA
      INTENT (IN) :: MB
      TYPE(MULTI), SAVE :: MTLVFM,MTLVIM
      CALL FM_UNDEF_INP(MB)
      N = SIZE(MA)
      CALL ZMREAL(MB%MZM,MTLVFM)
      CALL IMFM2I(MTLVFM,MTLVIM)
      DO J = 1, N
         CALL IMEQ(MTLVIM,MA(J)%MIM)
      ENDDO
   END SUBROUTINE FMEQ_IM1ZM

   SUBROUTINE FMEQ_ZM1IM(MA,MB)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      TYPE (IM) :: MB
      INTEGER :: J,N
      INTENT (INOUT) :: MA
      INTENT (IN) :: MB
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MB)
      N = SIZE(MA)
      CALL IMI2FM(MB%MIM,MULVFM)
      CALL FMI2M(0,MTLVFM)
      CALL ZMCMPX(MULVFM,MTLVFM,MTLVZM)
      DO J = 1, N
         CALL ZMEQ(MTLVZM,MA(J)%MZM)
      ENDDO
   END SUBROUTINE FMEQ_ZM1IM

!             (2) rank 1  =  rank 1

   SUBROUTINE FMEQ_IM1I1(MA,IVAL)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:) :: MA
      INTEGER, DIMENSION(:) :: IVAL
      INTEGER :: J,N
      INTENT (INOUT) :: MA
      INTENT (IN) :: IVAL
      TYPE(MULTI), SAVE :: MTLVIM
      IF (SIZE(MA) /= SIZE(IVAL)) THEN
          CALL IMST2M(' UNKNOWN ',MTLVIM)
          DO J = 1, SIZE(MA)
             CALL IMEQ(MTLVIM,MA(J)%MIM)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(MA)
      DO J = 1, N
         CALL IMI2M(IVAL(J),MA(J)%MIM)
      ENDDO
   END SUBROUTINE FMEQ_IM1I1

   SUBROUTINE FMEQ_IM1R1(MA,R)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:) :: MA
      INTEGER :: J,N
      REAL, DIMENSION(:) :: R
      INTENT (INOUT) :: MA
      INTENT (IN) :: R
      TYPE(MULTI), SAVE :: MTLVFM,MTLVIM
      IF (SIZE(MA) /= SIZE(R)) THEN
          CALL IMST2M(' UNKNOWN ',MTLVIM)
          DO J = 1, SIZE(MA)
             CALL IMEQ(MTLVIM,MA(J)%MIM)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(MA)
      DO J = 1, N
         CALL FMSP2M(R(J),MTLVFM)
         CALL IMFM2I(MTLVFM,MA(J)%MIM)
      ENDDO
   END SUBROUTINE FMEQ_IM1R1

   SUBROUTINE FMEQ_IM1D1(MA,D)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:) :: MA
      INTEGER :: J,N
      DOUBLE PRECISION, DIMENSION(:) :: D
      INTENT (INOUT) :: MA
      INTENT (IN) :: D
      TYPE(MULTI), SAVE :: MTLVFM,MTLVIM
      IF (SIZE(MA) /= SIZE(D)) THEN
          CALL IMST2M(' UNKNOWN ',MTLVIM)
          DO J = 1, SIZE(MA)
             CALL IMEQ(MTLVIM,MA(J)%MIM)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(MA)
      DO J = 1, N
         CALL FMDP2M(D(J),MTLVFM)
         CALL IMFM2I(MTLVFM,MA(J)%MIM)
      ENDDO
   END SUBROUTINE FMEQ_IM1D1

   SUBROUTINE FMEQ_IM1Z1(MA,Z)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:) :: MA
      INTEGER :: J,N
      COMPLEX, DIMENSION(:) :: Z
      INTENT (INOUT) :: MA
      INTENT (IN) :: Z
      TYPE(MULTI), SAVE :: MTLVFM,MTLVIM
      IF (SIZE(MA) /= SIZE(Z)) THEN
          CALL IMST2M(' UNKNOWN ',MTLVIM)
          DO J = 1, SIZE(MA)
             CALL IMEQ(MTLVIM,MA(J)%MIM)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(MA)
      DO J = 1, N
         CALL FMSP2M(REAL(Z(J)),MTLVFM)
         CALL IMFM2I(MTLVFM,MA(J)%MIM)
      ENDDO
   END SUBROUTINE FMEQ_IM1Z1

   SUBROUTINE FMEQ_IM1C1(MA,C)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:) :: MA
      INTEGER :: J,N
      COMPLEX (KIND(0.0D0)), DIMENSION(:) :: C
      INTENT (INOUT) :: MA
      INTENT (IN) :: C
      TYPE(MULTI), SAVE :: MTLVFM,MTLVIM
      IF (SIZE(MA) /= SIZE(C)) THEN
          CALL IMST2M(' UNKNOWN ',MTLVIM)
          DO J = 1, SIZE(MA)
             CALL IMEQ(MTLVIM,MA(J)%MIM)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(MA)
      DO J = 1, N
         CALL FMDP2M(REAL(C(J),KIND(0.0D0)),MTLVFM)
         CALL IMFM2I(MTLVFM,MA(J)%MIM)
      ENDDO
   END SUBROUTINE FMEQ_IM1C1

   SUBROUTINE FMEQ_I1IM1(IVAL,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:) :: MA
      INTEGER, DIMENSION(:) :: IVAL
      INTEGER :: J,N
      INTENT (INOUT) :: IVAL
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA) /= SIZE(IVAL)) THEN
          DO J = 1, SIZE(MA)
             IVAL(J) = IUNKNO
          ENDDO
          RETURN
      ENDIF
      N = SIZE(IVAL)
      DO J = 1, N
         CALL IMM2I(MA(J)%MIM,IVAL(J))
      ENDDO
   END SUBROUTINE FMEQ_I1IM1

   SUBROUTINE FMEQ_R1IM1(R,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:) :: MA
      REAL, DIMENSION(:) :: R
      INTEGER :: J,N
      INTENT (INOUT) :: R
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA) /= SIZE(R)) THEN
          DO J = 1, SIZE(MA)
             R(J) = RUNKNO
          ENDDO
          RETURN
      ENDIF
      N = SIZE(R)
      DO J = 1, N
         CALL IMI2FM(MA(J)%MIM,MTLVFM)
         CALL FMM2SP(MTLVFM,R(J))
      ENDDO
   END SUBROUTINE FMEQ_R1IM1

   SUBROUTINE FMEQ_D1IM1(D,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:) :: MA
      DOUBLE PRECISION, DIMENSION(:) :: D
      INTEGER :: J,N
      INTENT (INOUT) :: D
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA) /= SIZE(D)) THEN
          DO J = 1, SIZE(MA)
             D(J) = RUNKNO
          ENDDO
          RETURN
      ENDIF
      N = SIZE(D)
      DO J = 1, N
         CALL IMI2FM(MA(J)%MIM,MTLVFM)
         CALL FMM2DP(MTLVFM,D(J))
      ENDDO
   END SUBROUTINE FMEQ_D1IM1

   SUBROUTINE FMEQ_Z1IM1(Z,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:) :: MA
      COMPLEX, DIMENSION(:) :: Z
      REAL :: R
      INTEGER :: J,N
      INTENT (INOUT) :: Z
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA) /= SIZE(Z)) THEN
          DO J = 1, SIZE(MA)
             Z(J) = CMPLX(RUNKNO,RUNKNO)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(Z)
      DO J = 1, N
         CALL IMI2FM(MA(J)%MIM,MTLVFM)
         CALL FMM2SP(MTLVFM,R)
         Z(J) = CMPLX(R,0.0)
      ENDDO
   END SUBROUTINE FMEQ_Z1IM1

   SUBROUTINE FMEQ_C1IM1(C,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:) :: MA
      COMPLEX (KIND(0.0D0)), DIMENSION(:) :: C
      REAL (KIND(0.0D0)) :: D
      INTEGER :: J,N
      INTENT (INOUT) :: C
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA) /= SIZE(C)) THEN
          DO J = 1, SIZE(MA)
             D = RUNKNO
             C(J) = CMPLX(D,D , KIND(0.0D0))
          ENDDO
          RETURN
      ENDIF
      N = SIZE(C)
      DO J = 1, N
         CALL IMI2FM(MA(J)%MIM,MTLVFM)
         CALL FMM2DP(MTLVFM,D)
         C(J) = CMPLX(D,0.0D0 , KIND(0.0D0))
      ENDDO
   END SUBROUTINE FMEQ_C1IM1

   SUBROUTINE FMEQ_IM1IM1(MA,MB)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:) :: MA
      TYPE (IM), DIMENSION(:) :: MB
      TYPE (IM), ALLOCATABLE, DIMENSION(:) :: TEMP
      INTEGER :: J,N
      INTENT (INOUT) :: MA
      INTENT (IN) :: MB
      TYPE(MULTI), SAVE :: MTLVIM
      CALL FM_UNDEF_INP(MB)
      IF (SIZE(MA) /= SIZE(MB)) THEN
          CALL IMST2M(' UNKNOWN ',MTLVIM)
          DO J = 1, SIZE(MA)
             CALL IMEQ(MTLVIM,MA(J)%MIM)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(MA)

!             To avoid problems when lhs and rhs are overlapping parts of the same array, move MB
!             to a temporary array before re-defining any of MA.

      ALLOCATE(TEMP(N))
      DO J = 1, N
         CALL IMEQ(MB(J)%MIM,TEMP(J)%MIM)
      ENDDO
      DO J = 1, N
         CALL IMEQ(TEMP(J)%MIM,MA(J)%MIM)
      ENDDO
      DEALLOCATE(TEMP)
   END SUBROUTINE FMEQ_IM1IM1

   SUBROUTINE FMEQ_IM1ZM1(MA,MB)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:) :: MA
      TYPE (ZM), DIMENSION(:) :: MB
      INTEGER :: J,N
      INTENT (INOUT) :: MA
      INTENT (IN) :: MB
      TYPE(MULTI), SAVE :: MTLVFM,MTLVIM
      CALL FM_UNDEF_INP(MB)
      IF (SIZE(MA) /= SIZE(MB)) THEN
          CALL IMST2M(' UNKNOWN ',MTLVIM)
          DO J = 1, SIZE(MA)
             CALL IMEQ(MTLVIM,MA(J)%MIM)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(MA)
      DO J = 1, N
         CALL ZMREAL(MB(J)%MZM,MTLVFM)
         CALL IMFM2I(MTLVFM,MA(J)%MIM)
      ENDDO
   END SUBROUTINE FMEQ_IM1ZM1

   SUBROUTINE FMEQ_ZM1IM1(MA,MB)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      TYPE (IM), DIMENSION(:) :: MB
      INTEGER :: J,N
      INTENT (INOUT) :: MA
      INTENT (IN) :: MB
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MB)
      IF (SIZE(MA) /= SIZE(MB)) THEN
          CALL ZMST2M(' UNKNOWN + UNKNOWN i ',MTLVZM)
          DO J = 1, SIZE(MA)
             CALL ZMEQ(MTLVZM,MA(J)%MZM)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(MA)
      CALL FMI2M(0,MTLVFM)
      DO J = 1, N
         CALL IMI2FM(MB(J)%MIM,MULVFM)
         CALL ZMCMPX(MULVFM,MTLVFM,MA(J)%MZM)
      ENDDO
   END SUBROUTINE FMEQ_ZM1IM1

!             (3) rank 2  =  rank 0

   SUBROUTINE FMEQ_IM2I(MA,IVAL)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:,:) :: MA
      INTEGER :: IVAL,J,K
      INTENT (INOUT) :: MA
      INTENT (IN) :: IVAL
      TYPE(MULTI), SAVE :: MTLVIM
      CALL IMI2M(IVAL,MTLVIM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL IMEQ(MTLVIM,MA(J,K)%MIM)
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_IM2I

   SUBROUTINE FMEQ_IM2R(MA,R)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:,:) :: MA
      INTEGER :: J,K
      REAL :: R
      INTENT (INOUT) :: MA
      INTENT (IN) :: R
      TYPE(MULTI), SAVE :: MTLVFM,MTLVIM
      CALL FMSP2M(R,MTLVFM)
      CALL IMFM2I(MTLVFM,MTLVIM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL IMEQ(MTLVIM,MA(J,K)%MIM)
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_IM2R

   SUBROUTINE FMEQ_IM2D(MA,D)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:,:) :: MA
      INTEGER :: J,K
      DOUBLE PRECISION :: D
      INTENT (INOUT) :: MA
      INTENT (IN) :: D
      TYPE(MULTI), SAVE :: MTLVFM,MTLVIM
      CALL FMDP2M(D,MTLVFM)
      CALL IMFM2I(MTLVFM,MTLVIM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL IMEQ(MTLVIM,MA(J,K)%MIM)
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_IM2D

   SUBROUTINE FMEQ_IM2Z(MA,Z)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:,:) :: MA
      INTEGER :: J,K
      COMPLEX :: Z
      INTENT (INOUT) :: MA
      INTENT (IN) :: Z
      TYPE(MULTI), SAVE :: MTLVFM,MTLVIM
      CALL FMSP2M(REAL(Z),MTLVFM)
      CALL IMFM2I(MTLVFM,MTLVIM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL IMEQ(MTLVIM,MA(J,K)%MIM)
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_IM2Z

   SUBROUTINE FMEQ_IM2C(MA,C)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:,:) :: MA
      INTEGER :: J,K
      COMPLEX (KIND(0.0D0)) :: C
      INTENT (INOUT) :: MA
      INTENT (IN) :: C
      TYPE(MULTI), SAVE :: MTLVFM,MTLVIM
      CALL FMDP2M(REAL(C,KIND(0.0D0)),MTLVFM)
      CALL IMFM2I(MTLVFM,MTLVIM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL IMEQ(MTLVIM,MA(J,K)%MIM)
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_IM2C

   SUBROUTINE FMEQ_I2IM(IVAL,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA
      INTEGER, DIMENSION(:,:) :: IVAL
      INTEGER :: J,K,L
      INTENT (INOUT) :: IVAL
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL IMM2I(MA%MIM,L)
      DO J = 1, SIZE(IVAL,DIM=1)
         DO K = 1, SIZE(IVAL,DIM=2)
            IVAL(J,K) = L
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_I2IM

   SUBROUTINE FMEQ_R2IM(R,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA
      REAL, DIMENSION(:,:) :: R
      REAL :: R2
      INTEGER :: J,K
      INTENT (INOUT) :: R
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL IMI2FM(MA%MIM,MTLVFM)
      CALL FMM2SP(MTLVFM,R2)
      DO J = 1, SIZE(R,DIM=1)
         DO K = 1, SIZE(R,DIM=2)
            R(J,K) = R2
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_R2IM

   SUBROUTINE FMEQ_D2IM(D,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA
      DOUBLE PRECISION, DIMENSION(:,:) :: D
      DOUBLE PRECISION :: D2
      INTEGER :: J,K
      INTENT (INOUT) :: D
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL IMI2FM(MA%MIM,MTLVFM)
      CALL FMM2DP(MTLVFM,D2)
      DO J = 1, SIZE(D,DIM=1)
         DO K = 1, SIZE(D,DIM=2)
            D(J,K) = D2
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_D2IM

   SUBROUTINE FMEQ_Z2IM(Z,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA
      COMPLEX, DIMENSION(:,:) :: Z
      REAL :: R2
      INTEGER :: J,K
      INTENT (INOUT) :: Z
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL IMI2FM(MA%MIM,MTLVFM)
      CALL FMM2SP(MTLVFM,R2)
      DO J = 1, SIZE(Z,DIM=1)
         DO K = 1, SIZE(Z,DIM=2)
            Z(J,K) = R2
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_Z2IM

   SUBROUTINE FMEQ_C2IM(C,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA
      COMPLEX (KIND(0.0D0)), DIMENSION(:,:) :: C
      DOUBLE PRECISION :: D2
      INTEGER :: J,K
      INTENT (INOUT) :: C
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL IMI2FM(MA%MIM,MTLVFM)
      CALL FMM2DP(MTLVFM,D2)
      DO J = 1, SIZE(C,DIM=1)
         DO K = 1, SIZE(C,DIM=2)
            C(J,K) = D2
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_C2IM

   SUBROUTINE FMEQ_IM2IM(MA,MB)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:,:) :: MA
      TYPE (IM) :: MB
      INTEGER :: J,K
      INTENT (INOUT) :: MA
      INTENT (IN) :: MB
      TYPE(MULTI), SAVE :: MTLVIM
      CALL FM_UNDEF_INP(MB)
      CALL IMEQ(MB%MIM,MTLVIM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL IMEQ(MTLVIM,MA(J,K)%MIM)
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_IM2IM

   SUBROUTINE FMEQ_IM2ZM(MA,MB)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:,:) :: MA
      TYPE (ZM) :: MB
      INTEGER :: J,K
      INTENT (INOUT) :: MA
      INTENT (IN) :: MB
      TYPE(MULTI), SAVE :: MTLVFM,MTLVIM
      CALL FM_UNDEF_INP(MB)
      CALL ZMREAL(MB%MZM,MTLVFM)
      CALL IMFM2I(MTLVFM,MTLVIM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL IMEQ(MTLVIM,MA(J,K)%MIM)
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_IM2ZM

   SUBROUTINE FMEQ_ZM2IM(MA,MB)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      TYPE (IM) :: MB
      INTEGER :: J,K
      INTENT (INOUT) :: MA
      INTENT (IN) :: MB
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MB)
      CALL IMI2FM(MB%MIM,MULVFM)
      CALL FMI2M(0,MTLVFM)
      CALL ZMCMPX(MULVFM,MTLVFM,MTLVZM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMEQ(MTLVZM,MA(J,K)%MZM)
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_ZM2IM

!             (4) rank 2  =  rank 2

   SUBROUTINE FMEQ_IM2I2(MA,IVAL)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:,:) :: MA
      INTEGER, DIMENSION(:,:) :: IVAL
      INTEGER :: J,K
      INTENT (INOUT) :: MA
      INTENT (IN) :: IVAL
      TYPE(MULTI), SAVE :: MTLVIM
      IF (SIZE(MA,DIM=1) /= SIZE(IVAL,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(IVAL,DIM=2)) THEN
          CALL IMST2M(' UNKNOWN ',MTLVIM)
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                CALL IMEQ(MTLVIM,MA(J,K)%MIM)
             ENDDO
          ENDDO
          RETURN
      ENDIF
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL IMI2M(IVAL(J,K),MA(J,K)%MIM)
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_IM2I2

   SUBROUTINE FMEQ_IM2R2(MA,R)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:,:) :: MA
      INTEGER :: J,K
      REAL, DIMENSION(:,:) :: R
      INTENT (INOUT) :: MA
      INTENT (IN) :: R
      TYPE(MULTI), SAVE :: MTLVFM,MTLVIM
      IF (SIZE(MA,DIM=1) /= SIZE(R,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(R,DIM=2)) THEN
          CALL IMST2M(' UNKNOWN ',MTLVIM)
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                CALL IMEQ(MTLVIM,MA(J,K)%MIM)
             ENDDO
          ENDDO
          RETURN
      ENDIF
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMSP2M(R(J,K),MTLVFM)
            CALL IMFM2I(MTLVFM,MA(J,K)%MIM)
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_IM2R2

   SUBROUTINE FMEQ_IM2D2(MA,D)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:,:) :: MA
      INTEGER :: J,K
      DOUBLE PRECISION, DIMENSION(:,:) :: D
      INTENT (INOUT) :: MA
      INTENT (IN) :: D
      TYPE(MULTI), SAVE :: MTLVFM,MTLVIM
      IF (SIZE(MA,DIM=1) /= SIZE(D,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(D,DIM=2)) THEN
          CALL IMST2M(' UNKNOWN ',MTLVIM)
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                CALL IMEQ(MTLVIM,MA(J,K)%MIM)
             ENDDO
          ENDDO
          RETURN
      ENDIF
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMDP2M(D(J,K),MTLVFM)
            CALL IMFM2I(MTLVFM,MA(J,K)%MIM)
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_IM2D2

   SUBROUTINE FMEQ_IM2Z2(MA,Z)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:,:) :: MA
      INTEGER :: J,K
      COMPLEX, DIMENSION(:,:) :: Z
      INTENT (INOUT) :: MA
      INTENT (IN) :: Z
      TYPE(MULTI), SAVE :: MTLVFM,MTLVIM
      IF (SIZE(MA,DIM=1) /= SIZE(Z,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(Z,DIM=2)) THEN
          CALL IMST2M(' UNKNOWN ',MTLVIM)
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                CALL IMEQ(MTLVIM,MA(J,K)%MIM)
             ENDDO
          ENDDO
          RETURN
      ENDIF
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMSP2M(REAL(Z(J,K)),MTLVFM)
            CALL IMFM2I(MTLVFM,MA(J,K)%MIM)
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_IM2Z2

   SUBROUTINE FMEQ_IM2C2(MA,C)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:,:) :: MA
      INTEGER :: J,K
      COMPLEX (KIND(0.0D0)), DIMENSION(:,:) :: C
      INTENT (INOUT) :: MA
      INTENT (IN) :: C
      TYPE(MULTI), SAVE :: MTLVFM,MTLVIM
      IF (SIZE(MA,DIM=1) /= SIZE(C,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(C,DIM=2)) THEN
          CALL IMST2M(' UNKNOWN ',MTLVIM)
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                CALL IMEQ(MTLVIM,MA(J,K)%MIM)
             ENDDO
          ENDDO
          RETURN
      ENDIF
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMDP2M(REAL(C(J,K),KIND(0.0D0)),MTLVFM)
            CALL IMFM2I(MTLVFM,MA(J,K)%MIM)
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_IM2C2

   SUBROUTINE FMEQ_I2IM2(IVAL,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:,:) :: MA
      INTEGER, DIMENSION(:,:) :: IVAL
      INTEGER :: J,K
      INTENT (INOUT) :: IVAL
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA,DIM=1) /= SIZE(IVAL,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(IVAL,DIM=2)) THEN
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                IVAL(J,K) = IUNKNO
             ENDDO
          ENDDO
          RETURN
      ENDIF
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL IMM2I(MA(J,K)%MIM,IVAL(J,K))
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_I2IM2

   SUBROUTINE FMEQ_R2IM2(R,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:,:) :: MA
      REAL, DIMENSION(:,:) :: R
      INTEGER :: J,K
      INTENT (INOUT) :: R
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA,DIM=1) /= SIZE(R,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(R,DIM=2)) THEN
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                R(J,K) = RUNKNO
             ENDDO
          ENDDO
          RETURN
      ENDIF
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL IMI2FM(MA(J,K)%MIM,MTLVFM)
            CALL FMM2SP(MTLVFM,R(J,K))
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_R2IM2

   SUBROUTINE FMEQ_D2IM2(D,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:,:) :: MA
      DOUBLE PRECISION, DIMENSION(:,:) :: D
      INTEGER :: J,K
      INTENT (INOUT) :: D
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA,DIM=1) /= SIZE(D,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(D,DIM=2)) THEN
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                D(J,K) = RUNKNO
             ENDDO
          ENDDO
          RETURN
      ENDIF
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL IMI2FM(MA(J,K)%MIM,MTLVFM)
            CALL FMM2DP(MTLVFM,D(J,K))
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_D2IM2

   SUBROUTINE FMEQ_Z2IM2(Z,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:,:) :: MA
      COMPLEX, DIMENSION(:,:) :: Z
      REAL :: R
      INTEGER :: J,K
      INTENT (INOUT) :: Z
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA,DIM=1) /= SIZE(Z,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(Z,DIM=2)) THEN
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                Z(J,K) = CMPLX(RUNKNO,RUNKNO)
             ENDDO
          ENDDO
          RETURN
      ENDIF
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL IMI2FM(MA(J,K)%MIM,MTLVFM)
            CALL FMM2SP(MTLVFM,R)
            Z(J,K) = CMPLX(R,0.0)
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_Z2IM2

   SUBROUTINE FMEQ_C2IM2(C,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:,:) :: MA
      COMPLEX (KIND(0.0D0)), DIMENSION(:,:) :: C
      REAL (KIND(0.0D0)) :: D
      INTEGER :: J,K
      INTENT (INOUT) :: C
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA,DIM=1) /= SIZE(C,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(C,DIM=2)) THEN
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                D = RUNKNO
                C(J,K) = CMPLX(D,D , KIND(0.0D0))
             ENDDO
          ENDDO
          RETURN
      ENDIF
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL IMI2FM(MA(J,K)%MIM,MTLVFM)
            CALL FMM2DP(MTLVFM,D)
            C(J,K) = CMPLX(D,0.0D0 , KIND(0.0D0))
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_C2IM2

   SUBROUTINE FMEQ_IM2IM2(MA,MB)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:,:) :: MA
      TYPE (IM), DIMENSION(:,:) :: MB
      TYPE (IM), ALLOCATABLE, DIMENSION(:,:) :: TEMP
      INTEGER :: J,K
      INTENT (INOUT) :: MA
      INTENT (IN) :: MB
      TYPE(MULTI), SAVE :: MTLVIM
      CALL FM_UNDEF_INP(MB)
      IF (SIZE(MA,DIM=1) /= SIZE(MB,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(MB,DIM=2)) THEN
          CALL IMST2M(' UNKNOWN ',MTLVIM)
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                CALL IMEQ(MTLVIM,MA(J,K)%MIM)
             ENDDO
          ENDDO
          RETURN
      ENDIF

!             To avoid problems when lhs and rhs are overlapping parts of the same array, move MB
!             to a temporary array before re-defining any of MA.

      ALLOCATE(TEMP(SIZE(MA,DIM=1),SIZE(MA,DIM=2)))
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL IMEQ(MB(J,K)%MIM,TEMP(J,K)%MIM)
         ENDDO
      ENDDO
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL IMEQ(TEMP(J,K)%MIM,MA(J,K)%MIM)
         ENDDO
      ENDDO
      DEALLOCATE(TEMP)
   END SUBROUTINE FMEQ_IM2IM2

   SUBROUTINE FMEQ_IM2ZM2(MA,MB)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:,:) :: MA
      TYPE (ZM), DIMENSION(:,:) :: MB
      INTEGER :: J,K
      INTENT (INOUT) :: MA
      INTENT (IN) :: MB
      TYPE(MULTI), SAVE :: MTLVFM,MTLVIM
      CALL FM_UNDEF_INP(MB)
      IF (SIZE(MA,DIM=1) /= SIZE(MB,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(MB,DIM=2)) THEN
          CALL IMST2M(' UNKNOWN ',MTLVIM)
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                CALL IMEQ(MTLVIM,MA(J,K)%MIM)
             ENDDO
          ENDDO
          RETURN
      ENDIF
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMREAL(MB(J,K)%MZM,MTLVFM)
            CALL IMFM2I(MTLVFM,MA(J,K)%MIM)
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_IM2ZM2

   SUBROUTINE FMEQ_ZM2IM2(MA,MB)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      TYPE (IM), DIMENSION(:,:) :: MB
      INTEGER :: J,K
      INTENT (INOUT) :: MA
      INTENT (IN) :: MB
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MB)
      IF (SIZE(MA,DIM=1) /= SIZE(MB,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(MB,DIM=2)) THEN
          CALL ZMST2M(' UNKNOWN + UNKNOWN i ',MTLVZM)
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                CALL ZMEQ(MTLVZM,MA(J,K)%MZM)
             ENDDO
          ENDDO
          RETURN
      ENDIF
      CALL FMI2M(0,MTLVFM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL IMI2FM(MB(J,K)%MIM,MULVFM)
            CALL ZMCMPX(MULVFM,MTLVFM,MA(J,K)%MZM)
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_ZM2IM2

!             Array equal assignments for ZM.

!             (1) rank 1  =  rank 0

   SUBROUTINE FMEQ_ZM1I(MA,IVAL)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      INTEGER :: IVAL,J,N
      INTENT (INOUT) :: MA
      INTENT (IN) :: IVAL
      TYPE(MULTI), SAVE :: MTLVZM(2)
      N = SIZE(MA)
      CALL ZMI2M(IVAL,MTLVZM)
      DO J = 1, N
         CALL ZMEQ(MTLVZM,MA(J)%MZM)
      ENDDO
   END SUBROUTINE FMEQ_ZM1I

   SUBROUTINE FMEQ_ZM1R(MA,R)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      INTEGER :: J,N
      REAL :: R
      INTENT (INOUT) :: MA
      INTENT (IN) :: R
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      N = SIZE(MA)
      CALL FMSP2M(R,MTLVFM)
      CALL FMI2M(0,MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
      DO J = 1, N
         CALL ZMEQ(MTLVZM,MA(J)%MZM)
      ENDDO
   END SUBROUTINE FMEQ_ZM1R

   SUBROUTINE FMEQ_ZM1D(MA,D)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      INTEGER :: J,N
      DOUBLE PRECISION :: D
      INTENT (INOUT) :: MA
      INTENT (IN) :: D
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      N = SIZE(MA)
      CALL FMDP2M(D,MTLVFM)
      CALL FMI2M(0,MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
      DO J = 1, N
         CALL ZMEQ(MTLVZM,MA(J)%MZM)
      ENDDO
   END SUBROUTINE FMEQ_ZM1D

   SUBROUTINE FMEQ_ZM1Z(MA,Z)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      INTEGER :: J,N
      COMPLEX :: Z
      INTENT (INOUT) :: MA
      INTENT (IN) :: Z
      TYPE(MULTI), SAVE :: MTLVZM(2)
      N = SIZE(MA)
      CALL ZMZ2M(Z,MTLVZM)
      DO J = 1, N
         CALL ZMEQ(MTLVZM,MA(J)%MZM)
      ENDDO
   END SUBROUTINE FMEQ_ZM1Z

   SUBROUTINE FMEQ_ZM1C(MA,C)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      INTEGER :: J,N
      COMPLEX (KIND(0.0D0)) :: C
      DOUBLE PRECISION :: D
      INTENT (INOUT) :: MA
      INTENT (IN) :: C
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      N = SIZE(MA)
      CALL FMDP2M(REAL(C,KIND(0.0D0)),MTLVFM)
      D = AIMAG(C)
      CALL FMDP2M(D,MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
      DO J = 1, N
         CALL ZMEQ(MTLVZM,MA(J)%MZM)
      ENDDO
   END SUBROUTINE FMEQ_ZM1C

   SUBROUTINE FMEQ_I1ZM(IVAL,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA
      INTEGER, DIMENSION(:) :: IVAL
      INTEGER :: J,K,N
      INTENT (INOUT) :: IVAL
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      N = SIZE(IVAL)
      CALL ZMM2I(MA%MZM,K)
      DO J = 1, N
         IVAL(J) = K
      ENDDO
   END SUBROUTINE FMEQ_I1ZM

   SUBROUTINE FMEQ_R1ZM(R,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA
      REAL, DIMENSION(:) :: R
      REAL :: R2
      INTEGER :: J,N
      INTENT (INOUT) :: R
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      N = SIZE(R)
      CALL ZMREAL(MA%MZM,MTLVFM)
      CALL FMM2SP(MTLVFM,R2)
      DO J = 1, N
         R(J) = R2
      ENDDO
   END SUBROUTINE FMEQ_R1ZM

   SUBROUTINE FMEQ_D1ZM(D,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA
      DOUBLE PRECISION, DIMENSION(:) :: D
      DOUBLE PRECISION :: D2
      INTEGER :: J,N
      INTENT (INOUT) :: D
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      N = SIZE(D)
      CALL ZMREAL(MA%MZM,MTLVFM)
      CALL FMM2DP(MTLVFM,D2)
      DO J = 1, N
         D(J) = D2
      ENDDO
   END SUBROUTINE FMEQ_D1ZM

   SUBROUTINE FMEQ_Z1ZM(Z,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA
      COMPLEX, DIMENSION(:) :: Z
      COMPLEX :: Z2
      INTEGER :: J,N
      INTENT (INOUT) :: Z
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      N = SIZE(Z)
      CALL ZMM2Z(MA%MZM,Z2)
      DO J = 1, N
         Z(J) = Z2
      ENDDO
   END SUBROUTINE FMEQ_Z1ZM

   SUBROUTINE FMEQ_C1ZM(C,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA
      COMPLEX (KIND(0.0D0)), DIMENSION(:) :: C
      DOUBLE PRECISION :: D2,D3
      INTEGER :: J,N
      INTENT (INOUT) :: C
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      N = SIZE(C)
      CALL ZMREAL(MA%MZM,MTLVFM)
      CALL FMM2DP(MTLVFM,D2)
      CALL ZMIMAG(MA%MZM,MTLVFM)
      CALL FMM2DP(MTLVFM,D3)
      DO J = 1, N
         C(J) = CMPLX(D2,D3, KIND(0.0D0))
      ENDDO
   END SUBROUTINE FMEQ_C1ZM

   SUBROUTINE FMEQ_ZM1ZM(MA,MB)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      TYPE (ZM) :: MB
      INTEGER :: J,N
      INTENT (INOUT) :: MA
      INTENT (IN) :: MB
      TYPE(MULTI), SAVE :: MTLVZM(2)
      CALL FM_UNDEF_INP(MB)
      N = SIZE(MA)
      CALL ZMEQ(MB%MZM,MTLVZM)
      DO J = 1, N
         CALL ZMEQ(MTLVZM,MA(J)%MZM)
      ENDDO
   END SUBROUTINE FMEQ_ZM1ZM

!             (2) rank 1  =  rank 1

   SUBROUTINE FMEQ_ZM1I1(MA,IVAL)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      INTEGER, DIMENSION(:) :: IVAL
      INTEGER :: J,N
      INTENT (INOUT) :: MA
      INTENT (IN) :: IVAL
      TYPE(MULTI), SAVE :: MTLVZM(2)
      IF (SIZE(MA) /= SIZE(IVAL)) THEN
          CALL ZMST2M(' UNKNOWN + UNKNOWN i ',MTLVZM)
          DO J = 1, SIZE(MA)
             CALL ZMEQ(MTLVZM,MA(J)%MZM)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(MA)
      DO J = 1, N
         CALL ZMI2M(IVAL(J),MA(J)%MZM)
      ENDDO
   END SUBROUTINE FMEQ_ZM1I1

   SUBROUTINE FMEQ_ZM1R1(MA,R)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      INTEGER :: J,N
      REAL, DIMENSION(:) :: R
      INTENT (INOUT) :: MA
      INTENT (IN) :: R
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      IF (SIZE(MA) /= SIZE(R)) THEN
          CALL ZMST2M(' UNKNOWN + UNKNOWN i ',MTLVZM)
          DO J = 1, SIZE(MA)
             CALL ZMEQ(MTLVZM,MA(J)%MZM)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(MA)
      CALL FMI2M(0,MULVFM)
      DO J = 1, N
         CALL FMSP2M(R(J),MTLVFM)
         CALL ZMCMPX(MTLVFM,MULVFM,MA(J)%MZM)
      ENDDO
   END SUBROUTINE FMEQ_ZM1R1

   SUBROUTINE FMEQ_ZM1D1(MA,D)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      INTEGER :: J,N
      DOUBLE PRECISION, DIMENSION(:) :: D
      INTENT (INOUT) :: MA
      INTENT (IN) :: D
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      IF (SIZE(MA) /= SIZE(D)) THEN
          CALL ZMST2M(' UNKNOWN + UNKNOWN i ',MTLVZM)
          DO J = 1, SIZE(MA)
             CALL ZMEQ(MTLVZM,MA(J)%MZM)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(MA)
      CALL FMI2M(0,MULVFM)
      DO J = 1, N
         CALL FMDP2M(D(J),MTLVFM)
         CALL ZMCMPX(MTLVFM,MULVFM,MA(J)%MZM)
      ENDDO
   END SUBROUTINE FMEQ_ZM1D1

   SUBROUTINE FMEQ_ZM1Z1(MA,Z)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      INTEGER :: J,N
      COMPLEX, DIMENSION(:) :: Z
      INTENT (INOUT) :: MA
      INTENT (IN) :: Z
      TYPE(MULTI), SAVE :: MTLVZM(2)
      IF (SIZE(MA) /= SIZE(Z)) THEN
          CALL ZMST2M(' UNKNOWN + UNKNOWN i ',MTLVZM)
          DO J = 1, SIZE(MA)
             CALL ZMEQ(MTLVZM,MA(J)%MZM)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(MA)
      DO J = 1, N
         CALL ZMZ2M(Z(J),MA(J)%MZM)
      ENDDO
   END SUBROUTINE FMEQ_ZM1Z1

   SUBROUTINE FMEQ_ZM1C1(MA,C)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      INTEGER :: J,N
      COMPLEX (KIND(0.0D0)), DIMENSION(:) :: C
      DOUBLE PRECISION :: D
      INTENT (INOUT) :: MA
      INTENT (IN) :: C
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      IF (SIZE(MA) /= SIZE(C)) THEN
          CALL ZMST2M(' UNKNOWN + UNKNOWN i ',MTLVZM)
          DO J = 1, SIZE(MA)
             CALL ZMEQ(MTLVZM,MA(J)%MZM)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(MA)
      DO J = 1, N
         CALL FMDP2M(REAL(C(J),KIND(0.0D0)),MTLVFM)
         D = AIMAG(C(J))
         CALL FMDP2M(D,MULVFM)
         CALL ZMCMPX(MTLVFM,MULVFM,MA(J)%MZM)
      ENDDO
   END SUBROUTINE FMEQ_ZM1C1

   SUBROUTINE FMEQ_I1ZM1(IVAL,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      INTEGER, DIMENSION(:) :: IVAL
      INTEGER :: J,N
      INTENT (INOUT) :: IVAL
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA) /= SIZE(IVAL)) THEN
          DO J = 1, SIZE(MA)
             IVAL(J) = IUNKNO
          ENDDO
          RETURN
      ENDIF
      N = SIZE(IVAL)
      DO J = 1, N
         CALL ZMM2I(MA(J)%MZM,IVAL(J))
      ENDDO
   END SUBROUTINE FMEQ_I1ZM1

   SUBROUTINE FMEQ_R1ZM1(R,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      REAL, DIMENSION(:) :: R
      INTEGER :: J,N
      INTENT (INOUT) :: R
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA) /= SIZE(R)) THEN
          DO J = 1, SIZE(MA)
             R(J) = RUNKNO
          ENDDO
          RETURN
      ENDIF
      N = SIZE(R)
      DO J = 1, N
         CALL ZMREAL(MA(J)%MZM,MTLVFM)
         CALL FMM2SP(MTLVFM,R(J))
      ENDDO
   END SUBROUTINE FMEQ_R1ZM1

   SUBROUTINE FMEQ_D1ZM1(D,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      DOUBLE PRECISION, DIMENSION(:) :: D
      INTEGER :: J,N
      INTENT (INOUT) :: D
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA) /= SIZE(D)) THEN
          DO J = 1, SIZE(MA)
             D(J) = RUNKNO
          ENDDO
          RETURN
      ENDIF
      N = SIZE(D)
      DO J = 1, N
         CALL ZMREAL(MA(J)%MZM,MTLVFM)
         CALL FMM2DP(MTLVFM,D(J))
      ENDDO
   END SUBROUTINE FMEQ_D1ZM1

   SUBROUTINE FMEQ_Z1ZM1(Z,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      COMPLEX, DIMENSION(:) :: Z
      INTEGER :: J,N
      INTENT (INOUT) :: Z
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA) /= SIZE(Z)) THEN
          DO J = 1, SIZE(MA)
             Z(J) = CMPLX(RUNKNO,RUNKNO)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(Z)
      DO J = 1, N
         CALL ZMM2Z(MA(J)%MZM,Z(J))
      ENDDO
   END SUBROUTINE FMEQ_Z1ZM1

   SUBROUTINE FMEQ_C1ZM1(C,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      COMPLEX (KIND(0.0D0)), DIMENSION(:) :: C
      REAL (KIND(0.0D0)) :: D,D1,D2
      INTEGER :: J,N
      INTENT (INOUT) :: C
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA) /= SIZE(C)) THEN
          DO J = 1, SIZE(MA)
             D = RUNKNO
             C(J) = CMPLX(D,D , KIND(0.0D0))
          ENDDO
          RETURN
      ENDIF
      N = SIZE(C)
      DO J = 1, N
         CALL ZMREAL(MA(J)%MZM,MTLVFM)
         CALL FMM2DP(MTLVFM,D1)
         CALL ZMIMAG(MA(J)%MZM,MTLVFM)
         CALL FMM2DP(MTLVFM,D2)
         C(J) = CMPLX(D1,D2 , KIND(0.0D0))
      ENDDO
   END SUBROUTINE FMEQ_C1ZM1

   SUBROUTINE FMEQ_ZM1ZM1(MA,MB)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      TYPE (ZM), DIMENSION(:) :: MB
      TYPE (ZM), ALLOCATABLE, DIMENSION(:) :: TEMP
      INTEGER :: J,N
      INTENT (INOUT) :: MA
      INTENT (IN) :: MB
      TYPE(MULTI), SAVE :: MTLVZM(2)
      CALL FM_UNDEF_INP(MB)
      IF (SIZE(MA) /= SIZE(MB)) THEN
          CALL ZMST2M(' UNKNOWN + UNKNOWN i ',MTLVZM)
          DO J = 1, SIZE(MA)
             CALL ZMEQ(MTLVZM,MA(J)%MZM)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(MA)

!             To avoid problems when lhs and rhs are overlapping parts of the same array, move MB
!             to a temporary array before re-defining any of MA.

      ALLOCATE(TEMP(N))
      DO J = 1, N
         CALL ZMEQ(MB(J)%MZM,TEMP(J)%MZM)
      ENDDO
      DO J = 1, N
         CALL ZMEQ(TEMP(J)%MZM,MA(J)%MZM)
      ENDDO
      DEALLOCATE(TEMP)
   END SUBROUTINE FMEQ_ZM1ZM1

!             (3) rank 2  =  rank 0

   SUBROUTINE FMEQ_ZM2I(MA,IVAL)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      INTEGER :: IVAL,J,K
      INTENT (INOUT) :: MA
      INTENT (IN) :: IVAL
      TYPE(MULTI), SAVE :: MTLVZM(2)
      CALL ZMI2M(IVAL,MTLVZM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMEQ(MTLVZM,MA(J,K)%MZM)
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_ZM2I

   SUBROUTINE FMEQ_ZM2R(MA,R)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      INTEGER :: J,K
      REAL :: R
      INTENT (INOUT) :: MA
      INTENT (IN) :: R
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FMSP2M(R,MTLVFM)
      CALL FMI2M(0,MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMEQ(MTLVZM,MA(J,K)%MZM)
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_ZM2R

   SUBROUTINE FMEQ_ZM2D(MA,D)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      INTEGER :: J,K
      DOUBLE PRECISION :: D
      INTENT (INOUT) :: MA
      INTENT (IN) :: D
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FMDP2M(D,MTLVFM)
      CALL FMI2M(0,MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMEQ(MTLVZM,MA(J,K)%MZM)
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_ZM2D

   SUBROUTINE FMEQ_ZM2Z(MA,Z)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      INTEGER :: J,K
      COMPLEX :: Z
      INTENT (INOUT) :: MA
      INTENT (IN) :: Z
      TYPE(MULTI), SAVE :: MTLVZM(2)
      CALL ZMZ2M(Z,MTLVZM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMEQ(MTLVZM,MA(J,K)%MZM)
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_ZM2Z

   SUBROUTINE FMEQ_ZM2C(MA,C)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      INTEGER :: J,K
      COMPLEX (KIND(0.0D0)) :: C
      DOUBLE PRECISION :: D
      INTENT (INOUT) :: MA
      INTENT (IN) :: C
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FMDP2M(REAL(C,KIND(0.0D0)),MTLVFM)
      D = AIMAG(C)
      CALL FMDP2M(D,MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMEQ(MTLVZM,MA(J,K)%MZM)
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_ZM2C

   SUBROUTINE FMEQ_I2ZM(IVAL,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA
      INTEGER, DIMENSION(:,:) :: IVAL
      INTEGER :: J,K,L
      INTENT (INOUT) :: IVAL
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL ZMM2I(MA%MZM,L)
      DO J = 1, SIZE(IVAL,DIM=1)
         DO K = 1, SIZE(IVAL,DIM=2)
            IVAL(J,K) = L
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_I2ZM

   SUBROUTINE FMEQ_R2ZM(R,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA
      REAL, DIMENSION(:,:) :: R
      REAL :: R2
      INTEGER :: J,K
      INTENT (INOUT) :: R
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL ZMREAL(MA%MZM,MTLVFM)
      CALL FMM2SP(MTLVFM,R2)
      DO J = 1, SIZE(R,DIM=1)
         DO K = 1, SIZE(R,DIM=2)
            R(J,K) = R2
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_R2ZM

   SUBROUTINE FMEQ_D2ZM(D,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA
      DOUBLE PRECISION, DIMENSION(:,:) :: D
      DOUBLE PRECISION :: D2
      INTEGER :: J,K
      INTENT (INOUT) :: D
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL ZMREAL(MA%MZM,MTLVFM)
      CALL FMM2DP(MTLVFM,D2)
      DO J = 1, SIZE(D,DIM=1)
         DO K = 1, SIZE(D,DIM=2)
            D(J,K) = D2
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_D2ZM

   SUBROUTINE FMEQ_Z2ZM(Z,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA
      COMPLEX, DIMENSION(:,:) :: Z
      COMPLEX :: Z2
      INTEGER :: J,K
      INTENT (INOUT) :: Z
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL ZMM2Z(MA%MZM,Z2)
      DO J = 1, SIZE(Z,DIM=1)
         DO K = 1, SIZE(Z,DIM=2)
            Z(J,K) = Z2
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_Z2ZM

   SUBROUTINE FMEQ_C2ZM(C,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA
      COMPLEX (KIND(0.0D0)), DIMENSION(:,:) :: C
      DOUBLE PRECISION :: D2,D3
      INTEGER :: J,K
      INTENT (INOUT) :: C
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL ZMREAL(MA%MZM,MTLVFM)
      CALL FMM2DP(MTLVFM,D2)
      CALL ZMIMAG(MA%MZM,MTLVFM)
      CALL FMM2DP(MTLVFM,D3)
      DO J = 1, SIZE(C,DIM=1)
         DO K = 1, SIZE(C,DIM=2)
            C(J,K) = CMPLX(D2,D3, KIND(0.0D0))
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_C2ZM

   SUBROUTINE FMEQ_ZM2ZM(MA,MB)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      TYPE (ZM) :: MB
      INTEGER :: J,K
      INTENT (INOUT) :: MA
      INTENT (IN) :: MB
      TYPE(MULTI), SAVE :: MTLVZM(2)
      CALL FM_UNDEF_INP(MB)
      CALL ZMEQ(MB%MZM,MTLVZM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMEQ(MTLVZM,MA(J,K)%MZM)
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_ZM2ZM

!             (4) rank 2  =  rank 2

   SUBROUTINE FMEQ_ZM2I2(MA,IVAL)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      INTEGER, DIMENSION(:,:) :: IVAL
      INTEGER :: J,K
      INTENT (INOUT) :: MA
      INTENT (IN) :: IVAL
      TYPE(MULTI), SAVE :: MTLVZM(2)
      IF (SIZE(MA,DIM=1) /= SIZE(IVAL,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(IVAL,DIM=2)) THEN
          CALL ZMST2M(' UNKNOWN + UNKNOWN i ',MTLVZM)
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                CALL ZMEQ(MTLVZM,MA(J,K)%MZM)
             ENDDO
          ENDDO
          RETURN
      ENDIF
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMI2M(IVAL(J,K),MA(J,K)%MZM)
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_ZM2I2

   SUBROUTINE FMEQ_ZM2R2(MA,R)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      INTEGER :: J,K
      REAL, DIMENSION(:,:) :: R
      INTENT (INOUT) :: MA
      INTENT (IN) :: R
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      IF (SIZE(MA,DIM=1) /= SIZE(R,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(R,DIM=2)) THEN
          CALL ZMST2M(' UNKNOWN + UNKNOWN i ',MTLVZM)
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                CALL ZMEQ(MTLVZM,MA(J,K)%MZM)
             ENDDO
          ENDDO
          RETURN
      ENDIF
      CALL FMI2M(0,MULVFM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMSP2M(R(J,K),MTLVFM)
            CALL ZMCMPX(MTLVFM,MULVFM,MA(J,K)%MZM)
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_ZM2R2

   SUBROUTINE FMEQ_ZM2D2(MA,D)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      INTEGER :: J,K
      DOUBLE PRECISION, DIMENSION(:,:) :: D
      INTENT (INOUT) :: MA
      INTENT (IN) :: D
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      IF (SIZE(MA,DIM=1) /= SIZE(D,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(D,DIM=2)) THEN
          CALL ZMST2M(' UNKNOWN + UNKNOWN i ',MTLVZM)
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                CALL ZMEQ(MTLVZM,MA(J,K)%MZM)
             ENDDO
          ENDDO
          RETURN
      ENDIF
      CALL FMI2M(0,MULVFM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMDP2M(D(J,K),MTLVFM)
            CALL ZMCMPX(MTLVFM,MULVFM,MA(J,K)%MZM)
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_ZM2D2

   SUBROUTINE FMEQ_ZM2Z2(MA,Z)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      INTEGER :: J,K
      COMPLEX, DIMENSION(:,:) :: Z
      INTENT (INOUT) :: MA
      INTENT (IN) :: Z
      TYPE(MULTI), SAVE :: MTLVZM(2)
      IF (SIZE(MA,DIM=1) /= SIZE(Z,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(Z,DIM=2)) THEN
          CALL ZMST2M(' UNKNOWN + UNKNOWN i ',MTLVZM)
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                CALL ZMEQ(MTLVZM,MA(J,K)%MZM)
             ENDDO
          ENDDO
          RETURN
      ENDIF
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMZ2M(Z(J,K),MA(J,K)%MZM)
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_ZM2Z2

   SUBROUTINE FMEQ_ZM2C2(MA,C)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      INTEGER :: J,K
      COMPLEX (KIND(0.0D0)), DIMENSION(:,:) :: C
      DOUBLE PRECISION :: D
      INTENT (INOUT) :: MA
      INTENT (IN) :: C
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      IF (SIZE(MA,DIM=1) /= SIZE(C,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(C,DIM=2)) THEN
          CALL ZMST2M(' UNKNOWN + UNKNOWN i ',MTLVZM)
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                CALL ZMEQ(MTLVZM,MA(J,K)%MZM)
             ENDDO
          ENDDO
          RETURN
      ENDIF
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMDP2M(REAL(C(J,K),KIND(0.0D0)),MTLVFM)
            D = AIMAG(C(J,K))
            CALL FMDP2M(D,MULVFM)
            CALL ZMCMPX(MTLVFM,MULVFM,MA(J,K)%MZM)
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_ZM2C2

   SUBROUTINE FMEQ_I2ZM2(IVAL,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      INTEGER, DIMENSION(:,:) :: IVAL
      INTEGER :: J,K
      INTENT (INOUT) :: IVAL
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA,DIM=1) /= SIZE(IVAL,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(IVAL,DIM=2)) THEN
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                IVAL(J,K) = IUNKNO
             ENDDO
          ENDDO
          RETURN
      ENDIF
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMM2I(MA(J,K)%MZM,IVAL(J,K))
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_I2ZM2

   SUBROUTINE FMEQ_R2ZM2(R,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      REAL, DIMENSION(:,:) :: R
      INTEGER :: J,K
      INTENT (INOUT) :: R
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA,DIM=1) /= SIZE(R,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(R,DIM=2)) THEN
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                R(J,K) = RUNKNO
             ENDDO
          ENDDO
          RETURN
      ENDIF
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMREAL(MA(J,K)%MZM,MTLVFM)
            CALL FMM2SP(MTLVFM,R(J,K))
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_R2ZM2

   SUBROUTINE FMEQ_D2ZM2(D,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      DOUBLE PRECISION, DIMENSION(:,:) :: D
      INTEGER :: J,K
      INTENT (INOUT) :: D
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA,DIM=1) /= SIZE(D,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(D,DIM=2)) THEN
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                D(J,K) = RUNKNO
             ENDDO
          ENDDO
          RETURN
      ENDIF
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMREAL(MA(J,K)%MZM,MTLVFM)
            CALL FMM2DP(MTLVFM,D(J,K))
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_D2ZM2

   SUBROUTINE FMEQ_Z2ZM2(Z,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      COMPLEX, DIMENSION(:,:) :: Z
      INTEGER :: J,K
      INTENT (INOUT) :: Z
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA,DIM=1) /= SIZE(Z,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(Z,DIM=2)) THEN
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                Z(J,K) = CMPLX(RUNKNO,RUNKNO)
             ENDDO
          ENDDO
          RETURN
      ENDIF
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMM2Z(MA(J,K)%MZM,Z(J,K))
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_Z2ZM2

   SUBROUTINE FMEQ_C2ZM2(C,MA)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      COMPLEX (KIND(0.0D0)), DIMENSION(:,:) :: C
      REAL (KIND(0.0D0)) :: D,D1,D2
      INTEGER :: J,K
      INTENT (INOUT) :: C
      INTENT (IN) :: MA
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA,DIM=1) /= SIZE(C,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(C,DIM=2)) THEN
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                D = RUNKNO
                C(J,K) = CMPLX(D,D , KIND(0.0D0))
             ENDDO
          ENDDO
          RETURN
      ENDIF
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMREAL(MA(J,K)%MZM,MTLVFM)
            CALL FMM2DP(MTLVFM,D1)
            CALL ZMIMAG(MA(J,K)%MZM,MTLVFM)
            CALL FMM2DP(MTLVFM,D2)
            C(J,K) = CMPLX(D1,D2 , KIND(0.0D0))
         ENDDO
      ENDDO
   END SUBROUTINE FMEQ_C2ZM2

   SUBROUTINE FMEQ_ZM2ZM2(MA,MB)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      TYPE (ZM), DIMENSION(:,:) :: MB
      TYPE (ZM), ALLOCATABLE, DIMENSION(:,:) :: TEMP
      INTEGER :: J,K
      INTENT (INOUT) :: MA
      INTENT (IN) :: MB
      TYPE(MULTI), SAVE :: MTLVZM(2)
      CALL FM_UNDEF_INP(MB)
      IF (SIZE(MA,DIM=1) /= SIZE(MB,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(MB,DIM=2)) THEN
          CALL ZMST2M(' UNKNOWN + UNKNOWN i ',MTLVZM)
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                CALL ZMEQ(MTLVZM,MA(J,K)%MZM)
             ENDDO
          ENDDO
          RETURN
      ENDIF

!             To avoid problems when lhs and rhs are overlapping parts of the same array, move MB
!             to a temporary array before re-defining any of MA.

      ALLOCATE(TEMP(SIZE(MA,DIM=1),SIZE(MA,DIM=2)))
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMEQ(MB(J,K)%MZM,TEMP(J,K)%MZM)
         ENDDO
      ENDDO
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMEQ(TEMP(J,K)%MZM,MA(J,K)%MZM)
         ENDDO
      ENDDO
      DEALLOCATE(TEMP)
   END SUBROUTINE FMEQ_ZM2ZM2

!                                                                  ==

   FUNCTION FMLEQ_IFM(IVAL,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      LOGICAL :: RETURN_VALUE
      LOGICAL, EXTERNAL :: FMCOMP
      TYPE (FM) :: MA
      INTEGER :: IVAL
      INTENT (IN) :: IVAL,MA
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMI2M(IVAL,MTLVFM)
      RETURN_VALUE = FMCOMP(MTLVFM,'EQ',MA%MFM)
   END FUNCTION FMLEQ_IFM

   FUNCTION FMLEQ_IIM(IVAL,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      LOGICAL :: RETURN_VALUE
      LOGICAL, EXTERNAL :: IMCOMP
      TYPE (IM) :: MA
      INTEGER :: IVAL
      INTENT (IN) :: IVAL,MA
      TYPE(MULTI), SAVE :: MTLVIM
      CALL FM_UNDEF_INP(MA)
      CALL IMI2M(IVAL,MTLVIM)
      RETURN_VALUE = IMCOMP(MTLVIM,'EQ',MA%MIM)
   END FUNCTION FMLEQ_IIM

   FUNCTION FMLEQ_IZM(IVAL,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      LOGICAL :: RETURN_VALUE,L1,L2
      LOGICAL, EXTERNAL :: FMCOMP
      TYPE (ZM) :: MA
      INTEGER :: IVAL
      INTENT (IN) :: IVAL,MA
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMI2M(IVAL,MTLVFM)
      CALL ZMREAL(MA%MZM,MULVFM)
      L1 = FMCOMP(MTLVFM,'EQ',MULVFM)
      CALL FMI2M(0,MTLVFM)
      CALL ZMIMAG(MA%MZM,MULVFM)
      L2 = FMCOMP(MTLVFM,'EQ',MULVFM)
      RETURN_VALUE = L1.AND.L2
   END FUNCTION FMLEQ_IZM

   FUNCTION FMLEQ_RFM(R,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      LOGICAL :: RETURN_VALUE
      LOGICAL, EXTERNAL :: FMCOMP
      TYPE (FM) :: MA
      REAL :: R
      INTENT (IN) :: R,MA
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMSP2M(R,MTLVFM)
      RETURN_VALUE = FMCOMP(MTLVFM,'EQ',MA%MFM)
   END FUNCTION FMLEQ_RFM

   FUNCTION FMLEQ_RIM(R,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      LOGICAL :: RETURN_VALUE
      LOGICAL, EXTERNAL :: FMCOMP
      TYPE (IM) :: MA
      INTEGER :: KA,NDSAVE
      REAL :: R
      INTENT (IN) :: R,MA
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM
      CALL FM_UNDEF_INP(MA)
      NDSAVE = NDIG
      KA = MA%MIM%MP(2)
      NDIG = MAX(KA+NGRD52,NDIG)
      CALL FMSP2M(R,MTLVFM)
      CALL IMI2FM(MA%MIM,MULVFM)
      RETURN_VALUE = FMCOMP(MTLVFM,'EQ',MULVFM)
      NDIG = NDSAVE
   END FUNCTION FMLEQ_RIM

   FUNCTION FMLEQ_RZM(R,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      LOGICAL :: RETURN_VALUE,L1,L2
      LOGICAL, EXTERNAL :: FMCOMP
      TYPE (ZM) :: MA
      REAL :: R
      INTENT (IN) :: R,MA
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMSP2M(R,MTLVFM)
      CALL ZMREAL(MA%MZM,MULVFM)
      L1 = FMCOMP(MTLVFM,'EQ',MULVFM)
      CALL FMI2M(0,MTLVFM)
      CALL ZMIMAG(MA%MZM,MULVFM)
      L2 = FMCOMP(MTLVFM,'EQ',MULVFM)
      RETURN_VALUE = L1.AND.L2
   END FUNCTION FMLEQ_RZM

   FUNCTION FMLEQ_DFM(D,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      LOGICAL :: RETURN_VALUE
      LOGICAL, EXTERNAL :: FMCOMP
      TYPE (FM) :: MA
      DOUBLE PRECISION :: D
      INTENT (IN) :: D,MA
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMDP2M(D,MTLVFM)
      RETURN_VALUE = FMCOMP(MTLVFM,'EQ',MA%MFM)
   END FUNCTION FMLEQ_DFM

   FUNCTION FMLEQ_DIM(D,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      LOGICAL :: RETURN_VALUE
      LOGICAL, EXTERNAL :: FMCOMP
      TYPE (IM) :: MA
      DOUBLE PRECISION :: D
      INTEGER :: KA,NDSAVE
      INTENT (IN) :: D,MA
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM
      CALL FM_UNDEF_INP(MA)
      NDSAVE = NDIG
      KA = MA%MIM%MP(2)
      NDIG = MAX(KA+NGRD52,NDIG)
      CALL FMDP2M(D,MTLVFM)
      CALL IMI2FM(MA%MIM,MULVFM)
      RETURN_VALUE = FMCOMP(MTLVFM,'EQ',MULVFM)
      NDIG = NDSAVE
   END FUNCTION FMLEQ_DIM

   FUNCTION FMLEQ_DZM(D,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      LOGICAL :: RETURN_VALUE,L1,L2
      LOGICAL, EXTERNAL :: FMCOMP
      TYPE (ZM) :: MA
      DOUBLE PRECISION :: D
      INTENT (IN) :: D,MA
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMDP2M(D,MTLVFM)
      CALL ZMREAL(MA%MZM,MULVFM)
      L1 = FMCOMP(MTLVFM,'EQ',MULVFM)
      CALL FMI2M(0,MTLVFM)
      CALL ZMIMAG(MA%MZM,MULVFM)
      L2 = FMCOMP(MTLVFM,'EQ',MULVFM)
      RETURN_VALUE = L1.AND.L2
   END FUNCTION FMLEQ_DZM

   FUNCTION FMLEQ_ZFM(Z,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      LOGICAL :: RETURN_VALUE,L1,L2
      LOGICAL, EXTERNAL :: FMCOMP
      TYPE (FM) :: MA
      COMPLEX :: Z
      INTENT (IN) :: Z,MA
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMSP2M(REAL(Z),MTLVFM)
      L1 = FMCOMP(MTLVFM,'EQ',MA%MFM)
      L2 = .TRUE.
      IF (AIMAG(Z) /= 0.0) L2 = .FALSE.
      RETURN_VALUE = L1.AND.L2
   END FUNCTION FMLEQ_ZFM

   FUNCTION FMLEQ_ZIM(Z,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      LOGICAL :: RETURN_VALUE,L1,L2
      LOGICAL, EXTERNAL :: FMCOMP
      TYPE (IM) :: MA
      COMPLEX :: Z
      INTEGER :: KA,NDSAVE
      INTENT (IN) :: Z,MA
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM
      CALL FM_UNDEF_INP(MA)
      NDSAVE = NDIG
      KA = MA%MIM%MP(2)
      NDIG = MAX(KA+NGRD52,NDIG)
      CALL FMSP2M(REAL(Z),MTLVFM)
      CALL IMI2FM(MA%MIM,MULVFM)
      L1 = FMCOMP(MTLVFM,'EQ',MULVFM)
      NDIG = NDSAVE
      L2 = .TRUE.
      IF (AIMAG(Z) /= 0.0) L2 = .FALSE.
      RETURN_VALUE = L1.AND.L2
   END FUNCTION FMLEQ_ZIM

   FUNCTION FMLEQ_ZZM(Z,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      LOGICAL :: RETURN_VALUE,L1,L2
      LOGICAL, EXTERNAL :: FMCOMP
      TYPE (ZM) :: MA
      COMPLEX :: Z
      INTENT (IN) :: Z,MA
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL ZMZ2M(Z,MTLVZM)
      CALL ZMREAL(MTLVZM,MTLVFM)
      CALL ZMREAL(MA%MZM,MULVFM)
      L1 = FMCOMP(MTLVFM,'EQ',MULVFM)
      CALL ZMIMAG(MTLVZM,MTLVFM)
      CALL ZMIMAG(MA%MZM,MULVFM)
      L2 = FMCOMP(MTLVFM,'EQ',MULVFM)
      RETURN_VALUE = L1.AND.L2
   END FUNCTION FMLEQ_ZZM

   FUNCTION FMLEQ_CFM(C,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      LOGICAL :: RETURN_VALUE,L1,L2
      LOGICAL, EXTERNAL :: FMCOMP
      TYPE (FM) :: MA
      COMPLEX (KIND(0.0D0)) :: C
      INTENT (IN) :: C,MA
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMDP2M(REAL(C,KIND(0.0D0)),MTLVFM)
      L1 = FMCOMP(MTLVFM,'EQ',MA%MFM)
      L2 = .TRUE.
      IF (AIMAG(C) /= 0.0) L2 = .FALSE.
      RETURN_VALUE = L1.AND.L2
   END FUNCTION FMLEQ_CFM

   FUNCTION FMLEQ_CIM(C,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      LOGICAL :: RETURN_VALUE,L1,L2
      LOGICAL, EXTERNAL :: FMCOMP
      TYPE (IM) :: MA
      COMPLEX (KIND(0.0D0)) :: C
      INTEGER :: KA,NDSAVE
      INTENT (IN) :: C,MA
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM
      CALL FM_UNDEF_INP(MA)
      NDSAVE = NDIG
      KA = MA%MIM%MP(2)
      NDIG = MAX(KA+NGRD52,NDIG)
      CALL FMDP2M(REAL(C,KIND(0.0D0)),MTLVFM)
      CALL IMI2FM(MA%MIM,MULVFM)
      L1 = FMCOMP(MTLVFM,'EQ',MULVFM)
      NDIG = NDSAVE
      L2 = .TRUE.
      IF (AIMAG(C) /= 0.0) L2 = .FALSE.
      RETURN_VALUE = L1.AND.L2
   END FUNCTION FMLEQ_CIM

   FUNCTION FMLEQ_CZM(C,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      LOGICAL :: RETURN_VALUE,L1,L2
      LOGICAL, EXTERNAL :: FMCOMP
      TYPE (ZM) :: MA
      COMPLEX (KIND(0.0D0)) :: C
      INTENT (IN) :: C,MA
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMDP2M(REAL(C,KIND(0.0D0)),MTLVFM)
      CALL ZMREAL(MA%MZM,MULVFM)
      L1 = FMCOMP(MTLVFM,'EQ',MULVFM)
      CALL FMDP2M(AIMAG(C),MTLVFM)
      CALL ZMIMAG(MA%MZM,MULVFM)
      L2 = FMCOMP(MTLVFM,'EQ',MULVFM)
      RETURN_VALUE = L1.AND.L2
   END FUNCTION FMLEQ_CZM

   FUNCTION FMLEQ_FMI(MA,IVAL)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      LOGICAL :: RETURN_VALUE
      LOGICAL, EXTERNAL :: FMCOMP
      TYPE (FM) :: MA
      INTEGER :: IVAL
      INTENT (IN) :: MA,IVAL
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMI2M(IVAL,MTLVFM)
      RETURN_VALUE = FMCOMP(MA%MFM,'EQ',MTLVFM)
   END FUNCTION FMLEQ_FMI

   FUNCTION FMLEQ_FMR(MA,R)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      LOGICAL :: RETURN_VALUE
      LOGICAL, EXTERNAL :: FMCOMP
      TYPE (FM) :: MA
      REAL :: R
      INTENT (IN) :: MA,R
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMSP2M(R,MTLVFM)
      RETURN_VALUE = FMCOMP(MA%MFM,'EQ',MTLVFM)
   END FUNCTION FMLEQ_FMR

   FUNCTION FMLEQ_FMD(MA,D)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      LOGICAL :: RETURN_VALUE
      LOGICAL, EXTERNAL :: FMCOMP
      TYPE (FM) :: MA
      DOUBLE PRECISION :: D
      INTENT (IN) :: MA,D
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMDP2M(D,MTLVFM)
      RETURN_VALUE = FMCOMP(MA%MFM,'EQ',MTLVFM)
   END FUNCTION FMLEQ_FMD

   FUNCTION FMLEQ_FMZ(MA,Z)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      LOGICAL :: RETURN_VALUE,L1,L2
      LOGICAL, EXTERNAL :: FMCOMP
      TYPE (FM) :: MA
      COMPLEX :: Z
      INTENT (IN) :: MA,Z
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMSP2M(REAL(Z),MTLVFM)
      L1 = FMCOMP(MA%MFM,'EQ',MTLVFM)
      L2 = .TRUE.
      IF (AIMAG(Z) /= 0.0) L2 = .FALSE.
      RETURN_VALUE = L1.AND.L2
   END FUNCTION FMLEQ_FMZ

   FUNCTION FMLEQ_FMC(MA,C)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      LOGICAL :: RETURN_VALUE,L1,L2
      LOGICAL, EXTERNAL :: FMCOMP
      TYPE (FM) :: MA
      COMPLEX (KIND(0.0D0)) :: C
      INTENT (IN) :: MA,C
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMDP2M(REAL(C,KIND(0.0D0)),MTLVFM)
      L1 = FMCOMP(MA%MFM,'EQ',MTLVFM)
      L2 = .TRUE.
      IF (AIMAG(C) /= 0.0) L2 = .FALSE.
      RETURN_VALUE = L1.AND.L2
   END FUNCTION FMLEQ_FMC

   FUNCTION FMLEQ_FMFM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      LOGICAL :: RETURN_VALUE
      LOGICAL, EXTERNAL :: FMCOMP
      TYPE (FM) :: MA,MB
      INTENT (IN) :: MA,MB
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      RETURN_VALUE = FMCOMP(MA%MFM,'EQ',MB%MFM)
   END FUNCTION FMLEQ_FMFM

   FUNCTION FMLEQ_FMIM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      LOGICAL :: RETURN_VALUE
      LOGICAL, EXTERNAL :: FMCOMP
      TYPE (FM) :: MA
      TYPE (IM) :: MB
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      CALL FMINT(MA%MFM,MTLVFM)
      IF (FMCOMP(MA%MFM,'EQ',MTLVFM)) THEN
          CALL IMI2FM(MB%MIM,MTLVFM)
          RETURN_VALUE = FMCOMP(MA%MFM,'EQ',MTLVFM)
      ELSE
          RETURN_VALUE = .FALSE.
      ENDIF
   END FUNCTION FMLEQ_FMIM

   FUNCTION FMLEQ_FMZM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      LOGICAL :: RETURN_VALUE,L1,L2
      LOGICAL, EXTERNAL :: FMCOMP
      TYPE (FM) :: MA
      TYPE (ZM) :: MB
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      CALL ZMREAL(MB%MZM,MTLVFM)
      L1 = FMCOMP(MA%MFM,'EQ',MTLVFM)
      L2 = .TRUE.
      IF (MB%MZM(2)%MP(3) /= 0) L2 = .FALSE.
      RETURN_VALUE = L1.AND.L2
   END FUNCTION FMLEQ_FMZM

   FUNCTION FMLEQ_IMI(MA,IVAL)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      LOGICAL :: RETURN_VALUE
      LOGICAL, EXTERNAL :: IMCOMP
      TYPE (IM) :: MA
      INTEGER :: IVAL
      INTENT (IN) :: MA,IVAL
      TYPE(MULTI), SAVE :: MTLVIM
      CALL FM_UNDEF_INP(MA)
      CALL IMI2M(IVAL,MTLVIM)
      RETURN_VALUE = IMCOMP(MA%MIM,'EQ',MTLVIM)
   END FUNCTION FMLEQ_IMI

   FUNCTION FMLEQ_IMR(MA,R)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      LOGICAL :: RETURN_VALUE
      LOGICAL, EXTERNAL :: FMCOMP
      TYPE (IM) :: MA
      INTEGER :: KA,NDSAVE
      REAL :: R
      INTENT (IN) :: MA,R
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM
      CALL FM_UNDEF_INP(MA)
      NDSAVE = NDIG
      KA = MA%MIM%MP(2)
      NDIG = MAX(KA+NGRD52,NDIG)
      CALL FMSP2M(R,MTLVFM)
      CALL IMI2FM(MA%MIM,MULVFM)
      RETURN_VALUE = FMCOMP(MULVFM,'EQ',MTLVFM)
      NDIG = NDSAVE
   END FUNCTION FMLEQ_IMR

   FUNCTION FMLEQ_IMD(MA,D)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      LOGICAL :: RETURN_VALUE
      LOGICAL, EXTERNAL :: FMCOMP
      TYPE (IM) :: MA
      DOUBLE PRECISION :: D
      INTEGER :: KA,NDSAVE
      INTENT (IN) :: MA,D
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM
      CALL FM_UNDEF_INP(MA)
      NDSAVE = NDIG
      KA = MA%MIM%MP(2)
      NDIG = MAX(KA+NGRD52,NDIG)
      CALL FMDP2M(D,MTLVFM)
      CALL IMI2FM(MA%MIM,MULVFM)
      RETURN_VALUE = FMCOMP(MULVFM,'EQ',MTLVFM)
      NDIG = NDSAVE
   END FUNCTION FMLEQ_IMD

   FUNCTION FMLEQ_IMZ(MA,Z)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      LOGICAL :: RETURN_VALUE,L1,L2
      LOGICAL, EXTERNAL :: FMCOMP
      TYPE (IM) :: MA
      COMPLEX :: Z
      INTEGER :: KA,NDSAVE
      INTENT (IN) :: MA,Z
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM
      CALL FM_UNDEF_INP(MA)
      NDSAVE = NDIG
      KA = MA%MIM%MP(2)
      NDIG = MAX(KA+NGRD52,NDIG)
      CALL FMSP2M(REAL(Z),MTLVFM)
      CALL IMI2FM(MA%MIM,MULVFM)
      L1 = FMCOMP(MULVFM,'EQ',MTLVFM)
      NDIG = NDSAVE
      L2 = .TRUE.
      IF (AIMAG(Z) /= 0.0) L2 = .FALSE.
      RETURN_VALUE = L1.AND.L2
   END FUNCTION FMLEQ_IMZ

   FUNCTION FMLEQ_IMC(MA,C)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      LOGICAL :: RETURN_VALUE,L1,L2
      LOGICAL, EXTERNAL :: FMCOMP
      TYPE (IM) :: MA
      COMPLEX (KIND(0.0D0)) :: C
      INTEGER :: KA,NDSAVE
      INTENT (IN) :: MA,C
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM
      CALL FM_UNDEF_INP(MA)
      NDSAVE = NDIG
      KA = MA%MIM%MP(2)
      NDIG = MAX(KA+NGRD52,NDIG)
      CALL FMDP2M(REAL(C,KIND(0.0D0)),MTLVFM)
      CALL IMI2FM(MA%MIM,MULVFM)
      L1 = FMCOMP(MULVFM,'EQ',MTLVFM)
      NDIG = NDSAVE
      L2 = .TRUE.
      IF (AIMAG(C) /= 0.0) L2 = .FALSE.
      RETURN_VALUE = L1.AND.L2
   END FUNCTION FMLEQ_IMC

   FUNCTION FMLEQ_IMFM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      LOGICAL :: RETURN_VALUE
      LOGICAL, EXTERNAL :: FMCOMP
      TYPE (IM) :: MA
      TYPE (FM) :: MB
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      CALL FMINT(MB%MFM,MTLVFM)
      IF (FMCOMP(MB%MFM,'EQ',MTLVFM)) THEN
          CALL IMI2FM(MA%MIM,MTLVFM)
          RETURN_VALUE = FMCOMP(MB%MFM,'EQ',MTLVFM)
      ELSE
          RETURN_VALUE = .FALSE.
      ENDIF
   END FUNCTION FMLEQ_IMFM

   FUNCTION FMLEQ_IMIM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      LOGICAL :: RETURN_VALUE
      LOGICAL, EXTERNAL :: IMCOMP
      TYPE (IM) :: MA,MB
      INTENT (IN) :: MA,MB
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      RETURN_VALUE = IMCOMP(MA%MIM,'EQ',MB%MIM)
   END FUNCTION FMLEQ_IMIM

   FUNCTION FMLEQ_IMZM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      LOGICAL :: RETURN_VALUE
      LOGICAL, EXTERNAL :: FMCOMP
      TYPE (IM) :: MA
      TYPE (ZM) :: MB
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      CALL ZMREAL(MB%MZM,MTLVFM)
      CALL FMINT(MTLVFM,MULVFM)
      IF (FMCOMP(MULVFM,'EQ',MTLVFM).AND.MB%MZM(2)%MP(3) == 0) THEN
          CALL IMI2FM(MA%MIM,MULVFM)
          RETURN_VALUE = FMCOMP(MULVFM,'EQ',MTLVFM)
      ELSE
          RETURN_VALUE = .FALSE.
      ENDIF
   END FUNCTION FMLEQ_IMZM

   FUNCTION FMLEQ_ZMI(MA,IVAL)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      LOGICAL :: RETURN_VALUE
      LOGICAL, EXTERNAL :: FMCOMP
      TYPE (ZM) :: MA
      INTEGER :: IVAL
      INTENT (IN) :: MA,IVAL
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM
      CALL FM_UNDEF_INP(MA)
      CALL ZMREAL(MA%MZM,MTLVFM)
      CALL FMINT(MTLVFM,MULVFM)
      IF (FMCOMP(MULVFM,'EQ',MTLVFM).AND.MA%MZM(2)%MP(3) == 0) THEN
          CALL FMI2M(IVAL,MULVFM)
          RETURN_VALUE = FMCOMP(MTLVFM,'EQ',MULVFM)
      ELSE
          RETURN_VALUE = .FALSE.
      ENDIF
   END FUNCTION FMLEQ_ZMI

   FUNCTION FMLEQ_ZMR(MA,R)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      LOGICAL :: RETURN_VALUE,L1,L2
      LOGICAL, EXTERNAL :: FMCOMP
      TYPE (ZM) :: MA
      REAL :: R
      INTENT (IN) :: MA,R
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMSP2M(R,MTLVFM)
      CALL ZMREAL(MA%MZM,MULVFM)
      L1 = FMCOMP(MTLVFM,'EQ',MULVFM)
      CALL FMI2M(0,MTLVFM)
      CALL ZMIMAG(MA%MZM,MULVFM)
      L2 = FMCOMP(MTLVFM,'EQ',MULVFM)
      RETURN_VALUE = L1.AND.L2
   END FUNCTION FMLEQ_ZMR

   FUNCTION FMLEQ_ZMD(MA,D)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      LOGICAL :: RETURN_VALUE,L1,L2
      LOGICAL, EXTERNAL :: FMCOMP
      TYPE (ZM) :: MA
      DOUBLE PRECISION :: D
      INTENT (IN) :: MA,D
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMDP2M(D,MTLVFM)
      CALL ZMREAL(MA%MZM,MULVFM)
      L1 = FMCOMP(MTLVFM,'EQ',MULVFM)
      CALL FMI2M(0,MTLVFM)
      CALL ZMIMAG(MA%MZM,MULVFM)
      L2 = FMCOMP(MTLVFM,'EQ',MULVFM)
      RETURN_VALUE = L1.AND.L2
   END FUNCTION FMLEQ_ZMD

   FUNCTION FMLEQ_ZMZ(MA,Z)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      LOGICAL :: RETURN_VALUE,L1,L2
      LOGICAL, EXTERNAL :: FMCOMP
      TYPE (ZM) :: MA
      COMPLEX :: Z
      INTENT (IN) :: MA,Z
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL ZMZ2M(Z,MTLVZM)
      CALL ZMREAL(MTLVZM,MTLVFM)
      CALL ZMREAL(MA%MZM,MULVFM)
      L1 = FMCOMP(MTLVFM,'EQ',MULVFM)
      CALL ZMIMAG(MTLVZM,MTLVFM)
      CALL ZMIMAG(MA%MZM,MULVFM)
      L2 = FMCOMP(MTLVFM,'EQ',MULVFM)
      RETURN_VALUE = L1.AND.L2
   END FUNCTION FMLEQ_ZMZ

   FUNCTION FMLEQ_ZMC(MA,C)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      LOGICAL :: RETURN_VALUE,L1,L2
      LOGICAL, EXTERNAL :: FMCOMP
      TYPE (ZM) :: MA
      COMPLEX (KIND(0.0D0)) :: C
      INTENT (IN) :: MA,C
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMDP2M(REAL(C,KIND(0.0D0)),MTLVFM)
      CALL ZMREAL(MA%MZM,MULVFM)
      L1 = FMCOMP(MTLVFM,'EQ',MULVFM)
      CALL FMDP2M(AIMAG(C),MTLVFM)
      CALL ZMIMAG(MA%MZM,MULVFM)
      L2 = FMCOMP(MTLVFM,'EQ',MULVFM)
      RETURN_VALUE = L1.AND.L2
   END FUNCTION FMLEQ_ZMC

   FUNCTION FMLEQ_ZMFM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      LOGICAL :: RETURN_VALUE,L1,L2
      LOGICAL, EXTERNAL :: FMCOMP
      TYPE (FM) :: MB
      TYPE (ZM) :: MA
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      CALL ZMREAL(MA%MZM,MTLVFM)
      L1 = FMCOMP(MB%MFM,'EQ',MTLVFM)
      L2 = .TRUE.
      IF (MA%MZM(2)%MP(3) /= 0) L2 = .FALSE.
      RETURN_VALUE = L1.AND.L2
   END FUNCTION FMLEQ_ZMFM

   FUNCTION FMLEQ_ZMIM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      LOGICAL :: RETURN_VALUE
      LOGICAL, EXTERNAL :: FMCOMP
      TYPE (IM) :: MB
      TYPE (ZM) :: MA
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      CALL ZMREAL(MA%MZM,MTLVFM)
      CALL FMINT(MTLVFM,MULVFM)
      IF (FMCOMP(MULVFM,'EQ',MTLVFM).AND.MA%MZM(2)%MP(3) == 0) THEN
          CALL IMI2FM(MB%MIM,MULVFM)
          RETURN_VALUE = FMCOMP(MULVFM,'EQ',MTLVFM)
      ELSE
          RETURN_VALUE = .FALSE.
      ENDIF
   END FUNCTION FMLEQ_ZMIM

   FUNCTION FMLEQ_ZMZM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      LOGICAL :: RETURN_VALUE,L1,L2
      LOGICAL, EXTERNAL :: FMCOMP
      TYPE (ZM) :: MA,MB
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      CALL ZMREAL(MA%MZM,MTLVFM)
      CALL ZMREAL(MB%MZM,MULVFM)
      L1 = FMCOMP(MTLVFM,'EQ',MULVFM)
      CALL ZMIMAG(MA%MZM,MTLVFM)
      CALL ZMIMAG(MB%MZM,MULVFM)
      L2 = FMCOMP(MTLVFM,'EQ',MULVFM)
      RETURN_VALUE = L1.AND.L2
   END FUNCTION FMLEQ_ZMZM

 END MODULE ModLib_FMZM_2