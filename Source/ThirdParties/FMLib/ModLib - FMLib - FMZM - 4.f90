
 MODULE ModLib_FMZM_4
    USE ModLib_FMZM_1

    INTERFACE OPERATOR (+)
       MODULE PROCEDURE FMADD_IFM
       MODULE PROCEDURE FMADD_IIM
       MODULE PROCEDURE FMADD_IZM
       MODULE PROCEDURE FMADD_RFM
       MODULE PROCEDURE FMADD_RIM
       MODULE PROCEDURE FMADD_RZM
       MODULE PROCEDURE FMADD_DFM
       MODULE PROCEDURE FMADD_DIM
       MODULE PROCEDURE FMADD_DZM
       MODULE PROCEDURE FMADD_ZFM
       MODULE PROCEDURE FMADD_ZIM
       MODULE PROCEDURE FMADD_ZZM
       MODULE PROCEDURE FMADD_CFM
       MODULE PROCEDURE FMADD_CIM
       MODULE PROCEDURE FMADD_CZM
       MODULE PROCEDURE FMADD_FMI
       MODULE PROCEDURE FMADD_FMR
       MODULE PROCEDURE FMADD_FMD
       MODULE PROCEDURE FMADD_FMZ
       MODULE PROCEDURE FMADD_FMC
       MODULE PROCEDURE FMADD_FMFM
       MODULE PROCEDURE FMADD_FMIM
       MODULE PROCEDURE FMADD_FMZM
       MODULE PROCEDURE FMADD_IMI
       MODULE PROCEDURE FMADD_IMR
       MODULE PROCEDURE FMADD_IMD
       MODULE PROCEDURE FMADD_IMZ
       MODULE PROCEDURE FMADD_IMC
       MODULE PROCEDURE FMADD_IMFM
       MODULE PROCEDURE FMADD_IMIM
       MODULE PROCEDURE FMADD_IMZM
       MODULE PROCEDURE FMADD_ZMI
       MODULE PROCEDURE FMADD_ZMR
       MODULE PROCEDURE FMADD_ZMD
       MODULE PROCEDURE FMADD_ZMZ
       MODULE PROCEDURE FMADD_ZMC
       MODULE PROCEDURE FMADD_ZMFM
       MODULE PROCEDURE FMADD_ZMIM
       MODULE PROCEDURE FMADD_ZMZM
       MODULE PROCEDURE FMADD_FM
       MODULE PROCEDURE FMADD_IM
       MODULE PROCEDURE FMADD_ZM
       MODULE PROCEDURE FMADD_IFM1
       MODULE PROCEDURE FMADD_RFM1
       MODULE PROCEDURE FMADD_DFM1
       MODULE PROCEDURE FMADD_ZFM1
       MODULE PROCEDURE FMADD_CFM1
       MODULE PROCEDURE FMADD_FMI1
       MODULE PROCEDURE FMADD_FMR1
       MODULE PROCEDURE FMADD_FMD1
       MODULE PROCEDURE FMADD_FMZ1
       MODULE PROCEDURE FMADD_FMC1
       MODULE PROCEDURE FMADD_FMFM1
       MODULE PROCEDURE FMADD_IMFM1
       MODULE PROCEDURE FMADD_ZMFM1
       MODULE PROCEDURE FMADD_FMIM1
       MODULE PROCEDURE FMADD_FMZM1
       MODULE PROCEDURE FMADD_FM1I
       MODULE PROCEDURE FMADD_FM1R
       MODULE PROCEDURE FMADD_FM1D
       MODULE PROCEDURE FMADD_FM1Z
       MODULE PROCEDURE FMADD_FM1C
       MODULE PROCEDURE FMADD_I1FM
       MODULE PROCEDURE FMADD_R1FM
       MODULE PROCEDURE FMADD_D1FM
       MODULE PROCEDURE FMADD_Z1FM
       MODULE PROCEDURE FMADD_C1FM
       MODULE PROCEDURE FMADD_FM1FM
       MODULE PROCEDURE FMADD_FM1IM
       MODULE PROCEDURE FMADD_FM1ZM
       MODULE PROCEDURE FMADD_IM1FM
       MODULE PROCEDURE FMADD_ZM1FM
       MODULE PROCEDURE FMADD_I1FM1
       MODULE PROCEDURE FMADD_R1FM1
       MODULE PROCEDURE FMADD_D1FM1
       MODULE PROCEDURE FMADD_Z1FM1
       MODULE PROCEDURE FMADD_C1FM1
       MODULE PROCEDURE FMADD_FM1I1
       MODULE PROCEDURE FMADD_FM1R1
       MODULE PROCEDURE FMADD_FM1D1
       MODULE PROCEDURE FMADD_FM1Z1
       MODULE PROCEDURE FMADD_FM1C1
       MODULE PROCEDURE FMADD_FM1FM1
       MODULE PROCEDURE FMADD_IM1FM1
       MODULE PROCEDURE FMADD_ZM1FM1
       MODULE PROCEDURE FMADD_FM1IM1
       MODULE PROCEDURE FMADD_FM1ZM1
       MODULE PROCEDURE FMADD_IIM1
       MODULE PROCEDURE FMADD_RIM1
       MODULE PROCEDURE FMADD_DIM1
       MODULE PROCEDURE FMADD_ZIM1
       MODULE PROCEDURE FMADD_CIM1
       MODULE PROCEDURE FMADD_IMI1
       MODULE PROCEDURE FMADD_IMR1
       MODULE PROCEDURE FMADD_IMD1
       MODULE PROCEDURE FMADD_IMZ1
       MODULE PROCEDURE FMADD_IMC1
       MODULE PROCEDURE FMADD_IMIM1
       MODULE PROCEDURE FMADD_ZMIM1
       MODULE PROCEDURE FMADD_IMZM1
       MODULE PROCEDURE FMADD_IM1I
       MODULE PROCEDURE FMADD_IM1R
       MODULE PROCEDURE FMADD_IM1D
       MODULE PROCEDURE FMADD_IM1Z
       MODULE PROCEDURE FMADD_IM1C
       MODULE PROCEDURE FMADD_I1IM
       MODULE PROCEDURE FMADD_R1IM
       MODULE PROCEDURE FMADD_D1IM
       MODULE PROCEDURE FMADD_Z1IM
       MODULE PROCEDURE FMADD_C1IM
       MODULE PROCEDURE FMADD_IM1IM
       MODULE PROCEDURE FMADD_IM1ZM
       MODULE PROCEDURE FMADD_ZM1IM
       MODULE PROCEDURE FMADD_I1IM1
       MODULE PROCEDURE FMADD_R1IM1
       MODULE PROCEDURE FMADD_D1IM1
       MODULE PROCEDURE FMADD_Z1IM1
       MODULE PROCEDURE FMADD_C1IM1
       MODULE PROCEDURE FMADD_IM1I1
       MODULE PROCEDURE FMADD_IM1R1
       MODULE PROCEDURE FMADD_IM1D1
       MODULE PROCEDURE FMADD_IM1Z1
       MODULE PROCEDURE FMADD_IM1C1
       MODULE PROCEDURE FMADD_IM1IM1
       MODULE PROCEDURE FMADD_ZM1IM1
       MODULE PROCEDURE FMADD_IM1ZM1
       MODULE PROCEDURE FMADD_IZM1
       MODULE PROCEDURE FMADD_RZM1
       MODULE PROCEDURE FMADD_DZM1
       MODULE PROCEDURE FMADD_ZZM1
       MODULE PROCEDURE FMADD_CZM1
       MODULE PROCEDURE FMADD_ZMI1
       MODULE PROCEDURE FMADD_ZMR1
       MODULE PROCEDURE FMADD_ZMD1
       MODULE PROCEDURE FMADD_ZMZ1
       MODULE PROCEDURE FMADD_ZMC1
       MODULE PROCEDURE FMADD_ZMZM1
       MODULE PROCEDURE FMADD_ZM1I
       MODULE PROCEDURE FMADD_ZM1R
       MODULE PROCEDURE FMADD_ZM1D
       MODULE PROCEDURE FMADD_ZM1Z
       MODULE PROCEDURE FMADD_ZM1C
       MODULE PROCEDURE FMADD_I1ZM
       MODULE PROCEDURE FMADD_R1ZM
       MODULE PROCEDURE FMADD_D1ZM
       MODULE PROCEDURE FMADD_Z1ZM
       MODULE PROCEDURE FMADD_C1ZM
       MODULE PROCEDURE FMADD_ZM1ZM
       MODULE PROCEDURE FMADD_I1ZM1
       MODULE PROCEDURE FMADD_R1ZM1
       MODULE PROCEDURE FMADD_D1ZM1
       MODULE PROCEDURE FMADD_Z1ZM1
       MODULE PROCEDURE FMADD_C1ZM1
       MODULE PROCEDURE FMADD_ZM1I1
       MODULE PROCEDURE FMADD_ZM1R1
       MODULE PROCEDURE FMADD_ZM1D1
       MODULE PROCEDURE FMADD_ZM1Z1
       MODULE PROCEDURE FMADD_ZM1C1
       MODULE PROCEDURE FMADD_ZM1ZM1
       MODULE PROCEDURE FMADD_IFM2
       MODULE PROCEDURE FMADD_RFM2
       MODULE PROCEDURE FMADD_DFM2
       MODULE PROCEDURE FMADD_ZFM2
       MODULE PROCEDURE FMADD_CFM2
       MODULE PROCEDURE FMADD_FMI2
       MODULE PROCEDURE FMADD_FMR2
       MODULE PROCEDURE FMADD_FMD2
       MODULE PROCEDURE FMADD_FMZ2
       MODULE PROCEDURE FMADD_FMC2
       MODULE PROCEDURE FMADD_FMFM2
       MODULE PROCEDURE FMADD_IMFM2
       MODULE PROCEDURE FMADD_ZMFM2
       MODULE PROCEDURE FMADD_FMIM2
       MODULE PROCEDURE FMADD_FMZM2
       MODULE PROCEDURE FMADD_FM2I
       MODULE PROCEDURE FMADD_FM2R
       MODULE PROCEDURE FMADD_FM2D
       MODULE PROCEDURE FMADD_FM2Z
       MODULE PROCEDURE FMADD_FM2C
       MODULE PROCEDURE FMADD_I2FM
       MODULE PROCEDURE FMADD_R2FM
       MODULE PROCEDURE FMADD_D2FM
       MODULE PROCEDURE FMADD_Z2FM
       MODULE PROCEDURE FMADD_C2FM
       MODULE PROCEDURE FMADD_FM2FM
       MODULE PROCEDURE FMADD_FM2IM
       MODULE PROCEDURE FMADD_FM2ZM
       MODULE PROCEDURE FMADD_IM2FM
       MODULE PROCEDURE FMADD_ZM2FM
       MODULE PROCEDURE FMADD_I2FM2
       MODULE PROCEDURE FMADD_R2FM2
       MODULE PROCEDURE FMADD_D2FM2
       MODULE PROCEDURE FMADD_Z2FM2
       MODULE PROCEDURE FMADD_C2FM2
       MODULE PROCEDURE FMADD_FM2I2
       MODULE PROCEDURE FMADD_FM2R2
       MODULE PROCEDURE FMADD_FM2D2
       MODULE PROCEDURE FMADD_FM2Z2
       MODULE PROCEDURE FMADD_FM2C2
       MODULE PROCEDURE FMADD_FM2FM2
       MODULE PROCEDURE FMADD_IM2FM2
       MODULE PROCEDURE FMADD_ZM2FM2
       MODULE PROCEDURE FMADD_FM2IM2
       MODULE PROCEDURE FMADD_FM2ZM2
       MODULE PROCEDURE FMADD_IIM2
       MODULE PROCEDURE FMADD_RIM2
       MODULE PROCEDURE FMADD_DIM2
       MODULE PROCEDURE FMADD_ZIM2
       MODULE PROCEDURE FMADD_CIM2
       MODULE PROCEDURE FMADD_IMI2
       MODULE PROCEDURE FMADD_IMR2
       MODULE PROCEDURE FMADD_IMD2
       MODULE PROCEDURE FMADD_IMZ2
       MODULE PROCEDURE FMADD_IMC2
       MODULE PROCEDURE FMADD_IMIM2
       MODULE PROCEDURE FMADD_ZMIM2
       MODULE PROCEDURE FMADD_IMZM2
       MODULE PROCEDURE FMADD_IM2I
       MODULE PROCEDURE FMADD_IM2R
       MODULE PROCEDURE FMADD_IM2D
       MODULE PROCEDURE FMADD_IM2Z
       MODULE PROCEDURE FMADD_IM2C
       MODULE PROCEDURE FMADD_I2IM
       MODULE PROCEDURE FMADD_R2IM
       MODULE PROCEDURE FMADD_D2IM
       MODULE PROCEDURE FMADD_Z2IM
       MODULE PROCEDURE FMADD_C2IM
       MODULE PROCEDURE FMADD_IM2IM
       MODULE PROCEDURE FMADD_IM2ZM
       MODULE PROCEDURE FMADD_ZM2IM
       MODULE PROCEDURE FMADD_I2IM2
       MODULE PROCEDURE FMADD_R2IM2
       MODULE PROCEDURE FMADD_D2IM2
       MODULE PROCEDURE FMADD_Z2IM2
       MODULE PROCEDURE FMADD_C2IM2
       MODULE PROCEDURE FMADD_IM2I2
       MODULE PROCEDURE FMADD_IM2R2
       MODULE PROCEDURE FMADD_IM2D2
       MODULE PROCEDURE FMADD_IM2Z2
       MODULE PROCEDURE FMADD_IM2C2
       MODULE PROCEDURE FMADD_IM2IM2
       MODULE PROCEDURE FMADD_ZM2IM2
       MODULE PROCEDURE FMADD_IM2ZM2
       MODULE PROCEDURE FMADD_IZM2
       MODULE PROCEDURE FMADD_RZM2
       MODULE PROCEDURE FMADD_DZM2
       MODULE PROCEDURE FMADD_ZZM2
       MODULE PROCEDURE FMADD_CZM2
       MODULE PROCEDURE FMADD_ZMI2
       MODULE PROCEDURE FMADD_ZMR2
       MODULE PROCEDURE FMADD_ZMD2
       MODULE PROCEDURE FMADD_ZMZ2
       MODULE PROCEDURE FMADD_ZMC2
       MODULE PROCEDURE FMADD_ZMZM2
       MODULE PROCEDURE FMADD_ZM2I
       MODULE PROCEDURE FMADD_ZM2R
       MODULE PROCEDURE FMADD_ZM2D
       MODULE PROCEDURE FMADD_ZM2Z
       MODULE PROCEDURE FMADD_ZM2C
       MODULE PROCEDURE FMADD_I2ZM
       MODULE PROCEDURE FMADD_R2ZM
       MODULE PROCEDURE FMADD_D2ZM
       MODULE PROCEDURE FMADD_Z2ZM
       MODULE PROCEDURE FMADD_C2ZM
       MODULE PROCEDURE FMADD_ZM2ZM
       MODULE PROCEDURE FMADD_I2ZM2
       MODULE PROCEDURE FMADD_R2ZM2
       MODULE PROCEDURE FMADD_D2ZM2
       MODULE PROCEDURE FMADD_Z2ZM2
       MODULE PROCEDURE FMADD_C2ZM2
       MODULE PROCEDURE FMADD_ZM2I2
       MODULE PROCEDURE FMADD_ZM2R2
       MODULE PROCEDURE FMADD_ZM2D2
       MODULE PROCEDURE FMADD_ZM2Z2
       MODULE PROCEDURE FMADD_ZM2C2
       MODULE PROCEDURE FMADD_ZM2ZM2
       MODULE PROCEDURE FMADD_FM1
       MODULE PROCEDURE FMADD_IM1
       MODULE PROCEDURE FMADD_ZM1
       MODULE PROCEDURE FMADD_FM2
       MODULE PROCEDURE FMADD_IM2
       MODULE PROCEDURE FMADD_ZM2
    END INTERFACE

 CONTAINS

!                                                                   +

   FUNCTION FMADD_IFM(IVAL,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA,RETURN_VALUE
      INTEGER :: IVAL
      INTENT (IN) :: IVAL,MA
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMI2M(IVAL,MTLVFM)
      CALL FMADD(MTLVFM,MA%MFM,RETURN_VALUE%MFM)
   END FUNCTION FMADD_IFM

   FUNCTION FMADD_IIM(IVAL,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA,RETURN_VALUE
      INTEGER :: IVAL
      INTENT (IN) :: IVAL,MA
      TYPE(MULTI), SAVE :: MTLVIM
      CALL FM_UNDEF_INP(MA)
      CALL IMI2M(IVAL,MTLVIM)
      CALL IMADD(MTLVIM,MA%MIM,RETURN_VALUE%MIM)
   END FUNCTION FMADD_IIM

   FUNCTION FMADD_IZM(IVAL,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA,RETURN_VALUE
      INTEGER :: IVAL
      INTENT (IN) :: IVAL,MA
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FMI2M(IVAL,MTLVFM)
      CALL FMI2M(0,MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
      CALL ZMADD(MTLVZM,MA%MZM,RETURN_VALUE%MZM)
   END FUNCTION FMADD_IZM

   FUNCTION FMADD_RFM(R,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA,RETURN_VALUE
      REAL :: R
      INTENT (IN) :: R,MA
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMSP2M(R,MTLVFM)
      CALL FMADD(MTLVFM,MA%MFM,RETURN_VALUE%MFM)
   END FUNCTION FMADD_RFM

   FUNCTION FMADD_RIM(R,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: RETURN_VALUE
      TYPE (IM) :: MA
      REAL :: R
      INTENT (IN) :: R,MA
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMSP2M(R,MTLVFM)
      CALL IMI2FM(MA%MIM,MULVFM)
      CALL FMADD(MTLVFM,MULVFM,RETURN_VALUE%MFM)
   END FUNCTION FMADD_RIM

   FUNCTION FMADD_RZM(R,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA,RETURN_VALUE
      REAL :: R
      INTENT (IN) :: R,MA
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FMSP2M(R,MTLVFM)
      CALL FMI2M(0,MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
      CALL ZMADD(MTLVZM,MA%MZM,RETURN_VALUE%MZM)
   END FUNCTION FMADD_RZM

   FUNCTION FMADD_DFM(D,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA,RETURN_VALUE
      DOUBLE PRECISION :: D
      INTENT (IN) :: D,MA
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMDP2M(D,MTLVFM)
      CALL FMADD(MTLVFM,MA%MFM,RETURN_VALUE%MFM)
   END FUNCTION FMADD_DFM

   FUNCTION FMADD_DIM(D,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: RETURN_VALUE
      TYPE (IM) :: MA
      DOUBLE PRECISION :: D
      INTENT (IN) :: D,MA
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMDP2M(D,MTLVFM)
      CALL IMI2FM(MA%MIM,MULVFM)
      CALL FMADD(MTLVFM,MULVFM,RETURN_VALUE%MFM)
   END FUNCTION FMADD_DIM

   FUNCTION FMADD_DZM(D,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA,RETURN_VALUE
      DOUBLE PRECISION :: D
      INTENT (IN) :: D,MA
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FMDP2M(D,MTLVFM)
      CALL FMI2M(0,MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
      CALL ZMADD(MTLVZM,MA%MZM,RETURN_VALUE%MZM)
   END FUNCTION FMADD_DZM

   FUNCTION FMADD_ZFM(Z,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: RETURN_VALUE
      TYPE (FM) :: MA
      COMPLEX :: Z
      INTENT (IN) :: Z,MA
      TYPE(MULTI), SAVE :: MULVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL ZMZ2M(Z,MTLVZM)
      CALL FMI2M(0,MULVFM)
      CALL ZMCMPX(MA%MFM,MULVFM,MULVZM)
      CALL ZMADD(MTLVZM,MULVZM,RETURN_VALUE%MZM)
   END FUNCTION FMADD_ZFM

   FUNCTION FMADD_ZIM(Z,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: RETURN_VALUE
      TYPE (IM) :: MA
      COMPLEX :: Z
      INTENT (IN) :: Z,MA
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL ZMZ2M(Z,MTLVZM)
      CALL IMI2FM(MA%MIM,MTLVFM)
      CALL FMI2M(0,MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MULVZM)
      CALL ZMADD(MTLVZM,MULVZM,RETURN_VALUE%MZM)
   END FUNCTION FMADD_ZIM

   FUNCTION FMADD_ZZM(Z,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA,RETURN_VALUE
      COMPLEX :: Z
      INTENT (IN) :: Z,MA
      TYPE(MULTI), SAVE :: MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL ZMZ2M(Z,MTLVZM)
      CALL ZMADD(MTLVZM,MA%MZM,RETURN_VALUE%MZM)
   END FUNCTION FMADD_ZZM

   FUNCTION FMADD_CFM(C,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: RETURN_VALUE
      TYPE (FM) :: MA
      COMPLEX (KIND(0.0D0)) :: C
      INTENT (IN) :: C,MA
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FMDP2M(REAL(C,KIND(0.0D0)),MTLVFM)
      CALL FMDP2M(AIMAG(C),MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
      CALL FMI2M(0,MULVFM)
      CALL ZMCMPX(MA%MFM,MULVFM,MULVZM)
      CALL ZMADD(MTLVZM,MULVZM,RETURN_VALUE%MZM)
   END FUNCTION FMADD_CFM

   FUNCTION FMADD_CIM(C,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: RETURN_VALUE
      TYPE (IM) :: MA
      COMPLEX (KIND(0.0D0)) :: C
      INTENT (IN) :: C,MA
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FMDP2M(REAL(C,KIND(0.0D0)),MTLVFM)
      CALL FMDP2M(AIMAG(C),MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
      CALL IMI2FM(MA%MIM,MTLVFM)
      CALL FMI2M(0,MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MULVZM)
      CALL ZMADD(MTLVZM,MULVZM,RETURN_VALUE%MZM)
   END FUNCTION FMADD_CIM

   FUNCTION FMADD_CZM(C,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA,RETURN_VALUE
      COMPLEX (KIND(0.0D0)) :: C
      INTENT (IN) :: C,MA
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FMDP2M(REAL(C,KIND(0.0D0)),MTLVFM)
      CALL FMDP2M(AIMAG(C),MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
      CALL ZMADD(MTLVZM,MA%MZM,RETURN_VALUE%MZM)
   END FUNCTION FMADD_CZM

   FUNCTION FMADD_FMI(MA,IVAL)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA,RETURN_VALUE
      INTEGER :: IVAL
      INTENT (IN) :: MA,IVAL
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMI2M(IVAL,MTLVFM)
      CALL FMADD(MA%MFM,MTLVFM,RETURN_VALUE%MFM)
   END FUNCTION FMADD_FMI

   FUNCTION FMADD_FMR(MA,R)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA,RETURN_VALUE
      REAL :: R
      INTENT (IN) :: MA,R
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMSP2M(R,MTLVFM)
      CALL FMADD(MA%MFM,MTLVFM,RETURN_VALUE%MFM)
   END FUNCTION FMADD_FMR

   FUNCTION FMADD_FMD(MA,D)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA,RETURN_VALUE
      DOUBLE PRECISION :: D
      INTENT (IN) :: MA,D
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMDP2M(D,MTLVFM)
      CALL FMADD(MA%MFM,MTLVFM,RETURN_VALUE%MFM)
   END FUNCTION FMADD_FMD

   FUNCTION FMADD_FMZ(MA,Z)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: RETURN_VALUE
      TYPE (FM) :: MA
      COMPLEX :: Z
      INTENT (IN) :: MA,Z
      TYPE(MULTI), SAVE :: MULVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL ZMZ2M(Z,MTLVZM)
      CALL FMI2M(0,MULVFM)
      CALL ZMCMPX(MA%MFM,MULVFM,MULVZM)
      CALL ZMADD(MULVZM,MTLVZM,RETURN_VALUE%MZM)
   END FUNCTION FMADD_FMZ

   FUNCTION FMADD_FMC(MA,C)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: RETURN_VALUE
      TYPE (FM) :: MA
      COMPLEX (KIND(0.0D0)) :: C
      INTENT (IN) :: MA,C
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FMDP2M(REAL(C,KIND(0.0D0)),MTLVFM)
      CALL FMDP2M(AIMAG(C),MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
      CALL FMI2M(0,MULVFM)
      CALL ZMCMPX(MA%MFM,MULVFM,MULVZM)
      CALL ZMADD(MULVZM,MTLVZM,RETURN_VALUE%MZM)
   END FUNCTION FMADD_FMC

   FUNCTION FMADD_FMFM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA,MB,RETURN_VALUE
      INTENT (IN) :: MA,MB
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      CALL FMADD(MA%MFM,MB%MFM,RETURN_VALUE%MFM)
   END FUNCTION FMADD_FMFM

   FUNCTION FMADD_FMIM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA,RETURN_VALUE
      TYPE (IM) :: MB
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      CALL IMI2FM(MB%MIM,MTLVFM)
      CALL FMADD(MA%MFM,MTLVFM,RETURN_VALUE%MFM)
   END FUNCTION FMADD_FMIM

   FUNCTION FMADD_FMZM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA
      TYPE (ZM) :: MB,RETURN_VALUE
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      CALL FMI2M(0,MTLVFM)
      CALL ZMCMPX(MA%MFM,MTLVFM,MTLVZM)
      CALL ZMADD(MTLVZM,MB%MZM,RETURN_VALUE%MZM)
   END FUNCTION FMADD_FMZM

   FUNCTION FMADD_IMI(MA,IVAL)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA,RETURN_VALUE
      INTEGER :: IVAL
      INTENT (IN) :: MA,IVAL
      TYPE(MULTI), SAVE :: MTLVIM
      CALL FM_UNDEF_INP(MA)
      CALL IMI2M(IVAL,MTLVIM)
      CALL IMADD(MA%MIM,MTLVIM,RETURN_VALUE%MIM)
   END FUNCTION FMADD_IMI

   FUNCTION FMADD_IMR(MA,R)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: RETURN_VALUE
      TYPE (IM) :: MA
      REAL :: R
      INTENT (IN) :: MA,R
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMSP2M(R,MTLVFM)
      CALL IMI2FM(MA%MIM,MULVFM)
      CALL FMADD(MULVFM,MTLVFM,RETURN_VALUE%MFM)
   END FUNCTION FMADD_IMR

   FUNCTION FMADD_IMD(MA,D)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: RETURN_VALUE
      TYPE (IM) :: MA
      DOUBLE PRECISION :: D
      INTENT (IN) :: MA,D
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMDP2M(D,MTLVFM)
      CALL IMI2FM(MA%MIM,MULVFM)
      CALL FMADD(MULVFM,MTLVFM,RETURN_VALUE%MFM)
   END FUNCTION FMADD_IMD

   FUNCTION FMADD_IMZ(MA,Z)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: RETURN_VALUE
      TYPE (IM) :: MA
      COMPLEX :: Z
      INTENT (IN) :: MA,Z
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL ZMZ2M(Z,MTLVZM)
      CALL IMI2FM(MA%MIM,MTLVFM)
      CALL FMI2M(0,MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MULVZM)
      CALL ZMADD(MULVZM,MTLVZM,RETURN_VALUE%MZM)
   END FUNCTION FMADD_IMZ

   FUNCTION FMADD_IMC(MA,C)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: RETURN_VALUE
      TYPE (IM) :: MA
      COMPLEX (KIND(0.0D0)) :: C
      INTENT (IN) :: MA,C
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FMDP2M(REAL(C,KIND(0.0D0)),MTLVFM)
      CALL FMDP2M(AIMAG(C),MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
      CALL IMI2FM(MA%MIM,MTLVFM)
      CALL FMI2M(0,MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MULVZM)
      CALL ZMADD(MULVZM,MTLVZM,RETURN_VALUE%MZM)
   END FUNCTION FMADD_IMC

   FUNCTION FMADD_IMFM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA
      TYPE (FM) :: MB,RETURN_VALUE
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      CALL IMI2FM(MA%MIM,MTLVFM)
      CALL FMADD(MTLVFM,MB%MFM,RETURN_VALUE%MFM)
   END FUNCTION FMADD_IMFM

   FUNCTION FMADD_IMIM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA,MB,RETURN_VALUE
      INTENT (IN) :: MA,MB
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      CALL IMADD(MA%MIM,MB%MIM,RETURN_VALUE%MIM)
   END FUNCTION FMADD_IMIM

   FUNCTION FMADD_IMZM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA
      TYPE (ZM) :: MB,RETURN_VALUE
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      CALL IMI2FM(MA%MIM,MTLVFM)
      CALL FMI2M(0,MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MULVZM)
      CALL ZMADD(MULVZM,MB%MZM,RETURN_VALUE%MZM)
   END FUNCTION FMADD_IMZM

   FUNCTION FMADD_ZMI(MA,IVAL)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA,RETURN_VALUE
      INTEGER :: IVAL
      INTENT (IN) :: MA,IVAL
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FMI2M(IVAL,MTLVFM)
      CALL FMI2M(0,MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
      CALL ZMADD(MA%MZM,MTLVZM,RETURN_VALUE%MZM)
   END FUNCTION FMADD_ZMI

   FUNCTION FMADD_ZMR(MA,R)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA,RETURN_VALUE
      REAL :: R
      INTENT (IN) :: MA,R
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FMSP2M(R,MTLVFM)
      CALL FMI2M(0,MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
      CALL ZMADD(MA%MZM,MTLVZM,RETURN_VALUE%MZM)
   END FUNCTION FMADD_ZMR

   FUNCTION FMADD_ZMD(MA,D)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA,RETURN_VALUE
      DOUBLE PRECISION :: D
      INTENT (IN) :: MA,D
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FMDP2M(D,MTLVFM)
      CALL FMI2M(0,MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
      CALL ZMADD(MA%MZM,MTLVZM,RETURN_VALUE%MZM)
   END FUNCTION FMADD_ZMD

   FUNCTION FMADD_ZMZ(MA,Z)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA,RETURN_VALUE
      COMPLEX :: Z
      INTENT (IN) :: MA,Z
      TYPE(MULTI), SAVE :: MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL ZMZ2M(Z,MTLVZM)
      CALL ZMADD(MA%MZM,MTLVZM,RETURN_VALUE%MZM)
   END FUNCTION FMADD_ZMZ

   FUNCTION FMADD_ZMC(MA,C)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA,RETURN_VALUE
      COMPLEX (KIND(0.0D0)) :: C
      INTENT (IN) :: MA,C
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FMDP2M(REAL(C,KIND(0.0D0)),MTLVFM)
      CALL FMDP2M(AIMAG(C),MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
      CALL ZMADD(MA%MZM,MTLVZM,RETURN_VALUE%MZM)
   END FUNCTION FMADD_ZMC

   FUNCTION FMADD_ZMFM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MB
      TYPE (ZM) :: MA,RETURN_VALUE
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      CALL FMI2M(0,MTLVFM)
      CALL ZMCMPX(MB%MFM,MTLVFM,MTLVZM)
      CALL ZMADD(MA%MZM,MTLVZM,RETURN_VALUE%MZM)
   END FUNCTION FMADD_ZMFM

   FUNCTION FMADD_ZMIM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MB
      TYPE (ZM) :: MA,RETURN_VALUE
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      CALL IMI2FM(MB%MIM,MTLVFM)
      CALL FMI2M(0,MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MULVZM)
      CALL ZMADD(MA%MZM,MULVZM,RETURN_VALUE%MZM)
   END FUNCTION FMADD_ZMIM

   FUNCTION FMADD_ZMZM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA,MB,RETURN_VALUE
      INTENT (IN) :: MA,MB
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      CALL ZMADD(MA%MZM,MB%MZM,RETURN_VALUE%MZM)
   END FUNCTION FMADD_ZMZM

   FUNCTION FMADD_FM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA,RETURN_VALUE
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL FMEQ(MA%MFM,RETURN_VALUE%MFM)
   END FUNCTION FMADD_FM

   FUNCTION FMADD_IM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA,RETURN_VALUE
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL IMEQ(MA%MIM,RETURN_VALUE%MIM)
   END FUNCTION FMADD_IM

   FUNCTION FMADD_ZM(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA,RETURN_VALUE
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      CALL ZMEQ(MA%MZM,RETURN_VALUE%MZM)
   END FUNCTION FMADD_ZM

!             Array addition operations for FM.

!             (1) rank 0  +  rank 1

   FUNCTION FMADD_IFM1(IVAL,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: IVAL,J,N
      INTENT (IN) :: MA,IVAL
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      CALL FMI2M(IVAL,MTLVFM)
      DO J = 1, N
         CALL FMADD(MTLVFM,MA(J)%MFM,RETURN_VALUE(J)%MFM)
      ENDDO
   END FUNCTION FMADD_IFM1

   FUNCTION FMADD_RFM1(R,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      REAL :: R
      INTENT (IN) :: MA,R
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      CALL FMSP2M(R,MTLVFM)
      DO J = 1, N
         CALL FMADD(MTLVFM,MA(J)%MFM,RETURN_VALUE(J)%MFM)
      ENDDO
   END FUNCTION FMADD_RFM1

   FUNCTION FMADD_DFM1(D,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      DOUBLE PRECISION :: D
      INTENT (IN) :: MA,D
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      CALL FMDP2M(D,MTLVFM)
      DO J = 1, N
         CALL FMADD(MTLVFM,MA(J)%MFM,RETURN_VALUE(J)%MFM)
      ENDDO
   END FUNCTION FMADD_DFM1

   FUNCTION FMADD_ZFM1(Z,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      COMPLEX :: Z
      INTENT (IN) :: MA,Z
      TYPE(MULTI), SAVE :: MULVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      CALL ZMZ2M(Z,MTLVZM)
      CALL FMI2M(0,MULVFM)
      DO J = 1, N
         CALL ZMCMPX(MA(J)%MFM,MULVFM,MULVZM)
         CALL ZMADD(MTLVZM,MULVZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_ZFM1

   FUNCTION FMADD_CFM1(C,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      COMPLEX (KIND(0.0D0)) :: C
      INTENT (IN) :: MA,C
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      CALL FMDP2M(REAL(C,KIND(0.0D0)),MTLVFM)
      CALL FMDP2M(AIMAG(C),MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
      CALL FMI2M(0,MULVFM)
      DO J = 1, N
         CALL ZMCMPX(MA(J)%MFM,MULVFM,MULVZM)
         CALL ZMADD(MTLVZM,MULVZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_CFM1

   FUNCTION FMADD_FMI1(MA,IVAL)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA
      INTEGER, DIMENSION(:) :: IVAL
      TYPE (FM), DIMENSION(SIZE(IVAL)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,IVAL
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      N = SIZE(IVAL)
      DO J = 1, N
         CALL FMI2M(IVAL(J),MTLVFM)
         CALL FMADD(MA%MFM,MTLVFM,RETURN_VALUE(J)%MFM)
      ENDDO
   END FUNCTION FMADD_FMI1

   FUNCTION FMADD_FMR1(MA,R)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA
      REAL, DIMENSION(:) :: R
      TYPE (FM), DIMENSION(SIZE(R)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,R
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      N = SIZE(R)
      DO J = 1, N
         CALL FMSP2M(R(J),MTLVFM)
         CALL FMADD(MA%MFM,MTLVFM,RETURN_VALUE(J)%MFM)
      ENDDO
   END FUNCTION FMADD_FMR1

   FUNCTION FMADD_FMD1(MA,D)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA
      DOUBLE PRECISION, DIMENSION(:) :: D
      TYPE (FM), DIMENSION(SIZE(D)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,D
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      N = SIZE(D)
      DO J = 1, N
         CALL FMDP2M(D(J),MTLVFM)
         CALL FMADD(MA%MFM,MTLVFM,RETURN_VALUE(J)%MFM)
      ENDDO
   END FUNCTION FMADD_FMD1

   FUNCTION FMADD_FMZ1(MA,Z)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA
      COMPLEX, DIMENSION(:) :: Z
      TYPE (ZM), DIMENSION(SIZE(Z)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,Z
      TYPE(MULTI), SAVE :: MULVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      N = SIZE(Z)
      CALL FMI2M(0,MULVFM)
      DO J = 1, N
         CALL ZMZ2M(Z(J),MTLVZM)
         CALL ZMCMPX(MA%MFM,MULVFM,MULVZM)
         CALL ZMADD(MULVZM,MTLVZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_FMZ1

   FUNCTION FMADD_FMC1(MA,C)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA
      COMPLEX (KIND(0.0D0)), DIMENSION(:) :: C
      TYPE (ZM), DIMENSION(SIZE(C)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,C
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      N = SIZE(C)
      DO J = 1, N
         CALL FMDP2M(REAL(C(J),KIND(0.0D0)),MTLVFM)
         CALL FMDP2M(AIMAG(C(J)),MULVFM)
         CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
         CALL FMI2M(0,MULVFM)
         CALL ZMCMPX(MA%MFM,MULVFM,MULVZM)
         CALL ZMADD(MULVZM,MTLVZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_FMC1

   FUNCTION FMADD_FMFM1(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA
      TYPE (FM), DIMENSION(:) :: MB
      TYPE (FM), DIMENSION(SIZE(MB)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,MB
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      N = SIZE(MB)
      DO J = 1, N
         CALL FMADD(MA%MFM,MB(J)%MFM,RETURN_VALUE(J)%MFM)
      ENDDO
   END FUNCTION FMADD_FMFM1

   FUNCTION FMADD_IMFM1(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA
      TYPE (FM), DIMENSION(:) :: MB
      TYPE (FM), DIMENSION(SIZE(MB)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      N = SIZE(MB)
      CALL IMI2FM(MA%MIM,MTLVFM)
      DO J = 1, N
         CALL FMADD(MTLVFM,MB(J)%MFM,RETURN_VALUE(J)%MFM)
      ENDDO
   END FUNCTION FMADD_IMFM1

   FUNCTION FMADD_ZMFM1(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA
      TYPE (FM), DIMENSION(:) :: MB
      TYPE (ZM), DIMENSION(SIZE(MB)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      N = SIZE(MB)
      CALL FMI2M(0,MTLVFM)
      DO J = 1, N    
         CALL ZMCMPX(MB(J)%MFM,MTLVFM,MTLVZM)
         CALL ZMADD(MA%MZM,MTLVZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_ZMFM1

   FUNCTION FMADD_FMIM1(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA
      TYPE (IM), DIMENSION(:) :: MB
      TYPE (FM), DIMENSION(SIZE(MB)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      N = SIZE(MB)
      DO J = 1, N
         CALL IMI2FM(MB(J)%MIM,MTLVFM)
         CALL FMADD(MA%MFM,MTLVFM,RETURN_VALUE(J)%MFM)
      ENDDO
   END FUNCTION FMADD_FMIM1

   FUNCTION FMADD_FMZM1(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA
      TYPE (ZM), DIMENSION(:) :: MB
      TYPE (ZM), DIMENSION(SIZE(MB)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      N = SIZE(MB)
      CALL FMI2M(0,MTLVFM)
      CALL ZMCMPX(MA%MFM,MTLVFM,MTLVZM)
      DO J = 1, N
         CALL ZMADD(MTLVZM,MB(J)%MZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_FMZM1

!             (2) rank 1  +  rank 0

   FUNCTION FMADD_FM1I(MA,IVAL)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: IVAL,J,N
      INTENT (IN) :: MA,IVAL
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      CALL FMI2M(IVAL,MTLVFM)
      DO J = 1, N
         CALL FMADD(MA(J)%MFM,MTLVFM,RETURN_VALUE(J)%MFM)
      ENDDO
   END FUNCTION FMADD_FM1I

   FUNCTION FMADD_FM1R(MA,R)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      REAL :: R
      INTENT (IN) :: MA,R
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      CALL FMSP2M(R,MTLVFM)
      DO J = 1, N
         CALL FMADD(MA(J)%MFM,MTLVFM,RETURN_VALUE(J)%MFM)
      ENDDO
   END FUNCTION FMADD_FM1R

   FUNCTION FMADD_FM1D(MA,D)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      DOUBLE PRECISION :: D
      INTENT (IN) :: MA,D
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      CALL FMDP2M(D,MTLVFM)
      DO J = 1, N
         CALL FMADD(MA(J)%MFM,MTLVFM,RETURN_VALUE(J)%MFM)
      ENDDO
   END FUNCTION FMADD_FM1D

   FUNCTION FMADD_FM1Z(MA,Z)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      COMPLEX :: Z
      INTENT (IN) :: MA,Z
      TYPE(MULTI), SAVE :: MULVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      CALL ZMZ2M(Z,MTLVZM)
      CALL FMI2M(0,MULVFM)
      DO J = 1, N
         CALL ZMCMPX(MA(J)%MFM,MULVFM,MULVZM)
         CALL ZMADD(MULVZM,MTLVZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_FM1Z

   FUNCTION FMADD_FM1C(MA,C)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      COMPLEX (KIND(0.0D0)) :: C
      INTENT (IN) :: MA,C
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      CALL FMDP2M(REAL(C,KIND(0.0D0)),MTLVFM)
      CALL FMDP2M(AIMAG(C),MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
      CALL FMI2M(0,MULVFM)
      DO J = 1, N
         CALL ZMCMPX(MA(J)%MFM,MULVFM,MULVZM)
         CALL ZMADD(MULVZM,MTLVZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_FM1C

   FUNCTION FMADD_I1FM(IVAL,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA
      INTEGER, DIMENSION(:) :: IVAL
      TYPE (FM), DIMENSION(SIZE(IVAL)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,IVAL
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      N = SIZE(IVAL)
      DO J = 1, N
         CALL FMI2M(IVAL(J),MTLVFM)
         CALL FMADD(MTLVFM,MA%MFM,RETURN_VALUE(J)%MFM)
      ENDDO
   END FUNCTION FMADD_I1FM

   FUNCTION FMADD_R1FM(R,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA
      REAL, DIMENSION(:) :: R
      TYPE (FM), DIMENSION(SIZE(R)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,R
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      N = SIZE(R)
      DO J = 1, N
         CALL FMSP2M(R(J),MTLVFM)
         CALL FMADD(MTLVFM,MA%MFM,RETURN_VALUE(J)%MFM)
      ENDDO
   END FUNCTION FMADD_R1FM

   FUNCTION FMADD_D1FM(D,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA
      DOUBLE PRECISION, DIMENSION(:) :: D
      TYPE (FM), DIMENSION(SIZE(D)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,D
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      N = SIZE(D)
      DO J = 1, N
         CALL FMDP2M(D(J),MTLVFM)
         CALL FMADD(MTLVFM,MA%MFM,RETURN_VALUE(J)%MFM)
      ENDDO
   END FUNCTION FMADD_D1FM

   FUNCTION FMADD_Z1FM(Z,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA
      COMPLEX, DIMENSION(:) :: Z
      TYPE (ZM), DIMENSION(SIZE(Z)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,Z
      TYPE(MULTI), SAVE :: MULVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      N = SIZE(Z)
      CALL FMI2M(0,MULVFM)
      DO J = 1, N
         CALL ZMZ2M(Z(J),MTLVZM)
         CALL ZMCMPX(MA%MFM,MULVFM,MULVZM)
         CALL ZMADD(MTLVZM,MULVZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_Z1FM

   FUNCTION FMADD_C1FM(C,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA
      COMPLEX (KIND(0.0D0)), DIMENSION(:) :: C
      TYPE (ZM), DIMENSION(SIZE(C)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,C
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      N = SIZE(C)
      DO J = 1, N
         CALL FMDP2M(REAL(C(J),KIND(0.0D0)),MTLVFM)
         CALL FMDP2M(AIMAG(C(J)),MULVFM)
         CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
         CALL FMI2M(0,MULVFM)
         CALL ZMCMPX(MA%MFM,MULVFM,MULVZM)
         CALL ZMADD(MTLVZM,MULVZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_C1FM

   FUNCTION FMADD_FM1FM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      TYPE (FM) :: MB
      TYPE (FM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,MB
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      N = SIZE(MA)
      DO J = 1, N
         CALL FMADD(MA(J)%MFM,MB%MFM,RETURN_VALUE(J)%MFM)
      ENDDO
   END FUNCTION FMADD_FM1FM

   FUNCTION FMADD_FM1IM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      TYPE (IM) :: MB
      TYPE (FM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      N = SIZE(MA)
      CALL IMI2FM(MB%MIM,MTLVFM)
      DO J = 1, N
         CALL FMADD(MA(J)%MFM,MTLVFM,RETURN_VALUE(J)%MFM)
      ENDDO
   END FUNCTION FMADD_FM1IM

   FUNCTION FMADD_FM1ZM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      TYPE (ZM) :: MB
      TYPE (ZM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      N = SIZE(MA)
      CALL FMI2M(0,MTLVFM)
      DO J = 1, N
         CALL ZMCMPX(MA(J)%MFM,MTLVFM,MTLVZM)
         CALL ZMADD(MTLVZM,MB%MZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_FM1ZM

   FUNCTION FMADD_IM1FM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:) :: MA
      TYPE (FM) :: MB
      TYPE (FM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      N = SIZE(MA)
      DO J = 1, N
         CALL IMI2FM(MA(J)%MIM,MTLVFM)
         CALL FMADD(MTLVFM,MB%MFM,RETURN_VALUE(J)%MFM)
      ENDDO
   END FUNCTION FMADD_IM1FM

   FUNCTION FMADD_ZM1FM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      TYPE (FM) :: MB
      TYPE (ZM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      N = SIZE(MA)
      CALL FMI2M(0,MTLVFM)
      CALL ZMCMPX(MB%MFM,MTLVFM,MTLVZM)
      DO J = 1, N
         CALL ZMADD(MA(J)%MZM,MTLVZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_ZM1FM

!             (3) rank 1  +  rank 1

   FUNCTION FMADD_FM1I1(MA,IVAL)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER, DIMENSION(:) :: IVAL
      INTEGER :: J,N
      INTENT (IN) :: MA,IVAL
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA) /= SIZE(IVAL)) THEN
          DO J = 1, SIZE(MA)
             CALL FMST2M(' UNKNOWN ',RETURN_VALUE(J)%MFM)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(MA)
      DO J = 1, N
         CALL FMI2M(IVAL(J),MTLVFM)
         CALL FMADD(MA(J)%MFM,MTLVFM,RETURN_VALUE(J)%MFM)
      ENDDO
   END FUNCTION FMADD_FM1I1

   FUNCTION FMADD_FM1R1(MA,R)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      REAL, DIMENSION(:) :: R
      INTENT (IN) :: MA,R
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA) /= SIZE(R)) THEN
          DO J = 1, SIZE(MA)
             CALL FMST2M(' UNKNOWN ',RETURN_VALUE(J)%MFM)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(MA)
      DO J = 1, N
         CALL FMSP2M(R(J),MTLVFM)
         CALL FMADD(MA(J)%MFM,MTLVFM,RETURN_VALUE(J)%MFM)
      ENDDO
   END FUNCTION FMADD_FM1R1

   FUNCTION FMADD_FM1D1(MA,D)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      DOUBLE PRECISION, DIMENSION(:) :: D
      INTENT (IN) :: MA,D
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA) /= SIZE(D)) THEN
          DO J = 1, SIZE(MA)
             CALL FMST2M(' UNKNOWN ',RETURN_VALUE(J)%MFM)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(MA)
      DO J = 1, N
         CALL FMDP2M(D(J),MTLVFM)
         CALL FMADD(MA(J)%MFM,MTLVFM,RETURN_VALUE(J)%MFM)
      ENDDO
   END FUNCTION FMADD_FM1D1

   FUNCTION FMADD_FM1Z1(MA,Z)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      COMPLEX, DIMENSION(:) :: Z
      INTENT (IN) :: MA,Z
      TYPE(MULTI), SAVE :: MULVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA) /= SIZE(Z)) THEN
          DO J = 1, SIZE(MA)
             CALL ZMST2M(' UNKNOWN + UNKNOWN i ',RETURN_VALUE(J)%MZM)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(MA)
      CALL FMI2M(0,MULVFM)
      DO J = 1, N
         CALL ZMZ2M(Z(J),MTLVZM)
         CALL ZMCMPX(MA(J)%MFM,MULVFM,MULVZM)
         CALL ZMADD(MULVZM,MTLVZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_FM1Z1

   FUNCTION FMADD_FM1C1(MA,C)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      COMPLEX (KIND(0.0D0)), DIMENSION(:) :: C
      INTENT (IN) :: MA,C
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA) /= SIZE(C)) THEN
          DO J = 1, SIZE(MA)
             CALL ZMST2M(' UNKNOWN + UNKNOWN i ',RETURN_VALUE(J)%MZM)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(MA)
      DO J = 1, N
         CALL FMDP2M(REAL(C(J),KIND(0.0D0)),MTLVFM)
         CALL FMDP2M(AIMAG(C(J)),MULVFM)
         CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
         CALL FMI2M(0,MULVFM)
         CALL ZMCMPX(MA(J)%MFM,MULVFM,MULVZM)
         CALL ZMADD(MULVZM,MTLVZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_FM1C1

   FUNCTION FMADD_I1FM1(IVAL,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      INTEGER, DIMENSION(:) :: IVAL
      TYPE (FM), DIMENSION(SIZE(IVAL)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,IVAL
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA) /= SIZE(IVAL)) THEN
          DO J = 1, SIZE(MA)
             CALL FMST2M(' UNKNOWN ',RETURN_VALUE(J)%MFM)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(IVAL)
      DO J = 1, N
         CALL FMI2M(IVAL(J),MTLVFM)
         CALL FMADD(MTLVFM,MA(J)%MFM,RETURN_VALUE(J)%MFM)
      ENDDO
   END FUNCTION FMADD_I1FM1

   FUNCTION FMADD_R1FM1(R,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      REAL, DIMENSION(:) :: R
      TYPE (FM), DIMENSION(SIZE(R)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,R
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA) /= SIZE(R)) THEN
          DO J = 1, SIZE(MA)
             CALL FMST2M(' UNKNOWN ',RETURN_VALUE(J)%MFM)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(R)
      DO J = 1, N
         CALL FMSP2M(R(J),MTLVFM)
         CALL FMADD(MTLVFM,MA(J)%MFM,RETURN_VALUE(J)%MFM)
      ENDDO
   END FUNCTION FMADD_R1FM1

   FUNCTION FMADD_D1FM1(D,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      DOUBLE PRECISION, DIMENSION(:) :: D
      TYPE (FM), DIMENSION(SIZE(D)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,D
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA) /= SIZE(D)) THEN
          DO J = 1, SIZE(MA)
             CALL FMST2M(' UNKNOWN ',RETURN_VALUE(J)%MFM)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(D)
      DO J = 1, N
         CALL FMDP2M(D(J),MTLVFM)
         CALL FMADD(MTLVFM,MA(J)%MFM,RETURN_VALUE(J)%MFM)
      ENDDO
   END FUNCTION FMADD_D1FM1

   FUNCTION FMADD_Z1FM1(Z,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      COMPLEX, DIMENSION(:) :: Z
      TYPE (ZM), DIMENSION(SIZE(Z)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,Z
      TYPE(MULTI), SAVE :: MULVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA) /= SIZE(Z)) THEN
          DO J = 1, SIZE(MA)
             CALL ZMST2M(' UNKNOWN + UNKNOWN i ',RETURN_VALUE(J)%MZM)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(Z)
      CALL FMI2M(0,MULVFM)
      DO J = 1, N
         CALL ZMZ2M(Z(J),MTLVZM)
         CALL ZMCMPX(MA(J)%MFM,MULVFM,MULVZM)
         CALL ZMADD(MTLVZM,MULVZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_Z1FM1

   FUNCTION FMADD_C1FM1(C,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      COMPLEX (KIND(0.0D0)), DIMENSION(:) :: C
      TYPE (ZM), DIMENSION(SIZE(C)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,C
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA) /= SIZE(C)) THEN
          DO J = 1, SIZE(MA)
             CALL ZMST2M(' UNKNOWN + UNKNOWN i ',RETURN_VALUE(J)%MZM)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(C)
      DO J = 1, N
         CALL FMDP2M(REAL(C(J),KIND(0.0D0)),MTLVFM)
         CALL FMDP2M(AIMAG(C(J)),MULVFM)
         CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
         CALL FMI2M(0,MULVFM)
         CALL ZMCMPX(MA(J)%MFM,MULVFM,MULVZM)
         CALL ZMADD(MTLVZM,MULVZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_C1FM1

   FUNCTION FMADD_FM1FM1(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      TYPE (FM), DIMENSION(:) :: MB
      TYPE (FM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,MB
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      IF (SIZE(MA) /= SIZE(MB)) THEN
          DO J = 1, SIZE(MA)
             CALL FMST2M(' UNKNOWN ',RETURN_VALUE(J)%MFM)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(MA)
      DO J = 1, N
         CALL FMADD(MA(J)%MFM,MB(J)%MFM,RETURN_VALUE(J)%MFM)
      ENDDO
   END FUNCTION FMADD_FM1FM1

   FUNCTION FMADD_FM1IM1(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      TYPE (IM), DIMENSION(:) :: MB
      TYPE (FM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      IF (SIZE(MA) /= SIZE(MB)) THEN
          DO J = 1, SIZE(MA)
             CALL FMST2M(' UNKNOWN ',RETURN_VALUE(J)%MFM)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(MA)
      DO J = 1, N
         CALL IMI2FM(MB(J)%MIM,MTLVFM)
         CALL FMADD(MA(J)%MFM,MTLVFM,RETURN_VALUE(J)%MFM)
      ENDDO
   END FUNCTION FMADD_FM1IM1

   FUNCTION FMADD_FM1ZM1(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      TYPE (ZM), DIMENSION(:) :: MB
      TYPE (ZM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      IF (SIZE(MA) /= SIZE(MB)) THEN
          DO J = 1, SIZE(MA)
             CALL ZMST2M(' UNKNOWN + UNKNOWN i ',RETURN_VALUE(J)%MZM)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(MA)
      CALL FMI2M(0,MTLVFM)
      DO J = 1, N
         CALL ZMCMPX(MA(J)%MFM,MTLVFM,MTLVZM)
         CALL ZMADD(MTLVZM,MB(J)%MZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_FM1ZM1

   FUNCTION FMADD_IM1FM1(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:) :: MA
      TYPE (FM), DIMENSION(:) :: MB
      TYPE (FM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      IF (SIZE(MA) /= SIZE(MB)) THEN
          DO J = 1, SIZE(MA)
             CALL FMST2M(' UNKNOWN ',RETURN_VALUE(J)%MFM)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(MA)
      DO J = 1, N
         CALL IMI2FM(MA(J)%MIM,MTLVFM)
         CALL FMADD(MTLVFM,MB(J)%MFM,RETURN_VALUE(J)%MFM)
      ENDDO
   END FUNCTION FMADD_IM1FM1

   FUNCTION FMADD_ZM1FM1(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      TYPE (FM), DIMENSION(:) :: MB
      TYPE (ZM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      IF (SIZE(MA) /= SIZE(MB)) THEN
          DO J = 1, SIZE(MA)
             CALL ZMST2M(' UNKNOWN + UNKNOWN i ',RETURN_VALUE(J)%MZM)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(MA)
      CALL FMI2M(0,MTLVFM)
      DO J = 1, N
         CALL ZMCMPX(MB(J)%MFM,MTLVFM,MTLVZM)
         CALL ZMADD(MA(J)%MZM,MTLVZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_ZM1FM1

!             (4) rank 0  +  rank 2

   FUNCTION FMADD_IFM2(IVAL,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: IVAL,J,K
      INTENT (IN) :: MA,IVAL
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMI2M(IVAL,MTLVFM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMADD(MTLVFM,MA(J,K)%MFM,RETURN_VALUE(J,K)%MFM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_IFM2

   FUNCTION FMADD_RFM2(R,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      REAL :: R
      INTENT (IN) :: MA,R
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMSP2M(R,MTLVFM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMADD(MTLVFM,MA(J,K)%MFM,RETURN_VALUE(J,K)%MFM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_RFM2

   FUNCTION FMADD_DFM2(D,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      DOUBLE PRECISION :: D
      INTENT (IN) :: MA,D
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMDP2M(D,MTLVFM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMADD(MTLVFM,MA(J,K)%MFM,RETURN_VALUE(J,K)%MFM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_DFM2

   FUNCTION FMADD_ZFM2(Z,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      COMPLEX :: Z
      INTENT (IN) :: MA,Z
      TYPE(MULTI), SAVE :: MULVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL ZMZ2M(Z,MTLVZM)
      CALL FMI2M(0,MULVFM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMCMPX(MA(J,K)%MFM,MULVFM,MULVZM)
            CALL ZMADD(MTLVZM,MULVZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_ZFM2

   FUNCTION FMADD_CFM2(C,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      COMPLEX (KIND(0.0D0)) :: C
      INTENT (IN) :: MA,C
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FMDP2M(REAL(C,KIND(0.0D0)),MTLVFM)
      CALL FMDP2M(AIMAG(C),MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
      CALL FMI2M(0,MULVFM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMCMPX(MA(J,K)%MFM,MULVFM,MULVZM)
            CALL ZMADD(MTLVZM,MULVZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_CFM2

   FUNCTION FMADD_FMI2(MA,IVAL)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA
      INTEGER, DIMENSION(:,:) :: IVAL
      TYPE (FM), DIMENSION(SIZE(IVAL,DIM=1),SIZE(IVAL,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,IVAL
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(IVAL,DIM=1)
         DO K = 1, SIZE(IVAL,DIM=2)
            CALL FMI2M(IVAL(J,K),MTLVFM)
            CALL FMADD(MA%MFM,MTLVFM,RETURN_VALUE(J,K)%MFM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_FMI2

   FUNCTION FMADD_FMR2(MA,R)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA
      REAL, DIMENSION(:,:) :: R
      TYPE (FM), DIMENSION(SIZE(R,DIM=1),SIZE(R,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,R
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(R,DIM=1)
         DO K = 1, SIZE(R,DIM=2)
            CALL FMSP2M(R(J,K),MTLVFM)
            CALL FMADD(MA%MFM,MTLVFM,RETURN_VALUE(J,K)%MFM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_FMR2

   FUNCTION FMADD_FMD2(MA,D)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA
      DOUBLE PRECISION, DIMENSION(:,:) :: D
      TYPE (FM), DIMENSION(SIZE(D,DIM=1),SIZE(D,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,D
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(D,DIM=1)
         DO K = 1, SIZE(D,DIM=2)
            CALL FMDP2M(D(J,K),MTLVFM)
            CALL FMADD(MA%MFM,MTLVFM,RETURN_VALUE(J,K)%MFM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_FMD2

   FUNCTION FMADD_FMZ2(MA,Z)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA
      COMPLEX, DIMENSION(:,:) :: Z
      TYPE (ZM), DIMENSION(SIZE(Z,DIM=1),SIZE(Z,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,Z
      TYPE(MULTI), SAVE :: MULVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FMI2M(0,MULVFM)
      DO J = 1, SIZE(Z,DIM=1)
         DO K = 1, SIZE(Z,DIM=2)
            CALL ZMZ2M(Z(J,K),MTLVZM)
            CALL ZMCMPX(MA%MFM,MULVFM,MULVZM)
            CALL ZMADD(MULVZM,MTLVZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_FMZ2

   FUNCTION FMADD_FMC2(MA,C)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA
      COMPLEX (KIND(0.0D0)), DIMENSION(:,:) :: C
      TYPE (ZM), DIMENSION(SIZE(C,DIM=1),SIZE(C,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,C
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(C,DIM=1)
         DO K = 1, SIZE(C,DIM=2)
            CALL FMDP2M(REAL(C(J,K),KIND(0.0D0)),MTLVFM)
            CALL FMDP2M(AIMAG(C(J,K)),MULVFM)
            CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
            CALL FMI2M(0,MULVFM)
            CALL ZMCMPX(MA%MFM,MULVFM,MULVZM)
            CALL ZMADD(MULVZM,MTLVZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_FMC2

   FUNCTION FMADD_FMFM2(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA
      TYPE (FM), DIMENSION(:,:) :: MB
      TYPE (FM), DIMENSION(SIZE(MB,DIM=1),SIZE(MB,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,MB
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      DO J = 1, SIZE(MB,DIM=1)
         DO K = 1, SIZE(MB,DIM=2)
            CALL FMADD(MA%MFM,MB(J,K)%MFM,RETURN_VALUE(J,K)%MFM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_FMFM2

   FUNCTION FMADD_IMFM2(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA
      TYPE (FM), DIMENSION(:,:) :: MB
      TYPE (FM), DIMENSION(SIZE(MB,DIM=1),SIZE(MB,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      CALL IMI2FM(MA%MIM,MTLVFM)
      DO J = 1, SIZE(MB,DIM=1)
         DO K = 1, SIZE(MB,DIM=2)
            CALL FMADD(MTLVFM,MB(J,K)%MFM,RETURN_VALUE(J,K)%MFM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_IMFM2

   FUNCTION FMADD_ZMFM2(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA
      TYPE (FM), DIMENSION(:,:) :: MB
      TYPE (ZM), DIMENSION(SIZE(MB,DIM=1),SIZE(MB,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      CALL FMI2M(0,MTLVFM)
      DO J = 1, SIZE(MB,DIM=1)
         DO K = 1, SIZE(MB,DIM=2)
            CALL ZMCMPX(MB(J,K)%MFM,MTLVFM,MTLVZM)
            CALL ZMADD(MA%MZM,MTLVZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_ZMFM2

   FUNCTION FMADD_FMIM2(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA
      TYPE (IM), DIMENSION(:,:) :: MB
      TYPE (FM), DIMENSION(SIZE(MB,DIM=1),SIZE(MB,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      DO J = 1, SIZE(MB,DIM=1)
         DO K = 1, SIZE(MB,DIM=2)
            CALL IMI2FM(MB(J,K)%MIM,MTLVFM)
            CALL FMADD(MA%MFM,MTLVFM,RETURN_VALUE(J,K)%MFM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_FMIM2

   FUNCTION FMADD_FMZM2(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA
      TYPE (ZM), DIMENSION(:,:) :: MB
      TYPE (ZM), DIMENSION(SIZE(MB,DIM=1),SIZE(MB,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      CALL FMI2M(0,MTLVFM)
      CALL ZMCMPX(MA%MFM,MTLVFM,MTLVZM)
      DO J = 1, SIZE(MB,DIM=1)
         DO K = 1, SIZE(MB,DIM=2)
            CALL ZMADD(MTLVZM,MB(J,K)%MZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_FMZM2

!             (5) rank 2  +  rank 0

   FUNCTION FMADD_FM2I(MA,IVAL)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: IVAL,J,K
      INTENT (IN) :: MA,IVAL
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMI2M(IVAL,MTLVFM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMADD(MA(J,K)%MFM,MTLVFM,RETURN_VALUE(J,K)%MFM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_FM2I

   FUNCTION FMADD_FM2R(MA,R)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      REAL :: R
      INTENT (IN) :: MA,R
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMSP2M(R,MTLVFM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMADD(MA(J,K)%MFM,MTLVFM,RETURN_VALUE(J,K)%MFM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_FM2R

   FUNCTION FMADD_FM2D(MA,D)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      DOUBLE PRECISION :: D
      INTENT (IN) :: MA,D
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMDP2M(D,MTLVFM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMADD(MA(J,K)%MFM,MTLVFM,RETURN_VALUE(J,K)%MFM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_FM2D

   FUNCTION FMADD_FM2Z(MA,Z)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      COMPLEX :: Z
      INTENT (IN) :: MA,Z
      TYPE(MULTI), SAVE :: MULVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL ZMZ2M(Z,MTLVZM)
      CALL FMI2M(0,MULVFM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMCMPX(MA(J,K)%MFM,MULVFM,MULVZM)
            CALL ZMADD(MULVZM,MTLVZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_FM2Z

   FUNCTION FMADD_FM2C(MA,C)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      COMPLEX (KIND(0.0D0)) :: C
      INTENT (IN) :: MA,C
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FMDP2M(REAL(C,KIND(0.0D0)),MTLVFM)
      CALL FMDP2M(AIMAG(C),MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
      CALL FMI2M(0,MULVFM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMCMPX(MA(J,K)%MFM,MULVFM,MULVZM)
            CALL ZMADD(MULVZM,MTLVZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_FM2C

   FUNCTION FMADD_I2FM(IVAL,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA
      INTEGER, DIMENSION(:,:) :: IVAL
      TYPE (FM), DIMENSION(SIZE(IVAL,DIM=1),SIZE(IVAL,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,IVAL
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(IVAL,DIM=1)
         DO K = 1, SIZE(IVAL,DIM=2)
            CALL FMI2M(IVAL(J,K),MTLVFM)
            CALL FMADD(MTLVFM,MA%MFM,RETURN_VALUE(J,K)%MFM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_I2FM

   FUNCTION FMADD_R2FM(R,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA
      REAL, DIMENSION(:,:) :: R
      TYPE (FM), DIMENSION(SIZE(R,DIM=1),SIZE(R,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,R
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(R,DIM=1)
         DO K = 1, SIZE(R,DIM=2)
            CALL FMSP2M(R(J,K),MTLVFM)
            CALL FMADD(MTLVFM,MA%MFM,RETURN_VALUE(J,K)%MFM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_R2FM

   FUNCTION FMADD_D2FM(D,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA
      DOUBLE PRECISION, DIMENSION(:,:) :: D
      TYPE (FM), DIMENSION(SIZE(D,DIM=1),SIZE(D,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,D
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(D,DIM=1)
         DO K = 1, SIZE(D,DIM=2)
            CALL FMDP2M(D(J,K),MTLVFM)
            CALL FMADD(MTLVFM,MA%MFM,RETURN_VALUE(J,K)%MFM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_D2FM

   FUNCTION FMADD_Z2FM(Z,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA
      COMPLEX, DIMENSION(:,:) :: Z
      TYPE (ZM), DIMENSION(SIZE(Z,DIM=1),SIZE(Z,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,Z
      TYPE(MULTI), SAVE :: MULVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FMI2M(0,MULVFM)
      DO J = 1, SIZE(Z,DIM=1)
         DO K = 1, SIZE(Z,DIM=2)
            CALL ZMZ2M(Z(J,K),MTLVZM)
            CALL ZMCMPX(MA%MFM,MULVFM,MULVZM)
            CALL ZMADD(MTLVZM,MULVZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_Z2FM

   FUNCTION FMADD_C2FM(C,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM) :: MA
      COMPLEX (KIND(0.0D0)), DIMENSION(:,:) :: C
      TYPE (ZM), DIMENSION(SIZE(C,DIM=1),SIZE(C,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,C
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(C,DIM=1)
         DO K = 1, SIZE(C,DIM=2)
            CALL FMDP2M(REAL(C(J,K),KIND(0.0D0)),MTLVFM)
            CALL FMDP2M(AIMAG(C(J,K)),MULVFM)
            CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
            CALL FMI2M(0,MULVFM)
            CALL ZMCMPX(MA%MFM,MULVFM,MULVZM)
            CALL ZMADD(MTLVZM,MULVZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_C2FM

   FUNCTION FMADD_FM2FM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      TYPE (FM) :: MB
      TYPE (FM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,MB
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMADD(MA(J,K)%MFM,MB%MFM,RETURN_VALUE(J,K)%MFM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_FM2FM

   FUNCTION FMADD_FM2IM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      TYPE (IM) :: MB
      TYPE (FM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      CALL IMI2FM(MB%MIM,MTLVFM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMADD(MA(J,K)%MFM,MTLVFM,RETURN_VALUE(J,K)%MFM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_FM2IM

   FUNCTION FMADD_FM2ZM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      TYPE (ZM) :: MB
      TYPE (ZM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      CALL FMI2M(0,MTLVFM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMCMPX(MA(J,K)%MFM,MTLVFM,MTLVZM)
            CALL ZMADD(MTLVZM,MB%MZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_FM2ZM

   FUNCTION FMADD_IM2FM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:,:) :: MA
      TYPE (FM) :: MB
      TYPE (FM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL IMI2FM(MA(J,K)%MIM,MTLVFM)
            CALL FMADD(MTLVFM,MB%MFM,RETURN_VALUE(J,K)%MFM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_IM2FM

   FUNCTION FMADD_ZM2FM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      TYPE (FM) :: MB
      TYPE (ZM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      CALL FMI2M(0,MTLVFM)
      CALL ZMCMPX(MB%MFM,MTLVFM,MTLVZM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMADD(MA(J,K)%MZM,MTLVZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_ZM2FM

!             (6) rank 2  +  rank 2

   FUNCTION FMADD_FM2I2(MA,IVAL)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER, DIMENSION(:,:) :: IVAL
      INTEGER :: J,K
      INTENT (IN) :: MA,IVAL
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA,DIM=1) /= SIZE(IVAL,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(IVAL,DIM=2)) THEN
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                CALL FMST2M(' UNKNOWN ',RETURN_VALUE(J,K)%MFM)
             ENDDO
          ENDDO
          RETURN
      ENDIF
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMI2M(IVAL(J,K),MTLVFM)
            CALL FMADD(MA(J,K)%MFM,MTLVFM,RETURN_VALUE(J,K)%MFM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_FM2I2

   FUNCTION FMADD_FM2R2(MA,R)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      REAL, DIMENSION(:,:) :: R
      INTENT (IN) :: MA,R
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA,DIM=1) /= SIZE(R,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(R,DIM=2)) THEN
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                CALL FMST2M(' UNKNOWN ',RETURN_VALUE(J,K)%MFM)
             ENDDO
          ENDDO
          RETURN
      ENDIF
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMSP2M(R(J,K),MTLVFM)
            CALL FMADD(MA(J,K)%MFM,MTLVFM,RETURN_VALUE(J,K)%MFM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_FM2R2

   FUNCTION FMADD_FM2D2(MA,D)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      DOUBLE PRECISION, DIMENSION(:,:) :: D
      INTENT (IN) :: MA,D
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA,DIM=1) /= SIZE(D,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(D,DIM=2)) THEN
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                CALL FMST2M(' UNKNOWN ',RETURN_VALUE(J,K)%MFM)
             ENDDO
          ENDDO
          RETURN
      ENDIF
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMDP2M(D(J,K),MTLVFM)
            CALL FMADD(MA(J,K)%MFM,MTLVFM,RETURN_VALUE(J,K)%MFM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_FM2D2

   FUNCTION FMADD_FM2Z2(MA,Z)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      COMPLEX, DIMENSION(:,:) :: Z
      INTENT (IN) :: MA,Z
      TYPE(MULTI), SAVE :: MULVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA,DIM=1) /= SIZE(Z,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(Z,DIM=2)) THEN
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                CALL ZMST2M(' UNKNOWN + UNKNOWN i ',RETURN_VALUE(J,K)%MZM)
             ENDDO
          ENDDO
          RETURN
      ENDIF
      CALL FMI2M(0,MULVFM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMZ2M(Z(J,K),MTLVZM)
            CALL ZMCMPX(MA(J,K)%MFM,MULVFM,MULVZM)
            CALL ZMADD(MULVZM,MTLVZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_FM2Z2

   FUNCTION FMADD_FM2C2(MA,C)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      COMPLEX (KIND(0.0D0)), DIMENSION(:,:) :: C
      INTENT (IN) :: MA,C
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA,DIM=1) /= SIZE(C,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(C,DIM=2)) THEN
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                CALL ZMST2M(' UNKNOWN + UNKNOWN i ',RETURN_VALUE(J,K)%MZM)
             ENDDO
          ENDDO
          RETURN
      ENDIF
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMDP2M(REAL(C(J,K),KIND(0.0D0)),MTLVFM)
            CALL FMDP2M(AIMAG(C(J,K)),MULVFM)
            CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
            CALL FMI2M(0,MULVFM)
            CALL ZMCMPX(MA(J,K)%MFM,MULVFM,MULVZM)
            CALL ZMADD(MULVZM,MTLVZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_FM2C2

   FUNCTION FMADD_I2FM2(IVAL,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      INTEGER, DIMENSION(:,:) :: IVAL
      TYPE (FM), DIMENSION(SIZE(IVAL,DIM=1),SIZE(IVAL,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,IVAL
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA,DIM=1) /= SIZE(IVAL,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(IVAL,DIM=2)) THEN
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                CALL FMST2M(' UNKNOWN ',RETURN_VALUE(J,K)%MFM)
             ENDDO
          ENDDO
          RETURN
      ENDIF
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMI2M(IVAL(J,K),MTLVFM)
            CALL FMADD(MTLVFM,MA(J,K)%MFM,RETURN_VALUE(J,K)%MFM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_I2FM2

   FUNCTION FMADD_R2FM2(R,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      REAL, DIMENSION(:,:) :: R
      TYPE (FM), DIMENSION(SIZE(R,DIM=1),SIZE(R,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,R
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA,DIM=1) /= SIZE(R,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(R,DIM=2)) THEN
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                CALL FMST2M(' UNKNOWN ',RETURN_VALUE(J,K)%MFM)
             ENDDO
          ENDDO
          RETURN
      ENDIF
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMSP2M(R(J,K),MTLVFM)
            CALL FMADD(MTLVFM,MA(J,K)%MFM,RETURN_VALUE(J,K)%MFM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_R2FM2

   FUNCTION FMADD_D2FM2(D,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      DOUBLE PRECISION, DIMENSION(:,:) :: D
      TYPE (FM), DIMENSION(SIZE(D,DIM=1),SIZE(D,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,D
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA,DIM=1) /= SIZE(D,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(D,DIM=2)) THEN
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                CALL FMST2M(' UNKNOWN ',RETURN_VALUE(J,K)%MFM)
             ENDDO
          ENDDO
          RETURN
      ENDIF
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMDP2M(D(J,K),MTLVFM)
            CALL FMADD(MTLVFM,MA(J,K)%MFM,RETURN_VALUE(J,K)%MFM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_D2FM2

   FUNCTION FMADD_Z2FM2(Z,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      COMPLEX, DIMENSION(:,:) :: Z
      TYPE (ZM), DIMENSION(SIZE(Z,DIM=1),SIZE(Z,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,Z
      TYPE(MULTI), SAVE :: MULVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA,DIM=1) /= SIZE(Z,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(Z,DIM=2)) THEN
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                CALL ZMST2M(' UNKNOWN + UNKNOWN i ',RETURN_VALUE(J,K)%MZM)
             ENDDO
          ENDDO
          RETURN
      ENDIF
      CALL FMI2M(0,MULVFM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMZ2M(Z(J,K),MTLVZM)
            CALL ZMCMPX(MA(J,K)%MFM,MULVFM,MULVZM)
            CALL ZMADD(MTLVZM,MULVZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_Z2FM2

   FUNCTION FMADD_C2FM2(C,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      COMPLEX (KIND(0.0D0)), DIMENSION(:,:) :: C
      TYPE (ZM), DIMENSION(SIZE(C,DIM=1),SIZE(C,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,C
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA,DIM=1) /= SIZE(C,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(C,DIM=2)) THEN
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                CALL ZMST2M(' UNKNOWN + UNKNOWN i ',RETURN_VALUE(J,K)%MZM)
             ENDDO
          ENDDO
          RETURN
      ENDIF
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMDP2M(REAL(C(J,K),KIND(0.0D0)),MTLVFM)
            CALL FMDP2M(AIMAG(C(J,K)),MULVFM)
            CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
            CALL FMI2M(0,MULVFM)
            CALL ZMCMPX(MA(J,K)%MFM,MULVFM,MULVZM)
            CALL ZMADD(MTLVZM,MULVZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_C2FM2

   FUNCTION FMADD_FM2FM2(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      TYPE (FM), DIMENSION(:,:) :: MB
      TYPE (FM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,MB
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      IF (SIZE(MA,DIM=1) /= SIZE(MB,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(MB,DIM=2)) THEN
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                CALL FMST2M(' UNKNOWN ',RETURN_VALUE(J,K)%MFM)
             ENDDO
          ENDDO
          RETURN
      ENDIF
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMADD(MA(J,K)%MFM,MB(J,K)%MFM,RETURN_VALUE(J,K)%MFM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_FM2FM2

   FUNCTION FMADD_FM2IM2(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      TYPE (IM), DIMENSION(:,:) :: MB
      TYPE (FM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      IF (SIZE(MA,DIM=1) /= SIZE(MB,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(MB,DIM=2)) THEN
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                CALL FMST2M(' UNKNOWN ',RETURN_VALUE(J,K)%MFM)
             ENDDO
          ENDDO
          RETURN
      ENDIF
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL IMI2FM(MB(J,K)%MIM,MTLVFM)
            CALL FMADD(MA(J,K)%MFM,MTLVFM,RETURN_VALUE(J,K)%MFM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_FM2IM2

   FUNCTION FMADD_FM2ZM2(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      TYPE (ZM), DIMENSION(:,:) :: MB
      TYPE (ZM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      IF (SIZE(MA,DIM=1) /= SIZE(MB,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(MB,DIM=2)) THEN
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                CALL ZMST2M(' UNKNOWN + UNKNOWN i ',RETURN_VALUE(J,K)%MZM)
             ENDDO
          ENDDO
          RETURN
      ENDIF
      CALL FMI2M(0,MTLVFM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMCMPX(MA(J,K)%MFM,MTLVFM,MTLVZM)
            CALL ZMADD(MTLVZM,MB(J,K)%MZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_FM2ZM2

   FUNCTION FMADD_IM2FM2(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:,:) :: MA
      TYPE (FM), DIMENSION(:,:) :: MB
      TYPE (FM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVFM
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      IF (SIZE(MA,DIM=1) /= SIZE(MB,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(MB,DIM=2)) THEN
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                CALL FMST2M(' UNKNOWN ',RETURN_VALUE(J,K)%MFM)
             ENDDO
          ENDDO
          RETURN
      ENDIF
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL IMI2FM(MA(J,K)%MIM,MTLVFM)
            CALL FMADD(MTLVFM,MB(J,K)%MFM,RETURN_VALUE(J,K)%MFM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_IM2FM2

   FUNCTION FMADD_ZM2FM2(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      TYPE (FM), DIMENSION(:,:) :: MB
      TYPE (ZM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      IF (SIZE(MA,DIM=1) /= SIZE(MB,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(MB,DIM=2)) THEN
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                CALL ZMST2M(' UNKNOWN + UNKNOWN i ',RETURN_VALUE(J,K)%MZM)
             ENDDO
          ENDDO
          RETURN
      ENDIF
      CALL FMI2M(0,MTLVFM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMCMPX(MB(J,K)%MFM,MTLVFM,MTLVZM)
            CALL ZMADD(MA(J,K)%MZM,MTLVZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_ZM2FM2

!             Array addition operations for IM.

!             (1) rank 0  +  rank 1

   FUNCTION FMADD_IIM1(IVAL,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:) :: MA
      TYPE (IM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: IVAL,J,N
      INTENT (IN) :: MA,IVAL
      TYPE(MULTI), SAVE :: MTLVIM
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      CALL IMI2M(IVAL,MTLVIM)
      DO J = 1, N
         CALL IMADD(MTLVIM,MA(J)%MIM,RETURN_VALUE(J)%MIM)
      ENDDO
   END FUNCTION FMADD_IIM1

   FUNCTION FMADD_RIM1(R,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      REAL :: R
      INTENT (IN) :: MA,R
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      CALL FMSP2M(R,MTLVFM)
      DO J = 1, N
         CALL IMI2FM(MA(J)%MIM,MULVFM)
         CALL FMADD(MTLVFM,MULVFM,RETURN_VALUE(J)%MFM)
      ENDDO
   END FUNCTION FMADD_RIM1

   FUNCTION FMADD_DIM1(D,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      DOUBLE PRECISION :: D
      INTENT (IN) :: MA,D
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      CALL FMDP2M(D,MTLVFM)
      DO J = 1, N
         CALL IMI2FM(MA(J)%MIM,MULVFM)
         CALL FMADD(MTLVFM,MULVFM,RETURN_VALUE(J)%MFM)
      ENDDO
   END FUNCTION FMADD_DIM1

   FUNCTION FMADD_ZIM1(Z,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      COMPLEX :: Z
      INTENT (IN) :: MA,Z
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      CALL ZMZ2M(Z,MTLVZM)
      CALL FMI2M(0,MULVFM)
      DO J = 1, N
         CALL IMI2FM(MA(J)%MIM,MTLVFM)
         CALL ZMCMPX(MTLVFM,MULVFM,MULVZM)
         CALL ZMADD(MTLVZM,MULVZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_ZIM1

   FUNCTION FMADD_CIM1(C,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      COMPLEX (KIND(0.0D0)) :: C
      INTENT (IN) :: MA,C
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      CALL FMDP2M(REAL(C,KIND(0.0D0)),MTLVFM)
      CALL FMDP2M(AIMAG(C),MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
      CALL FMI2M(0,MULVFM)
      DO J = 1, N
         CALL IMI2FM(MA(J)%MIM,MTLVFM)
         CALL ZMCMPX(MTLVFM,MULVFM,MULVZM)
         CALL ZMADD(MTLVZM,MULVZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_CIM1

   FUNCTION FMADD_IMI1(MA,IVAL)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA
      INTEGER, DIMENSION(:) :: IVAL
      TYPE (IM), DIMENSION(SIZE(IVAL)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,IVAL
      TYPE(MULTI), SAVE :: MTLVIM
      CALL FM_UNDEF_INP(MA)
      N = SIZE(IVAL)
      DO J = 1, N
         CALL IMI2M(IVAL(J),MTLVIM)
         CALL IMADD(MA%MIM,MTLVIM,RETURN_VALUE(J)%MIM)
      ENDDO
   END FUNCTION FMADD_IMI1

   FUNCTION FMADD_IMR1(MA,R)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA
      REAL, DIMENSION(:) :: R
      TYPE (FM), DIMENSION(SIZE(R)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,R
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM
      CALL FM_UNDEF_INP(MA)
      N = SIZE(R)
      CALL IMI2FM(MA%MIM,MULVFM)
      DO J = 1, N
         CALL FMSP2M(R(J),MTLVFM)
         CALL FMADD(MULVFM,MTLVFM,RETURN_VALUE(J)%MFM)
      ENDDO
   END FUNCTION FMADD_IMR1

   FUNCTION FMADD_IMD1(MA,D)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA
      DOUBLE PRECISION, DIMENSION(:) :: D
      TYPE (FM), DIMENSION(SIZE(D)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,D
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM
      CALL FM_UNDEF_INP(MA)
      N = SIZE(D)
      CALL IMI2FM(MA%MIM,MULVFM)
      DO J = 1, N
         CALL FMDP2M(D(J),MTLVFM)
         CALL FMADD(MULVFM,MTLVFM,RETURN_VALUE(J)%MFM)
      ENDDO
   END FUNCTION FMADD_IMD1

   FUNCTION FMADD_IMZ1(MA,Z)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA
      COMPLEX, DIMENSION(:) :: Z
      TYPE (ZM), DIMENSION(SIZE(Z)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,Z
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      N = SIZE(Z)
      CALL IMI2FM(MA%MIM,MTLVFM)
      CALL FMI2M(0,MULVFM)
      DO J = 1, N
         CALL ZMZ2M(Z(J),MTLVZM)
         CALL ZMCMPX(MTLVFM,MULVFM,MULVZM)
         CALL ZMADD(MULVZM,MTLVZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_IMZ1

   FUNCTION FMADD_IMC1(MA,C)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA
      COMPLEX (KIND(0.0D0)), DIMENSION(:) :: C
      TYPE (ZM), DIMENSION(SIZE(C)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,C
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MVLVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      N = SIZE(C)
      CALL IMI2FM(MA%MIM,MVLVFM)
      DO J = 1, N
         CALL FMDP2M(REAL(C(J),KIND(0.0D0)),MTLVFM)
         CALL FMDP2M(AIMAG(C(J)),MULVFM)
         CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
         CALL FMI2M(0,MULVFM)
         CALL ZMCMPX(MVLVFM,MULVFM,MULVZM)
         CALL ZMADD(MULVZM,MTLVZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_IMC1

   FUNCTION FMADD_IMIM1(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA
      TYPE (IM), DIMENSION(:) :: MB
      TYPE (IM), DIMENSION(SIZE(MB)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,MB
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      N = SIZE(MB)
      DO J = 1, N
         CALL IMADD(MA%MIM,MB(J)%MIM,RETURN_VALUE(J)%MIM)
      ENDDO
   END FUNCTION FMADD_IMIM1

   FUNCTION FMADD_ZMIM1(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA
      TYPE (IM), DIMENSION(:) :: MB
      TYPE (ZM), DIMENSION(SIZE(MB)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVFM,MVLVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      N = SIZE(MB)
      CALL FMI2M(0,MTLVFM)
      DO J = 1, N
         CALL IMI2FM(MB(J)%MIM,MVLVFM)
         CALL ZMCMPX(MVLVFM,MTLVFM,MTLVZM)
         CALL ZMADD(MA%MZM,MTLVZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_ZMIM1

   FUNCTION FMADD_IMZM1(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA
      TYPE (ZM), DIMENSION(:) :: MB
      TYPE (ZM), DIMENSION(SIZE(MB)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVFM,MVLVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      N = SIZE(MB)
      CALL IMI2FM(MA%MIM,MVLVFM)
      CALL FMI2M(0,MTLVFM)
      CALL ZMCMPX(MVLVFM,MTLVFM,MTLVZM)
      DO J = 1, N
         CALL ZMADD(MTLVZM,MB(J)%MZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_IMZM1

!             (2) rank 1  +  rank 0

   FUNCTION FMADD_IM1I(MA,IVAL)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:) :: MA
      TYPE (IM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: IVAL,J,N
      INTENT (IN) :: MA,IVAL
      TYPE(MULTI), SAVE :: MTLVIM
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      CALL IMI2M(IVAL,MTLVIM)
      DO J = 1, N
         CALL IMADD(MA(J)%MIM,MTLVIM,RETURN_VALUE(J)%MIM)
      ENDDO
   END FUNCTION FMADD_IM1I

   FUNCTION FMADD_IM1R(MA,R)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      REAL :: R
      INTENT (IN) :: MA,R
      TYPE(MULTI), SAVE :: MTLVFM,MVLVFM
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      CALL FMSP2M(R,MTLVFM)
      DO J = 1, N
         CALL IMI2FM(MA(J)%MIM,MVLVFM)
         CALL FMADD(MVLVFM,MTLVFM,RETURN_VALUE(J)%MFM)
      ENDDO
   END FUNCTION FMADD_IM1R

   FUNCTION FMADD_IM1D(MA,D)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      DOUBLE PRECISION :: D
      INTENT (IN) :: MA,D
      TYPE(MULTI), SAVE :: MTLVFM,MVLVFM
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      CALL FMDP2M(D,MTLVFM)
      DO J = 1, N
         CALL IMI2FM(MA(J)%MIM,MVLVFM)
         CALL FMADD(MVLVFM,MTLVFM,RETURN_VALUE(J)%MFM)
      ENDDO
   END FUNCTION FMADD_IM1D

   FUNCTION FMADD_IM1Z(MA,Z)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      COMPLEX :: Z
      INTENT (IN) :: MA,Z
      TYPE(MULTI), SAVE :: MULVFM,MVLVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      CALL ZMZ2M(Z,MTLVZM)
      CALL FMI2M(0,MULVFM)
      DO J = 1, N
         CALL IMI2FM(MA(J)%MIM,MVLVFM)
         CALL ZMCMPX(MVLVFM,MULVFM,MULVZM)
         CALL ZMADD(MULVZM,MTLVZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_IM1Z

   FUNCTION FMADD_IM1C(MA,C)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      COMPLEX (KIND(0.0D0)) :: C
      INTENT (IN) :: MA,C
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MVLVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      CALL FMDP2M(REAL(C,KIND(0.0D0)),MTLVFM)
      CALL FMDP2M(AIMAG(C),MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
      CALL FMI2M(0,MULVFM)
      DO J = 1, N
         CALL IMI2FM(MA(J)%MIM,MVLVFM)
         CALL ZMCMPX(MVLVFM,MULVFM,MULVZM)
         CALL ZMADD(MULVZM,MTLVZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_IM1C

   FUNCTION FMADD_I1IM(IVAL,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA
      INTEGER, DIMENSION(:) :: IVAL
      TYPE (IM), DIMENSION(SIZE(IVAL)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,IVAL
      TYPE(MULTI), SAVE :: MTLVIM
      CALL FM_UNDEF_INP(MA)
      N = SIZE(IVAL)
      DO J = 1, N
         CALL IMI2M(IVAL(J),MTLVIM)
         CALL IMADD(MTLVIM,MA%MIM,RETURN_VALUE(J)%MIM)
      ENDDO
   END FUNCTION FMADD_I1IM

   FUNCTION FMADD_R1IM(R,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA
      REAL, DIMENSION(:) :: R
      TYPE (FM), DIMENSION(SIZE(R)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,R
      TYPE(MULTI), SAVE :: MTLVFM,MVLVFM
      CALL FM_UNDEF_INP(MA)
      N = SIZE(R)
      CALL IMI2FM(MA%MIM,MVLVFM)
      DO J = 1, N
         CALL FMSP2M(R(J),MTLVFM)
         CALL FMADD(MTLVFM,MVLVFM,RETURN_VALUE(J)%MFM)
      ENDDO
   END FUNCTION FMADD_R1IM

   FUNCTION FMADD_D1IM(D,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA
      DOUBLE PRECISION, DIMENSION(:) :: D
      TYPE (FM), DIMENSION(SIZE(D)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,D
      TYPE(MULTI), SAVE :: MTLVFM,MVLVFM
      CALL FM_UNDEF_INP(MA)
      N = SIZE(D)
      CALL IMI2FM(MA%MIM,MVLVFM)
      DO J = 1, N
         CALL FMDP2M(D(J),MTLVFM)
         CALL FMADD(MTLVFM,MVLVFM,RETURN_VALUE(J)%MFM)
      ENDDO
   END FUNCTION FMADD_D1IM

   FUNCTION FMADD_Z1IM(Z,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA
      COMPLEX, DIMENSION(:) :: Z
      TYPE (ZM), DIMENSION(SIZE(Z)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,Z
      TYPE(MULTI), SAVE :: MULVFM,MVLVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      N = SIZE(Z)
      CALL IMI2FM(MA%MIM,MVLVFM)
      CALL FMI2M(0,MULVFM)
      DO J = 1, N
         CALL ZMZ2M(Z(J),MTLVZM)
         CALL ZMCMPX(MVLVFM,MULVFM,MULVZM)
         CALL ZMADD(MTLVZM,MULVZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_Z1IM

   FUNCTION FMADD_C1IM(C,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA
      COMPLEX (KIND(0.0D0)), DIMENSION(:) :: C
      TYPE (ZM), DIMENSION(SIZE(C)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,C
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,M1LVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      N = SIZE(C)
      CALL IMI2FM(MA%MIM,M1LVFM)
      DO J = 1, N
         CALL FMDP2M(REAL(C(J),KIND(0.0D0)),MTLVFM)
         CALL FMDP2M(AIMAG(C(J)),MULVFM)
         CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
         CALL FMI2M(0,MULVFM)
         CALL ZMCMPX(M1LVFM,MULVFM,MULVZM)
         CALL ZMADD(MTLVZM,MULVZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_C1IM

   FUNCTION FMADD_IM1IM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:) :: MA
      TYPE (IM) :: MB
      TYPE (IM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,MB
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      N = SIZE(MA)
      DO J = 1, N
         CALL IMADD(MA(J)%MIM,MB%MIM,RETURN_VALUE(J)%MIM)
      ENDDO
   END FUNCTION FMADD_IM1IM

   FUNCTION FMADD_IM1ZM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:) :: MA
      TYPE (ZM) :: MB
      TYPE (ZM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVFM,M1LVFM,M1LVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      N = SIZE(MA)
      CALL FMI2M(0,MTLVFM)
      DO J = 1, N
         CALL IMI2FM(MA(J)%MIM,M1LVFM)
         CALL ZMCMPX(M1LVFM,MTLVFM,M1LVZM)
         CALL ZMADD(M1LVZM,MB%MZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_IM1ZM

   FUNCTION FMADD_ZM1IM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      TYPE (IM) :: MB
      TYPE (ZM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVFM,M1LVFM,M1LVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      N = SIZE(MA)
      CALL IMI2FM(MB%MIM,M1LVFM)
      CALL FMI2M(0,MTLVFM)
      CALL ZMCMPX(M1LVFM,MTLVFM,M1LVZM)
      DO J = 1, N
         CALL ZMADD(MA(J)%MZM,M1LVZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_ZM1IM

!             (3) rank 1  +  rank 1

   FUNCTION FMADD_IM1I1(MA,IVAL)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:) :: MA
      TYPE (IM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER, DIMENSION(:) :: IVAL
      INTEGER :: J,N
      INTENT (IN) :: MA,IVAL
      TYPE(MULTI), SAVE :: MTLVIM
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA) /= SIZE(IVAL)) THEN
          DO J = 1, SIZE(MA)
             CALL IMST2M(' UNKNOWN ',RETURN_VALUE(J)%MIM)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(MA)
      DO J = 1, N
         CALL IMI2M(IVAL(J),MTLVIM)
         CALL IMADD(MA(J)%MIM,MTLVIM,RETURN_VALUE(J)%MIM)
      ENDDO
   END FUNCTION FMADD_IM1I1

   FUNCTION FMADD_IM1R1(MA,R)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      REAL, DIMENSION(:) :: R
      INTENT (IN) :: MA,R
      TYPE(MULTI), SAVE :: MTLVFM,M1LVFM
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA) /= SIZE(R)) THEN
          DO J = 1, SIZE(MA)
             CALL FMST2M(' UNKNOWN ',RETURN_VALUE(J)%MFM)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(MA)
      DO J = 1, N
         CALL FMSP2M(R(J),MTLVFM)
         CALL IMI2FM(MA(J)%MIM,M1LVFM)
         CALL FMADD(M1LVFM,MTLVFM,RETURN_VALUE(J)%MFM)
      ENDDO
   END FUNCTION FMADD_IM1R1

   FUNCTION FMADD_IM1D1(MA,D)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      DOUBLE PRECISION, DIMENSION(:) :: D
      INTENT (IN) :: MA,D
      TYPE(MULTI), SAVE :: MTLVFM,M1LVFM
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA) /= SIZE(D)) THEN
          DO J = 1, SIZE(MA)
             CALL FMST2M(' UNKNOWN ',RETURN_VALUE(J)%MFM)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(MA)
      DO J = 1, N
         CALL FMDP2M(D(J),MTLVFM)
         CALL IMI2FM(MA(J)%MIM,M1LVFM)
         CALL FMADD(M1LVFM,MTLVFM,RETURN_VALUE(J)%MFM)
      ENDDO
   END FUNCTION FMADD_IM1D1

   FUNCTION FMADD_IM1Z1(MA,Z)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      COMPLEX, DIMENSION(:) :: Z
      INTENT (IN) :: MA,Z
      TYPE(MULTI), SAVE :: MULVFM,M1LVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA) /= SIZE(Z)) THEN
          DO J = 1, SIZE(MA)
             CALL ZMST2M(' UNKNOWN + UNKNOWN i ',RETURN_VALUE(J)%MZM)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(MA)
      CALL FMI2M(0,MULVFM)
      DO J = 1, N
         CALL ZMZ2M(Z(J),MTLVZM)
         CALL IMI2FM(MA(J)%MIM,M1LVFM)
         CALL ZMCMPX(M1LVFM,MULVFM,MULVZM)
         CALL ZMADD(MULVZM,MTLVZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_IM1Z1

   FUNCTION FMADD_IM1C1(MA,C)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      COMPLEX (KIND(0.0D0)), DIMENSION(:) :: C
      INTENT (IN) :: MA,C
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,M1LVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA) /= SIZE(C)) THEN
          DO J = 1, SIZE(MA)
             CALL ZMST2M(' UNKNOWN + UNKNOWN i ',RETURN_VALUE(J)%MZM)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(MA)
      DO J = 1, N
         CALL FMDP2M(REAL(C(J),KIND(0.0D0)),MTLVFM)
         CALL FMDP2M(AIMAG(C(J)),MULVFM)
         CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
         CALL IMI2FM(MA(J)%MIM,M1LVFM)
         CALL FMI2M(0,MULVFM)
         CALL ZMCMPX(M1LVFM,MULVFM,MULVZM)
         CALL ZMADD(MULVZM,MTLVZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_IM1C1

   FUNCTION FMADD_I1IM1(IVAL,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:) :: MA
      INTEGER, DIMENSION(:) :: IVAL
      TYPE (IM), DIMENSION(SIZE(IVAL)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,IVAL
      TYPE(MULTI), SAVE :: MTLVIM
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA) /= SIZE(IVAL)) THEN
          DO J = 1, SIZE(MA)
             CALL IMST2M(' UNKNOWN ',RETURN_VALUE(J)%MIM)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(IVAL)
      DO J = 1, N
         CALL IMI2M(IVAL(J),MTLVIM)
         CALL IMADD(MTLVIM,MA(J)%MIM,RETURN_VALUE(J)%MIM)
      ENDDO
   END FUNCTION FMADD_I1IM1

   FUNCTION FMADD_R1IM1(R,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:) :: MA
      REAL, DIMENSION(:) :: R
      TYPE (FM), DIMENSION(SIZE(R)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,R
      TYPE(MULTI), SAVE :: MTLVFM,M1LVFM
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA) /= SIZE(R)) THEN
          DO J = 1, SIZE(MA)
             CALL FMST2M(' UNKNOWN ',RETURN_VALUE(J)%MFM)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(R)
      DO J = 1, N
         CALL IMI2FM(MA(J)%MIM,M1LVFM)
         CALL FMSP2M(R(J),MTLVFM)
         CALL FMADD(MTLVFM,M1LVFM,RETURN_VALUE(J)%MFM)
      ENDDO
   END FUNCTION FMADD_R1IM1

   FUNCTION FMADD_D1IM1(D,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:) :: MA
      DOUBLE PRECISION, DIMENSION(:) :: D
      TYPE (FM), DIMENSION(SIZE(D)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,D
      TYPE(MULTI), SAVE :: MTLVFM,M1LVFM
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA) /= SIZE(D)) THEN
          DO J = 1, SIZE(MA)
             CALL FMST2M(' UNKNOWN ',RETURN_VALUE(J)%MFM)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(D)
      DO J = 1, N
         CALL IMI2FM(MA(J)%MIM,M1LVFM)
         CALL FMDP2M(D(J),MTLVFM)
         CALL FMADD(MTLVFM,M1LVFM,RETURN_VALUE(J)%MFM)
      ENDDO
   END FUNCTION FMADD_D1IM1

   FUNCTION FMADD_Z1IM1(Z,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:) :: MA
      COMPLEX, DIMENSION(:) :: Z
      TYPE (ZM), DIMENSION(SIZE(Z)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,Z
      TYPE(MULTI), SAVE :: MULVFM,M1LVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA) /= SIZE(Z)) THEN
          DO J = 1, SIZE(MA)
             CALL ZMST2M(' UNKNOWN + UNKNOWN i ',RETURN_VALUE(J)%MZM)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(Z)
      CALL FMI2M(0,MULVFM)
      DO J = 1, N
         CALL ZMZ2M(Z(J),MTLVZM)
         CALL IMI2FM(MA(J)%MIM,M1LVFM)
         CALL ZMCMPX(M1LVFM,MULVFM,MULVZM)
         CALL ZMADD(MTLVZM,MULVZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_Z1IM1

   FUNCTION FMADD_C1IM1(C,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:) :: MA
      COMPLEX (KIND(0.0D0)), DIMENSION(:) :: C
      TYPE (ZM), DIMENSION(SIZE(C)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,C
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,M1LVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA) /= SIZE(C)) THEN
          DO J = 1, SIZE(MA)
             CALL ZMST2M(' UNKNOWN + UNKNOWN i ',RETURN_VALUE(J)%MZM)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(C)
      DO J = 1, N
         CALL IMI2FM(MA(J)%MIM,M1LVFM)
         CALL FMDP2M(REAL(C(J),KIND(0.0D0)),MTLVFM)
         CALL FMDP2M(AIMAG(C(J)),MULVFM)
         CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
         CALL FMI2M(0,MULVFM)
         CALL ZMCMPX(M1LVFM,MULVFM,MULVZM)
         CALL ZMADD(MTLVZM,MULVZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_C1IM1

   FUNCTION FMADD_IM1IM1(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:) :: MA
      TYPE (IM), DIMENSION(:) :: MB
      TYPE (IM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,MB
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      IF (SIZE(MA) /= SIZE(MB)) THEN
          DO J = 1, SIZE(MA)
             CALL IMST2M(' UNKNOWN ',RETURN_VALUE(J)%MIM)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(MA)
      DO J = 1, N
         CALL IMADD(MA(J)%MIM,MB(J)%MIM,RETURN_VALUE(J)%MIM)
      ENDDO
   END FUNCTION FMADD_IM1IM1

   FUNCTION FMADD_IM1ZM1(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:) :: MA
      TYPE (ZM), DIMENSION(:) :: MB
      TYPE (ZM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVFM,M1LVFM,M1LVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      IF (SIZE(MA) /= SIZE(MB)) THEN
          DO J = 1, SIZE(MA)
             CALL ZMST2M(' UNKNOWN + UNKNOWN i ',RETURN_VALUE(J)%MZM)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(MA)
      CALL FMI2M(0,MTLVFM)
      DO J = 1, N
         CALL IMI2FM(MA(J)%MIM,M1LVFM)
         CALL ZMCMPX(M1LVFM,MTLVFM,M1LVZM)
         CALL ZMADD(M1LVZM,MB(J)%MZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_IM1ZM1

   FUNCTION FMADD_ZM1IM1(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      TYPE (IM), DIMENSION(:) :: MB
      TYPE (ZM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVFM,M1LVFM,M1LVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      IF (SIZE(MA) /= SIZE(MB)) THEN
          DO J = 1, SIZE(MA)
             CALL ZMST2M(' UNKNOWN + UNKNOWN i ',RETURN_VALUE(J)%MZM)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(MA)
      CALL FMI2M(0,MTLVFM)
      DO J = 1, N
         CALL IMI2FM(MB(J)%MIM,M1LVFM)
         CALL ZMCMPX(M1LVFM,MTLVFM,M1LVZM)
         CALL ZMADD(MA(J)%MZM,M1LVZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_ZM1IM1

!             (4) rank 0  +  rank 2

   FUNCTION FMADD_IIM2(IVAL,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:,:) :: MA
      TYPE (IM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: IVAL,J,K
      INTENT (IN) :: MA,IVAL
      TYPE(MULTI), SAVE :: MTLVIM
      CALL FM_UNDEF_INP(MA)
      CALL IMI2M(IVAL,MTLVIM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL IMADD(MTLVIM,MA(J,K)%MIM,RETURN_VALUE(J,K)%MIM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_IIM2

   FUNCTION FMADD_RIM2(R,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:,:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      REAL :: R
      INTENT (IN) :: MA,R
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMSP2M(R,MTLVFM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL IMI2FM(MA(J,K)%MIM,MULVFM)
            CALL FMADD(MTLVFM,MULVFM,RETURN_VALUE(J,K)%MFM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_RIM2

   FUNCTION FMADD_DIM2(D,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:,:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      DOUBLE PRECISION :: D
      INTENT (IN) :: MA,D
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMDP2M(D,MTLVFM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL IMI2FM(MA(J,K)%MIM,MULVFM)
            CALL FMADD(MTLVFM,MULVFM,RETURN_VALUE(J,K)%MFM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_DIM2

   FUNCTION FMADD_ZIM2(Z,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:,:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      COMPLEX :: Z
      INTENT (IN) :: MA,Z
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL ZMZ2M(Z,MTLVZM)
      CALL FMI2M(0,MULVFM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL IMI2FM(MA(J,K)%MIM,MTLVFM)
            CALL ZMCMPX(MTLVFM,MULVFM,MULVZM)
            CALL ZMADD(MTLVZM,MULVZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_ZIM2

   FUNCTION FMADD_CIM2(C,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:,:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      COMPLEX (KIND(0.0D0)) :: C
      INTENT (IN) :: MA,C
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FMDP2M(REAL(C,KIND(0.0D0)),MTLVFM)
      CALL FMDP2M(AIMAG(C),MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
      CALL FMI2M(0,MULVFM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL IMI2FM(MA(J,K)%MIM,MTLVFM)
            CALL ZMCMPX(MTLVFM,MULVFM,MULVZM)
            CALL ZMADD(MTLVZM,MULVZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_CIM2

   FUNCTION FMADD_IMI2(MA,IVAL)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA
      INTEGER, DIMENSION(:,:) :: IVAL
      TYPE (IM), DIMENSION(SIZE(IVAL,DIM=1),SIZE(IVAL,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,IVAL
      TYPE(MULTI), SAVE :: MTLVIM
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(IVAL,DIM=1)
         DO K = 1, SIZE(IVAL,DIM=2)
            CALL IMI2M(IVAL(J,K),MTLVIM)
            CALL IMADD(MA%MIM,MTLVIM,RETURN_VALUE(J,K)%MIM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_IMI2

   FUNCTION FMADD_IMR2(MA,R)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA
      REAL, DIMENSION(:,:) :: R
      TYPE (FM), DIMENSION(SIZE(R,DIM=1),SIZE(R,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,R
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM
      CALL FM_UNDEF_INP(MA)
      CALL IMI2FM(MA%MIM,MULVFM)
      DO J = 1, SIZE(R,DIM=1)
         DO K = 1, SIZE(R,DIM=2)
            CALL FMSP2M(R(J,K),MTLVFM)
            CALL FMADD(MULVFM,MTLVFM,RETURN_VALUE(J,K)%MFM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_IMR2

   FUNCTION FMADD_IMD2(MA,D)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA
      DOUBLE PRECISION, DIMENSION(:,:) :: D
      TYPE (FM), DIMENSION(SIZE(D,DIM=1),SIZE(D,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,D
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM
      CALL FM_UNDEF_INP(MA)
      CALL IMI2FM(MA%MIM,MULVFM)
      DO J = 1, SIZE(D,DIM=1)
         DO K = 1, SIZE(D,DIM=2)
            CALL FMDP2M(D(J,K),MTLVFM)
            CALL FMADD(MULVFM,MTLVFM,RETURN_VALUE(J,K)%MFM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_IMD2

   FUNCTION FMADD_IMZ2(MA,Z)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA
      COMPLEX, DIMENSION(:,:) :: Z
      TYPE (ZM), DIMENSION(SIZE(Z,DIM=1),SIZE(Z,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,Z
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL IMI2FM(MA%MIM,MTLVFM)
      CALL FMI2M(0,MULVFM)
      DO J = 1, SIZE(Z,DIM=1)
         DO K = 1, SIZE(Z,DIM=2)
            CALL ZMZ2M(Z(J,K),MTLVZM)
            CALL ZMCMPX(MTLVFM,MULVFM,MULVZM)
            CALL ZMADD(MULVZM,MTLVZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_IMZ2

   FUNCTION FMADD_IMC2(MA,C)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA
      COMPLEX (KIND(0.0D0)), DIMENSION(:,:) :: C
      TYPE (ZM), DIMENSION(SIZE(C,DIM=1),SIZE(C,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,C
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MVLVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL IMI2FM(MA%MIM,MVLVFM)
      DO J = 1, SIZE(C,DIM=1)
         DO K = 1, SIZE(C,DIM=2)
            CALL FMDP2M(REAL(C(J,K),KIND(0.0D0)),MTLVFM)
            CALL FMDP2M(AIMAG(C(J,K)),MULVFM)
            CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
            CALL FMI2M(0,MULVFM)
            CALL ZMCMPX(MVLVFM,MULVFM,MULVZM)
            CALL ZMADD(MULVZM,MTLVZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_IMC2

   FUNCTION FMADD_IMIM2(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA
      TYPE (IM), DIMENSION(:,:) :: MB
      TYPE (IM), DIMENSION(SIZE(MB,DIM=1),SIZE(MB,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,MB
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      DO J = 1, SIZE(MB,DIM=1)
         DO K = 1, SIZE(MB,DIM=2)
            CALL IMADD(MA%MIM,MB(J,K)%MIM,RETURN_VALUE(J,K)%MIM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_IMIM2

   FUNCTION FMADD_ZMIM2(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA
      TYPE (IM), DIMENSION(:,:) :: MB
      TYPE (ZM), DIMENSION(SIZE(MB,DIM=1),SIZE(MB,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVFM,MVLVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      CALL FMI2M(0,MTLVFM)
      DO J = 1, SIZE(MB,DIM=1)
         DO K = 1, SIZE(MB,DIM=2)
            CALL IMI2FM(MB(J,K)%MIM,MVLVFM)
            CALL ZMCMPX(MVLVFM,MTLVFM,MTLVZM)
            CALL ZMADD(MA%MZM,MTLVZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_ZMIM2

   FUNCTION FMADD_IMZM2(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA
      TYPE (ZM), DIMENSION(:,:) :: MB
      TYPE (ZM), DIMENSION(SIZE(MB,DIM=1),SIZE(MB,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVFM,MVLVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      CALL IMI2FM(MA%MIM,MVLVFM)
      CALL FMI2M(0,MTLVFM)
      CALL ZMCMPX(MVLVFM,MTLVFM,MTLVZM)
      DO J = 1, SIZE(MB,DIM=1)
         DO K = 1, SIZE(MB,DIM=2)
            CALL ZMADD(MTLVZM,MB(J,K)%MZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_IMZM2

!             (5) rank 2  +  rank 0

   FUNCTION FMADD_IM2I(MA,IVAL)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:,:) :: MA
      TYPE (IM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: IVAL,J,K
      INTENT (IN) :: MA,IVAL
      TYPE(MULTI), SAVE :: MTLVIM
      CALL FM_UNDEF_INP(MA)
      CALL IMI2M(IVAL,MTLVIM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL IMADD(MA(J,K)%MIM,MTLVIM,RETURN_VALUE(J,K)%MIM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_IM2I

   FUNCTION FMADD_IM2R(MA,R)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:,:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      REAL :: R
      INTENT (IN) :: MA,R
      TYPE(MULTI), SAVE :: MTLVFM,MVLVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMSP2M(R,MTLVFM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL IMI2FM(MA(J,K)%MIM,MVLVFM)
            CALL FMADD(MVLVFM,MTLVFM,RETURN_VALUE(J,K)%MFM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_IM2R

   FUNCTION FMADD_IM2D(MA,D)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:,:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      DOUBLE PRECISION :: D
      INTENT (IN) :: MA,D
      TYPE(MULTI), SAVE :: MTLVFM,MVLVFM
      CALL FM_UNDEF_INP(MA)
      CALL FMDP2M(D,MTLVFM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL IMI2FM(MA(J,K)%MIM,MVLVFM)
            CALL FMADD(MVLVFM,MTLVFM,RETURN_VALUE(J,K)%MFM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_IM2D

   FUNCTION FMADD_IM2Z(MA,Z)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:,:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      COMPLEX :: Z
      INTENT (IN) :: MA,Z
      TYPE(MULTI), SAVE :: MULVFM,MVLVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL ZMZ2M(Z,MTLVZM)
      CALL FMI2M(0,MULVFM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL IMI2FM(MA(J,K)%MIM,MVLVFM)
            CALL ZMCMPX(MVLVFM,MULVFM,MULVZM)
            CALL ZMADD(MULVZM,MTLVZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_IM2Z

   FUNCTION FMADD_IM2C(MA,C)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:,:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      COMPLEX (KIND(0.0D0)) :: C
      INTENT (IN) :: MA,C
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MVLVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FMDP2M(REAL(C,KIND(0.0D0)),MTLVFM)
      CALL FMDP2M(AIMAG(C),MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
      CALL FMI2M(0,MULVFM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL IMI2FM(MA(J,K)%MIM,MVLVFM)
            CALL ZMCMPX(MVLVFM,MULVFM,MULVZM)
            CALL ZMADD(MULVZM,MTLVZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_IM2C

   FUNCTION FMADD_I2IM(IVAL,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA
      INTEGER, DIMENSION(:,:) :: IVAL
      TYPE (IM), DIMENSION(SIZE(IVAL,DIM=1),SIZE(IVAL,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,IVAL
      TYPE(MULTI), SAVE :: MTLVIM
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(IVAL,DIM=1)
         DO K = 1, SIZE(IVAL,DIM=2)
            CALL IMI2M(IVAL(J,K),MTLVIM)
            CALL IMADD(MTLVIM,MA%MIM,RETURN_VALUE(J,K)%MIM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_I2IM

   FUNCTION FMADD_R2IM(R,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA
      REAL, DIMENSION(:,:) :: R
      TYPE (FM), DIMENSION(SIZE(R,DIM=1),SIZE(R,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,R
      TYPE(MULTI), SAVE :: MTLVFM,MVLVFM
      CALL FM_UNDEF_INP(MA)
      CALL IMI2FM(MA%MIM,MVLVFM)
      DO J = 1, SIZE(R,DIM=1)
         DO K = 1, SIZE(R,DIM=2)
            CALL FMSP2M(R(J,K),MTLVFM)
            CALL FMADD(MTLVFM,MVLVFM,RETURN_VALUE(J,K)%MFM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_R2IM

   FUNCTION FMADD_D2IM(D,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA
      DOUBLE PRECISION, DIMENSION(:,:) :: D
      TYPE (FM), DIMENSION(SIZE(D,DIM=1),SIZE(D,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,D
      TYPE(MULTI), SAVE :: MTLVFM,MVLVFM
      CALL FM_UNDEF_INP(MA)
      CALL IMI2FM(MA%MIM,MVLVFM)
      DO J = 1, SIZE(D,DIM=1)
         DO K = 1, SIZE(D,DIM=2)
            CALL FMDP2M(D(J,K),MTLVFM)
            CALL FMADD(MTLVFM,MVLVFM,RETURN_VALUE(J,K)%MFM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_D2IM

   FUNCTION FMADD_Z2IM(Z,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA
      COMPLEX, DIMENSION(:,:) :: Z
      TYPE (ZM), DIMENSION(SIZE(Z,DIM=1),SIZE(Z,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,Z
      TYPE(MULTI), SAVE :: MULVFM,MVLVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL IMI2FM(MA%MIM,MVLVFM)
      CALL FMI2M(0,MULVFM)
      DO J = 1, SIZE(Z,DIM=1)
         DO K = 1, SIZE(Z,DIM=2)
            CALL ZMZ2M(Z(J,K),MTLVZM)
            CALL ZMCMPX(MVLVFM,MULVFM,MULVZM)
            CALL ZMADD(MTLVZM,MULVZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_Z2IM

   FUNCTION FMADD_C2IM(C,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM) :: MA
      COMPLEX (KIND(0.0D0)), DIMENSION(:,:) :: C
      TYPE (ZM), DIMENSION(SIZE(C,DIM=1),SIZE(C,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,C
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,M1LVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL IMI2FM(MA%MIM,M1LVFM)
      DO J = 1, SIZE(C,DIM=1)
         DO K = 1, SIZE(C,DIM=2)
            CALL FMDP2M(REAL(C(J,K),KIND(0.0D0)),MTLVFM)
            CALL FMDP2M(AIMAG(C(J,K)),MULVFM)
            CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
            CALL FMI2M(0,MULVFM)
            CALL ZMCMPX(M1LVFM,MULVFM,MULVZM)
            CALL ZMADD(MTLVZM,MULVZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_C2IM

   FUNCTION FMADD_IM2IM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:,:) :: MA
      TYPE (IM) :: MB
      TYPE (IM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,MB
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL IMADD(MA(J,K)%MIM,MB%MIM,RETURN_VALUE(J,K)%MIM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_IM2IM

   FUNCTION FMADD_IM2ZM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:,:) :: MA
      TYPE (ZM) :: MB
      TYPE (ZM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVFM,M1LVFM,M1LVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      CALL FMI2M(0,MTLVFM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL IMI2FM(MA(J,K)%MIM,M1LVFM)
            CALL ZMCMPX(M1LVFM,MTLVFM,M1LVZM)
            CALL ZMADD(M1LVZM,MB%MZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_IM2ZM

   FUNCTION FMADD_ZM2IM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      TYPE (IM) :: MB
      TYPE (ZM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVFM,M1LVFM,M1LVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      CALL IMI2FM(MB%MIM,M1LVFM)
      CALL FMI2M(0,MTLVFM)
      CALL ZMCMPX(M1LVFM,MTLVFM,M1LVZM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMADD(MA(J,K)%MZM,M1LVZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_ZM2IM

!             (6) rank 2  +  rank 2

   FUNCTION FMADD_IM2I2(MA,IVAL)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:,:) :: MA
      TYPE (IM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER, DIMENSION(:,:) :: IVAL
      INTEGER :: J,K
      INTENT (IN) :: MA,IVAL
      TYPE(MULTI), SAVE :: MTLVIM
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA,DIM=1) /= SIZE(IVAL,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(IVAL,DIM=2)) THEN
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                CALL IMST2M(' UNKNOWN ',RETURN_VALUE(J,K)%MIM)
             ENDDO
          ENDDO
          RETURN
      ENDIF
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL IMI2M(IVAL(J,K),MTLVIM)
            CALL IMADD(MA(J,K)%MIM,MTLVIM,RETURN_VALUE(J,K)%MIM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_IM2I2

   FUNCTION FMADD_IM2R2(MA,R)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:,:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      REAL, DIMENSION(:,:) :: R
      INTENT (IN) :: MA,R
      TYPE(MULTI), SAVE :: MTLVFM,M1LVFM
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA,DIM=1) /= SIZE(R,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(R,DIM=2)) THEN
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                CALL FMST2M(' UNKNOWN ',RETURN_VALUE(J,K)%MFM)
             ENDDO
          ENDDO
          RETURN
      ENDIF
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMSP2M(R(J,K),MTLVFM)
            CALL IMI2FM(MA(J,K)%MIM,M1LVFM)
            CALL FMADD(M1LVFM,MTLVFM,RETURN_VALUE(J,K)%MFM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_IM2R2

   FUNCTION FMADD_IM2D2(MA,D)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:,:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      DOUBLE PRECISION, DIMENSION(:,:) :: D
      INTENT (IN) :: MA,D
      TYPE(MULTI), SAVE :: MTLVFM,M1LVFM
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA,DIM=1) /= SIZE(D,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(D,DIM=2)) THEN
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                CALL FMST2M(' UNKNOWN ',RETURN_VALUE(J,K)%MFM)
             ENDDO
          ENDDO
          RETURN
      ENDIF
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMDP2M(D(J,K),MTLVFM)
            CALL IMI2FM(MA(J,K)%MIM,M1LVFM)
            CALL FMADD(M1LVFM,MTLVFM,RETURN_VALUE(J,K)%MFM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_IM2D2

   FUNCTION FMADD_IM2Z2(MA,Z)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:,:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      COMPLEX, DIMENSION(:,:) :: Z
      INTENT (IN) :: MA,Z
      TYPE(MULTI), SAVE :: MULVFM,M1LVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA,DIM=1) /= SIZE(Z,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(Z,DIM=2)) THEN
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                CALL ZMST2M(' UNKNOWN + UNKNOWN i ',RETURN_VALUE(J,K)%MZM)
             ENDDO
          ENDDO
          RETURN
      ENDIF
      CALL FMI2M(0,MULVFM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMZ2M(Z(J,K),MTLVZM)
            CALL IMI2FM(MA(J,K)%MIM,M1LVFM)
            CALL ZMCMPX(M1LVFM,MULVFM,MULVZM)
            CALL ZMADD(MULVZM,MTLVZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_IM2Z2

   FUNCTION FMADD_IM2C2(MA,C)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:,:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      COMPLEX (KIND(0.0D0)), DIMENSION(:,:) :: C
      INTENT (IN) :: MA,C
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,M1LVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA,DIM=1) /= SIZE(C,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(C,DIM=2)) THEN
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                CALL ZMST2M(' UNKNOWN + UNKNOWN i ',RETURN_VALUE(J,K)%MZM)
             ENDDO
          ENDDO
          RETURN
      ENDIF
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMDP2M(REAL(C(J,K),KIND(0.0D0)),MTLVFM)
            CALL FMDP2M(AIMAG(C(J,K)),MULVFM)
            CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
            CALL IMI2FM(MA(J,K)%MIM,M1LVFM)
            CALL FMI2M(0,MULVFM)
            CALL ZMCMPX(M1LVFM,MULVFM,MULVZM)
            CALL ZMADD(MULVZM,MTLVZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_IM2C2

   FUNCTION FMADD_I2IM2(IVAL,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:,:) :: MA
      INTEGER, DIMENSION(:,:) :: IVAL
      TYPE (IM), DIMENSION(SIZE(IVAL,DIM=1),SIZE(IVAL,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,IVAL
      TYPE(MULTI), SAVE :: MTLVIM
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA,DIM=1) /= SIZE(IVAL,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(IVAL,DIM=2)) THEN
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                CALL IMST2M(' UNKNOWN ',RETURN_VALUE(J,K)%MIM)
             ENDDO
          ENDDO
          RETURN
      ENDIF
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL IMI2M(IVAL(J,K),MTLVIM)
            CALL IMADD(MTLVIM,MA(J,K)%MIM,RETURN_VALUE(J,K)%MIM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_I2IM2

   FUNCTION FMADD_R2IM2(R,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:,:) :: MA
      REAL, DIMENSION(:,:) :: R
      TYPE (FM), DIMENSION(SIZE(R,DIM=1),SIZE(R,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,R
      TYPE(MULTI), SAVE :: MTLVFM,M1LVFM
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA,DIM=1) /= SIZE(R,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(R,DIM=2)) THEN
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                CALL FMST2M(' UNKNOWN ',RETURN_VALUE(J,K)%MFM)
             ENDDO
          ENDDO
          RETURN
      ENDIF
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL IMI2FM(MA(J,K)%MIM,M1LVFM)
            CALL FMSP2M(R(J,K),MTLVFM)
            CALL FMADD(MTLVFM,M1LVFM,RETURN_VALUE(J,K)%MFM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_R2IM2

   FUNCTION FMADD_D2IM2(D,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:,:) :: MA
      DOUBLE PRECISION, DIMENSION(:,:) :: D
      TYPE (FM), DIMENSION(SIZE(D,DIM=1),SIZE(D,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,D
      TYPE(MULTI), SAVE :: MTLVFM,M1LVFM
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA,DIM=1) /= SIZE(D,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(D,DIM=2)) THEN
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                CALL FMST2M(' UNKNOWN ',RETURN_VALUE(J,K)%MFM)
             ENDDO
          ENDDO
          RETURN
      ENDIF
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL IMI2FM(MA(J,K)%MIM,M1LVFM)
            CALL FMDP2M(D(J,K),MTLVFM)
            CALL FMADD(MTLVFM,M1LVFM,RETURN_VALUE(J,K)%MFM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_D2IM2

   FUNCTION FMADD_Z2IM2(Z,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:,:) :: MA
      COMPLEX, DIMENSION(:,:) :: Z
      TYPE (ZM), DIMENSION(SIZE(Z,DIM=1),SIZE(Z,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,Z
      TYPE(MULTI), SAVE :: MULVFM,M1LVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA,DIM=1) /= SIZE(Z,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(Z,DIM=2)) THEN
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                CALL ZMST2M(' UNKNOWN + UNKNOWN i ',RETURN_VALUE(J,K)%MZM)
             ENDDO
          ENDDO
          RETURN
      ENDIF
      CALL FMI2M(0,MULVFM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMZ2M(Z(J,K),MTLVZM)
            CALL IMI2FM(MA(J,K)%MIM,M1LVFM)
            CALL ZMCMPX(M1LVFM,MULVFM,MULVZM)
            CALL ZMADD(MTLVZM,MULVZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_Z2IM2

   FUNCTION FMADD_C2IM2(C,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:,:) :: MA
      COMPLEX (KIND(0.0D0)), DIMENSION(:,:) :: C
      TYPE (ZM), DIMENSION(SIZE(C,DIM=1),SIZE(C,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,C
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,M1LVFM,MTLVZM(2),MULVZM(2)
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA,DIM=1) /= SIZE(C,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(C,DIM=2)) THEN
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                CALL ZMST2M(' UNKNOWN + UNKNOWN i ',RETURN_VALUE(J,K)%MZM)
             ENDDO
          ENDDO
          RETURN
      ENDIF
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL IMI2FM(MA(J,K)%MIM,M1LVFM)
            CALL FMDP2M(REAL(C(J,K),KIND(0.0D0)),MTLVFM)
            CALL FMDP2M(AIMAG(C(J,K)),MULVFM)
            CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
            CALL FMI2M(0,MULVFM)
            CALL ZMCMPX(M1LVFM,MULVFM,MULVZM)
            CALL ZMADD(MTLVZM,MULVZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_C2IM2

   FUNCTION FMADD_IM2IM2(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:,:) :: MA
      TYPE (IM), DIMENSION(:,:) :: MB
      TYPE (IM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,MB
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      IF (SIZE(MA,DIM=1) /= SIZE(MB,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(MB,DIM=2)) THEN
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                CALL IMST2M(' UNKNOWN ',RETURN_VALUE(J,K)%MIM)
             ENDDO
          ENDDO
          RETURN
      ENDIF
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL IMADD(MA(J,K)%MIM,MB(J,K)%MIM,RETURN_VALUE(J,K)%MIM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_IM2IM2

   FUNCTION FMADD_IM2ZM2(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:,:) :: MA
      TYPE (ZM), DIMENSION(:,:) :: MB
      TYPE (ZM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVFM,M1LVFM,M1LVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      IF (SIZE(MA,DIM=1) /= SIZE(MB,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(MB,DIM=2)) THEN
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                CALL ZMST2M(' UNKNOWN + UNKNOWN i ',RETURN_VALUE(J,K)%MZM)
             ENDDO
          ENDDO
          RETURN
      ENDIF
      CALL FMI2M(0,MTLVFM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL IMI2FM(MA(J,K)%MIM,M1LVFM)
            CALL ZMCMPX(M1LVFM,MTLVFM,M1LVZM)
            CALL ZMADD(M1LVZM,MB(J,K)%MZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_IM2ZM2

   FUNCTION FMADD_ZM2IM2(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      TYPE (IM), DIMENSION(:,:) :: MB
      TYPE (ZM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,MB
      TYPE(MULTI), SAVE :: MTLVFM,M1LVFM,M1LVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      IF (SIZE(MA,DIM=1) /= SIZE(MB,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(MB,DIM=2)) THEN
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                CALL ZMST2M(' UNKNOWN + UNKNOWN i ',RETURN_VALUE(J,K)%MZM)
             ENDDO
          ENDDO
          RETURN
      ENDIF
      CALL FMI2M(0,MTLVFM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL IMI2FM(MB(J,K)%MIM,M1LVFM)
            CALL ZMCMPX(M1LVFM,MTLVFM,M1LVZM)
            CALL ZMADD(MA(J,K)%MZM,M1LVZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_ZM2IM2

!             Array addition operations for ZM.

!             (1) rank 0  +  rank 1

   FUNCTION FMADD_IZM1(IVAL,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: IVAL,J,N
      INTENT (IN) :: MA,IVAL
      TYPE(MULTI), SAVE :: MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      CALL ZMI2M(IVAL,MTLVZM)
      DO J = 1, N
         CALL ZMADD(MTLVZM,MA(J)%MZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_IZM1

   FUNCTION FMADD_RZM1(R,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      REAL :: R
      INTENT (IN) :: MA,R
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      CALL FMSP2M(R,MTLVFM)
      CALL FMI2M(0,MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
      DO J = 1, N
         CALL ZMADD(MTLVZM,MA(J)%MZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_RZM1

   FUNCTION FMADD_DZM1(D,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      DOUBLE PRECISION :: D
      INTENT (IN) :: MA,D
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      CALL FMDP2M(D,MTLVFM)
      CALL FMI2M(0,MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
      DO J = 1, N
         CALL ZMADD(MTLVZM,MA(J)%MZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_DZM1

   FUNCTION FMADD_ZZM1(Z,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      COMPLEX :: Z
      INTENT (IN) :: MA,Z
      TYPE(MULTI), SAVE :: MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      CALL ZMZ2M(Z,MTLVZM)
      DO J = 1, N
         CALL ZMADD(MTLVZM,MA(J)%MZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_ZZM1

   FUNCTION FMADD_CZM1(C,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      COMPLEX (KIND(0.0D0)) :: C
      INTENT (IN) :: MA,C
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      CALL FMDP2M(REAL(C,KIND(0.0D0)),MTLVFM)
      CALL FMDP2M(AIMAG(C),MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
      DO J = 1, N
         CALL ZMADD(MTLVZM,MA(J)%MZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_CZM1

   FUNCTION FMADD_ZMI1(MA,IVAL)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA
      INTEGER, DIMENSION(:) :: IVAL
      TYPE (ZM), DIMENSION(SIZE(IVAL)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,IVAL
      TYPE(MULTI), SAVE :: MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      N = SIZE(IVAL)
      DO J = 1, N
         CALL ZMI2M(IVAL(J),MTLVZM)
         CALL ZMADD(MA%MZM,MTLVZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_ZMI1

   FUNCTION FMADD_ZMR1(MA,R)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA
      REAL, DIMENSION(:) :: R
      TYPE (ZM), DIMENSION(SIZE(R)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,R
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      N = SIZE(R)
      CALL FMI2M(0,MULVFM)
      DO J = 1, N
         CALL FMSP2M(R(J),MTLVFM)
         CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
         CALL ZMADD(MA%MZM,MTLVZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_ZMR1

   FUNCTION FMADD_ZMD1(MA,D)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA
      DOUBLE PRECISION, DIMENSION(:) :: D
      TYPE (ZM), DIMENSION(SIZE(D)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,D
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      N = SIZE(D)
      CALL FMI2M(0,MULVFM)
      DO J = 1, N
         CALL FMDP2M(D(J),MTLVFM)
         CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
         CALL ZMADD(MA%MZM,MTLVZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_ZMD1

   FUNCTION FMADD_ZMZ1(MA,Z)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA
      COMPLEX, DIMENSION(:) :: Z
      TYPE (ZM), DIMENSION(SIZE(Z)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,Z
      TYPE(MULTI), SAVE :: MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      N = SIZE(Z)
      DO J = 1, N
         CALL ZMZ2M(Z(J),MTLVZM)
         CALL ZMADD(MA%MZM,MTLVZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_ZMZ1

   FUNCTION FMADD_ZMC1(MA,C)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA
      COMPLEX (KIND(0.0D0)), DIMENSION(:) :: C
      TYPE (ZM), DIMENSION(SIZE(C)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,C
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      N = SIZE(C)
      DO J = 1, N
         CALL FMDP2M(REAL(C(J),KIND(0.0D0)),MTLVFM)
         CALL FMDP2M(AIMAG(C(J)),MULVFM)
         CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
         CALL ZMADD(MA%MZM,MTLVZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_ZMC1

   FUNCTION FMADD_ZMZM1(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA
      TYPE (ZM), DIMENSION(:) :: MB
      TYPE (ZM), DIMENSION(SIZE(MB)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,MB
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      N = SIZE(MB)
      DO J = 1, N
         CALL ZMADD(MA%MZM,MB(J)%MZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_ZMZM1

!             (2) rank 1  +  rank 0

   FUNCTION FMADD_ZM1I(MA,IVAL)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: IVAL,J,N
      INTENT (IN) :: MA,IVAL
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      CALL FMI2M(IVAL,MTLVFM)
      CALL FMI2M(0,MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
      DO J = 1, N
         CALL ZMADD(MA(J)%MZM,MTLVZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_ZM1I

   FUNCTION FMADD_ZM1R(MA,R)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      REAL :: R
      INTENT (IN) :: MA,R
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      CALL FMSP2M(R,MTLVFM)
      CALL FMI2M(0,MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
      DO J = 1, N
         CALL ZMADD(MA(J)%MZM,MTLVZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_ZM1R

   FUNCTION FMADD_ZM1D(MA,D)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      DOUBLE PRECISION :: D
      INTENT (IN) :: MA,D
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      CALL FMDP2M(D,MTLVFM)
      CALL FMI2M(0,MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
      DO J = 1, N
         CALL ZMADD(MA(J)%MZM,MTLVZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_ZM1D

   FUNCTION FMADD_ZM1Z(MA,Z)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      COMPLEX :: Z
      INTENT (IN) :: MA,Z
      TYPE(MULTI), SAVE :: MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      CALL ZMZ2M(Z,MTLVZM)
      DO J = 1, N
         CALL ZMADD(MA(J)%MZM,MTLVZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_ZM1Z

   FUNCTION FMADD_ZM1C(MA,C)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      COMPLEX (KIND(0.0D0)) :: C
      INTENT (IN) :: MA,C
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      CALL FMDP2M(REAL(C,KIND(0.0D0)),MTLVFM)
      CALL FMDP2M(AIMAG(C),MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
      DO J = 1, N
         CALL ZMADD(MA(J)%MZM,MTLVZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_ZM1C

   FUNCTION FMADD_I1ZM(IVAL,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA
      INTEGER, DIMENSION(:) :: IVAL
      TYPE (ZM), DIMENSION(SIZE(IVAL)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,IVAL
      TYPE(MULTI), SAVE :: MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      N = SIZE(IVAL)
      DO J = 1, N
         CALL ZMI2M(IVAL(J),MTLVZM)
         CALL ZMADD(MTLVZM,MA%MZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_I1ZM

   FUNCTION FMADD_R1ZM(R,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA
      REAL, DIMENSION(:) :: R
      TYPE (ZM), DIMENSION(SIZE(R)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,R
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      N = SIZE(R)
      CALL FMI2M(0,MULVFM)
      DO J = 1, N
         CALL FMSP2M(R(J),MTLVFM)
         CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
         CALL ZMADD(MTLVZM,MA%MZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_R1ZM

   FUNCTION FMADD_D1ZM(D,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA
      DOUBLE PRECISION, DIMENSION(:) :: D
      TYPE (ZM), DIMENSION(SIZE(D)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,D
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      N = SIZE(D)
      CALL FMI2M(0,MULVFM)
      DO J = 1, N
         CALL FMDP2M(D(J),MTLVFM)
         CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
         CALL ZMADD(MTLVZM,MA%MZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_D1ZM

   FUNCTION FMADD_Z1ZM(Z,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA
      COMPLEX, DIMENSION(:) :: Z
      TYPE (ZM), DIMENSION(SIZE(Z)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,Z
      TYPE(MULTI), SAVE :: MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      N = SIZE(Z)
      DO J = 1, N
         CALL ZMZ2M(Z(J),MTLVZM)
         CALL ZMADD(MTLVZM,MA%MZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_Z1ZM

   FUNCTION FMADD_C1ZM(C,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA
      COMPLEX (KIND(0.0D0)), DIMENSION(:) :: C
      TYPE (ZM), DIMENSION(SIZE(C)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,C
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      N = SIZE(C)
      DO J = 1, N
         CALL FMDP2M(REAL(C(J),KIND(0.0D0)),MTLVFM)
         CALL FMDP2M(AIMAG(C(J)),MULVFM)
         CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
         CALL ZMADD(MTLVZM,MA%MZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_C1ZM

   FUNCTION FMADD_ZM1ZM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      TYPE (ZM) :: MB
      TYPE (ZM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,MB
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      N = SIZE(MA)
      DO J = 1, N
         CALL ZMADD(MA(J)%MZM,MB%MZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_ZM1ZM

!             (3) rank 1  +  rank 1

   FUNCTION FMADD_ZM1I1(MA,IVAL)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER, DIMENSION(:) :: IVAL
      INTEGER :: J,N
      INTENT (IN) :: MA,IVAL
      TYPE(MULTI), SAVE :: MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA) /= SIZE(IVAL)) THEN
          DO J = 1, SIZE(MA)
             CALL ZMST2M(' UNKNOWN + UNKNOWN i ',RETURN_VALUE(J)%MZM)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(MA)
      DO J = 1, N
         CALL ZMI2M(IVAL(J),MTLVZM)
         CALL ZMADD(MA(J)%MZM,MTLVZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_ZM1I1

   FUNCTION FMADD_ZM1R1(MA,R)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      REAL, DIMENSION(:) :: R
      INTENT (IN) :: MA,R
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA) /= SIZE(R)) THEN
          DO J = 1, SIZE(MA)
             CALL ZMST2M(' UNKNOWN + UNKNOWN i ',RETURN_VALUE(J)%MZM)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(MA)
      CALL FMI2M(0,MULVFM)
      DO J = 1, N
         CALL FMSP2M(R(J),MTLVFM)
         CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
         CALL ZMADD(MA(J)%MZM,MTLVZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_ZM1R1

   FUNCTION FMADD_ZM1D1(MA,D)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      DOUBLE PRECISION, DIMENSION(:) :: D
      INTENT (IN) :: MA,D
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA) /= SIZE(D)) THEN
          DO J = 1, SIZE(MA)
             CALL ZMST2M(' UNKNOWN + UNKNOWN i ',RETURN_VALUE(J)%MZM)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(MA)
      CALL FMI2M(0,MULVFM)
      DO J = 1, N
         CALL FMDP2M(D(J),MTLVFM)
         CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
         CALL ZMADD(MA(J)%MZM,MTLVZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_ZM1D1

   FUNCTION FMADD_ZM1Z1(MA,Z)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      COMPLEX, DIMENSION(:) :: Z
      INTENT (IN) :: MA,Z
      TYPE(MULTI), SAVE :: MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA) /= SIZE(Z)) THEN
          DO J = 1, SIZE(MA)
             CALL ZMST2M(' UNKNOWN + UNKNOWN i ',RETURN_VALUE(J)%MZM)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(MA)
      DO J = 1, N
         CALL ZMZ2M(Z(J),MTLVZM)
         CALL ZMADD(MA(J)%MZM,MTLVZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_ZM1Z1

   FUNCTION FMADD_ZM1C1(MA,C)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      COMPLEX (KIND(0.0D0)), DIMENSION(:) :: C
      INTENT (IN) :: MA,C
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA) /= SIZE(C)) THEN
          DO J = 1, SIZE(MA)
             CALL ZMST2M(' UNKNOWN + UNKNOWN i ',RETURN_VALUE(J)%MZM)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(MA)
      DO J = 1, N
         CALL FMDP2M(REAL(C(J),KIND(0.0D0)),MTLVFM)
         CALL FMDP2M(AIMAG(C(J)),MULVFM)
         CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
         CALL ZMADD(MA(J)%MZM,MTLVZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_ZM1C1

   FUNCTION FMADD_I1ZM1(IVAL,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      INTEGER, DIMENSION(:) :: IVAL
      TYPE (ZM), DIMENSION(SIZE(IVAL)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,IVAL
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA) /= SIZE(IVAL)) THEN
          DO J = 1, SIZE(MA)
             CALL ZMST2M(' UNKNOWN + UNKNOWN i ',RETURN_VALUE(J)%MZM)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(IVAL)
      CALL FMI2M(0,MULVFM)
      DO J = 1, N
         CALL FMI2M(IVAL(J),MTLVFM)
         CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
         CALL ZMADD(MTLVZM,MA(J)%MZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_I1ZM1

   FUNCTION FMADD_R1ZM1(R,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      REAL, DIMENSION(:) :: R
      TYPE (ZM), DIMENSION(SIZE(R)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,R
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA) /= SIZE(R)) THEN
          DO J = 1, SIZE(MA)
             CALL ZMST2M(' UNKNOWN + UNKNOWN i ',RETURN_VALUE(J)%MZM)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(R)
      CALL FMI2M(0,MULVFM)
      DO J = 1, N
         CALL FMSP2M(R(J),MTLVFM)
         CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
         CALL ZMADD(MTLVZM,MA(J)%MZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_R1ZM1

   FUNCTION FMADD_D1ZM1(D,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      DOUBLE PRECISION, DIMENSION(:) :: D
      TYPE (ZM), DIMENSION(SIZE(D)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,D
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA) /= SIZE(D)) THEN
          DO J = 1, SIZE(MA)
             CALL ZMST2M(' UNKNOWN + UNKNOWN i ',RETURN_VALUE(J)%MZM)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(D)
      CALL FMI2M(0,MULVFM)
      DO J = 1, N
         CALL FMDP2M(D(J),MTLVFM)
         CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
         CALL ZMADD(MTLVZM,MA(J)%MZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_D1ZM1

   FUNCTION FMADD_Z1ZM1(Z,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      COMPLEX, DIMENSION(:) :: Z
      TYPE (ZM), DIMENSION(SIZE(Z)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,Z
      TYPE(MULTI), SAVE :: MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA) /= SIZE(Z)) THEN
          DO J = 1, SIZE(MA)
             CALL ZMST2M(' UNKNOWN + UNKNOWN i ',RETURN_VALUE(J)%MZM)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(Z)
      DO J = 1, N
         CALL ZMZ2M(Z(J),MTLVZM)
         CALL ZMADD(MTLVZM,MA(J)%MZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_Z1ZM1

   FUNCTION FMADD_C1ZM1(C,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      COMPLEX (KIND(0.0D0)), DIMENSION(:) :: C
      TYPE (ZM), DIMENSION(SIZE(C)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,C
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA) /= SIZE(C)) THEN
          DO J = 1, SIZE(MA)
             CALL ZMST2M(' UNKNOWN + UNKNOWN i ',RETURN_VALUE(J)%MZM)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(C)
      DO J = 1, N
         CALL FMDP2M(REAL(C(J),KIND(0.0D0)),MTLVFM)
         CALL FMDP2M(AIMAG(C(J)),MULVFM)
         CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
         CALL ZMADD(MTLVZM,MA(J)%MZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_C1ZM1

   FUNCTION FMADD_ZM1ZM1(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      TYPE (ZM), DIMENSION(:) :: MB
      TYPE (ZM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA,MB
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      IF (SIZE(MA) /= SIZE(MB)) THEN
          DO J = 1, SIZE(MA)
             CALL ZMST2M(' UNKNOWN + UNKNOWN i ',RETURN_VALUE(J)%MZM)
          ENDDO
          RETURN
      ENDIF
      N = SIZE(MA)
      DO J = 1, N
         CALL ZMADD(MA(J)%MZM,MB(J)%MZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_ZM1ZM1

!             (4) rank 0  +  rank 2

   FUNCTION FMADD_IZM2(IVAL,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: IVAL,J,K
      INTENT (IN) :: MA,IVAL
      TYPE(MULTI), SAVE :: MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL ZMI2M(IVAL,MTLVZM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMADD(MTLVZM,MA(J,K)%MZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_IZM2

   FUNCTION FMADD_RZM2(R,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      REAL :: R
      INTENT (IN) :: MA,R
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FMSP2M(R,MTLVFM)
      CALL FMI2M(0,MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMADD(MTLVZM,MA(J,K)%MZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_RZM2

   FUNCTION FMADD_DZM2(D,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      DOUBLE PRECISION :: D
      INTENT (IN) :: MA,D
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FMDP2M(D,MTLVFM)
      CALL FMI2M(0,MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMADD(MTLVZM,MA(J,K)%MZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_DZM2

   FUNCTION FMADD_ZZM2(Z,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      COMPLEX :: Z
      INTENT (IN) :: MA,Z
      TYPE(MULTI), SAVE :: MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL ZMZ2M(Z,MTLVZM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMADD(MTLVZM,MA(J,K)%MZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_ZZM2

   FUNCTION FMADD_CZM2(C,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      COMPLEX (KIND(0.0D0)) :: C
      INTENT (IN) :: MA,C
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FMDP2M(REAL(C,KIND(0.0D0)),MTLVFM)
      CALL FMDP2M(AIMAG(C),MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMADD(MTLVZM,MA(J,K)%MZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_CZM2

   FUNCTION FMADD_ZMI2(MA,IVAL)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA
      INTEGER, DIMENSION(:,:) :: IVAL
      TYPE (ZM), DIMENSION(SIZE(IVAL,DIM=1),SIZE(IVAL,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,IVAL
      TYPE(MULTI), SAVE :: MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(IVAL,DIM=1)
         DO K = 1, SIZE(IVAL,DIM=2)
            CALL ZMI2M(IVAL(J,K),MTLVZM)
            CALL ZMADD(MA%MZM,MTLVZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_ZMI2

   FUNCTION FMADD_ZMR2(MA,R)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA
      REAL, DIMENSION(:,:) :: R
      TYPE (ZM), DIMENSION(SIZE(R,DIM=1),SIZE(R,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,R
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FMI2M(0,MULVFM)
      DO J = 1, SIZE(R,DIM=1)
         DO K = 1, SIZE(R,DIM=2)
            CALL FMSP2M(R(J,K),MTLVFM)
            CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
            CALL ZMADD(MA%MZM,MTLVZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_ZMR2

   FUNCTION FMADD_ZMD2(MA,D)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA
      DOUBLE PRECISION, DIMENSION(:,:) :: D
      TYPE (ZM), DIMENSION(SIZE(D,DIM=1),SIZE(D,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,D
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FMI2M(0,MULVFM)
      DO J = 1, SIZE(D,DIM=1)
         DO K = 1, SIZE(D,DIM=2)
            CALL FMDP2M(D(J,K),MTLVFM)
            CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
            CALL ZMADD(MA%MZM,MTLVZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_ZMD2

   FUNCTION FMADD_ZMZ2(MA,Z)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA
      COMPLEX, DIMENSION(:,:) :: Z
      TYPE (ZM), DIMENSION(SIZE(Z,DIM=1),SIZE(Z,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,Z
      TYPE(MULTI), SAVE :: MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(Z,DIM=1)
         DO K = 1, SIZE(Z,DIM=2)
            CALL ZMZ2M(Z(J,K),MTLVZM)
            CALL ZMADD(MA%MZM,MTLVZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_ZMZ2

   FUNCTION FMADD_ZMC2(MA,C)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA
      COMPLEX (KIND(0.0D0)), DIMENSION(:,:) :: C
      TYPE (ZM), DIMENSION(SIZE(C,DIM=1),SIZE(C,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,C
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(C,DIM=1)
         DO K = 1, SIZE(C,DIM=2)
            CALL FMDP2M(REAL(C(J,K),KIND(0.0D0)),MTLVFM)
            CALL FMDP2M(AIMAG(C(J,K)),MULVFM)
            CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
            CALL ZMADD(MA%MZM,MTLVZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_ZMC2

   FUNCTION FMADD_ZMZM2(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA
      TYPE (ZM), DIMENSION(:,:) :: MB
      TYPE (ZM), DIMENSION(SIZE(MB,DIM=1),SIZE(MB,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,MB
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      DO J = 1, SIZE(MB,DIM=1)
         DO K = 1, SIZE(MB,DIM=2)
            CALL ZMADD(MA%MZM,MB(J,K)%MZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_ZMZM2

!             (5) rank 2  +  rank 0

   FUNCTION FMADD_ZM2I(MA,IVAL)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: IVAL,J,K
      INTENT (IN) :: MA,IVAL
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FMI2M(IVAL,MTLVFM)
      CALL FMI2M(0,MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMADD(MA(J,K)%MZM,MTLVZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_ZM2I

   FUNCTION FMADD_ZM2R(MA,R)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      REAL :: R
      INTENT (IN) :: MA,R
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FMSP2M(R,MTLVFM)
      CALL FMI2M(0,MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMADD(MA(J,K)%MZM,MTLVZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_ZM2R

   FUNCTION FMADD_ZM2D(MA,D)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      DOUBLE PRECISION :: D
      INTENT (IN) :: MA,D
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FMDP2M(D,MTLVFM)
      CALL FMI2M(0,MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMADD(MA(J,K)%MZM,MTLVZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_ZM2D

   FUNCTION FMADD_ZM2Z(MA,Z)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      COMPLEX :: Z
      INTENT (IN) :: MA,Z
      TYPE(MULTI), SAVE :: MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL ZMZ2M(Z,MTLVZM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMADD(MA(J,K)%MZM,MTLVZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_ZM2Z

   FUNCTION FMADD_ZM2C(MA,C)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      COMPLEX (KIND(0.0D0)) :: C
      INTENT (IN) :: MA,C
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FMDP2M(REAL(C,KIND(0.0D0)),MTLVFM)
      CALL FMDP2M(AIMAG(C),MULVFM)
      CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMADD(MA(J,K)%MZM,MTLVZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_ZM2C

   FUNCTION FMADD_I2ZM(IVAL,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA
      INTEGER, DIMENSION(:,:) :: IVAL
      TYPE (ZM), DIMENSION(SIZE(IVAL,DIM=1),SIZE(IVAL,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,IVAL
      TYPE(MULTI), SAVE :: MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(IVAL,DIM=1)
         DO K = 1, SIZE(IVAL,DIM=2)
            CALL ZMI2M(IVAL(J,K),MTLVZM)
            CALL ZMADD(MTLVZM,MA%MZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_I2ZM

   FUNCTION FMADD_R2ZM(R,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA
      REAL, DIMENSION(:,:) :: R
      TYPE (ZM), DIMENSION(SIZE(R,DIM=1),SIZE(R,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,R
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FMI2M(0,MULVFM)
      DO J = 1, SIZE(R,DIM=1)
         DO K = 1, SIZE(R,DIM=2)
            CALL FMSP2M(R(J,K),MTLVFM)
            CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
            CALL ZMADD(MTLVZM,MA%MZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_R2ZM

   FUNCTION FMADD_D2ZM(D,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA
      DOUBLE PRECISION, DIMENSION(:,:) :: D
      TYPE (ZM), DIMENSION(SIZE(D,DIM=1),SIZE(D,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,D
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      CALL FMI2M(0,MULVFM)
      DO J = 1, SIZE(D,DIM=1)
         DO K = 1, SIZE(D,DIM=2)
            CALL FMDP2M(D(J,K),MTLVFM)
            CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
            CALL ZMADD(MTLVZM,MA%MZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_D2ZM

   FUNCTION FMADD_Z2ZM(Z,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA
      COMPLEX, DIMENSION(:,:) :: Z
      TYPE (ZM), DIMENSION(SIZE(Z,DIM=1),SIZE(Z,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,Z
      TYPE(MULTI), SAVE :: MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(Z,DIM=1)
         DO K = 1, SIZE(Z,DIM=2)
            CALL ZMZ2M(Z(J,K),MTLVZM)
            CALL ZMADD(MTLVZM,MA%MZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_Z2ZM

   FUNCTION FMADD_C2ZM(C,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM) :: MA
      COMPLEX (KIND(0.0D0)), DIMENSION(:,:) :: C
      TYPE (ZM), DIMENSION(SIZE(C,DIM=1),SIZE(C,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,C
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(C,DIM=1)
         DO K = 1, SIZE(C,DIM=2)
            CALL FMDP2M(REAL(C(J,K),KIND(0.0D0)),MTLVFM)
            CALL FMDP2M(AIMAG(C(J,K)),MULVFM)
            CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
            CALL ZMADD(MTLVZM,MA%MZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_C2ZM

   FUNCTION FMADD_ZM2ZM(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      TYPE (ZM) :: MB
      TYPE (ZM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,MB
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMADD(MA(J,K)%MZM,MB%MZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_ZM2ZM

!             (6) rank 2  +  rank 2

   FUNCTION FMADD_ZM2I2(MA,IVAL)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER, DIMENSION(:,:) :: IVAL
      INTEGER :: J,K
      INTENT (IN) :: MA,IVAL
      TYPE(MULTI), SAVE :: MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA,DIM=1) /= SIZE(IVAL,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(IVAL,DIM=2)) THEN
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                CALL ZMST2M(' UNKNOWN + UNKNOWN i ',RETURN_VALUE(J,K)%MZM)
             ENDDO
          ENDDO
          RETURN
      ENDIF
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMI2M(IVAL(J,K),MTLVZM)
            CALL ZMADD(MA(J,K)%MZM,MTLVZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_ZM2I2

   FUNCTION FMADD_ZM2R2(MA,R)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      REAL, DIMENSION(:,:) :: R
      INTENT (IN) :: MA,R
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA,DIM=1) /= SIZE(R,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(R,DIM=2)) THEN
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                CALL ZMST2M(' UNKNOWN + UNKNOWN i ',RETURN_VALUE(J,K)%MZM)
             ENDDO
          ENDDO
          RETURN
      ENDIF
      CALL FMI2M(0,MULVFM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMSP2M(R(J,K),MTLVFM)
            CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
            CALL ZMADD(MA(J,K)%MZM,MTLVZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_ZM2R2

   FUNCTION FMADD_ZM2D2(MA,D)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      DOUBLE PRECISION, DIMENSION(:,:) :: D
      INTENT (IN) :: MA,D
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA,DIM=1) /= SIZE(D,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(D,DIM=2)) THEN
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                CALL ZMST2M(' UNKNOWN + UNKNOWN i ',RETURN_VALUE(J,K)%MZM)
             ENDDO
          ENDDO
          RETURN
      ENDIF
      CALL FMI2M(0,MULVFM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMDP2M(D(J,K),MTLVFM)
            CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
            CALL ZMADD(MA(J,K)%MZM,MTLVZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_ZM2D2

   FUNCTION FMADD_ZM2Z2(MA,Z)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      COMPLEX, DIMENSION(:,:) :: Z
      INTENT (IN) :: MA,Z
      TYPE(MULTI), SAVE :: MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA,DIM=1) /= SIZE(Z,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(Z,DIM=2)) THEN
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                CALL ZMST2M(' UNKNOWN + UNKNOWN i ',RETURN_VALUE(J,K)%MZM)
             ENDDO
          ENDDO
          RETURN
      ENDIF
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMZ2M(Z(J,K),MTLVZM)
            CALL ZMADD(MA(J,K)%MZM,MTLVZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_ZM2Z2

   FUNCTION FMADD_ZM2C2(MA,C)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      COMPLEX (KIND(0.0D0)), DIMENSION(:,:) :: C
      INTENT (IN) :: MA,C
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA,DIM=1) /= SIZE(C,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(C,DIM=2)) THEN
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                CALL ZMST2M(' UNKNOWN + UNKNOWN i ',RETURN_VALUE(J,K)%MZM)
             ENDDO
          ENDDO
          RETURN
      ENDIF
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMDP2M(REAL(C(J,K),KIND(0.0D0)),MTLVFM)
            CALL FMDP2M(AIMAG(C(J,K)),MULVFM)
            CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
            CALL ZMADD(MA(J,K)%MZM,MTLVZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_ZM2C2

   FUNCTION FMADD_I2ZM2(IVAL,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      INTEGER, DIMENSION(:,:) :: IVAL
      TYPE (ZM), DIMENSION(SIZE(IVAL,DIM=1),SIZE(IVAL,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,IVAL
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA,DIM=1) /= SIZE(IVAL,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(IVAL,DIM=2)) THEN
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                CALL ZMST2M(' UNKNOWN + UNKNOWN i ',RETURN_VALUE(J,K)%MZM)
             ENDDO
          ENDDO
          RETURN
      ENDIF
      CALL FMI2M(0,MULVFM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMI2M(IVAL(J,K),MTLVFM)
            CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
            CALL ZMADD(MTLVZM,MA(J,K)%MZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_I2ZM2

   FUNCTION FMADD_R2ZM2(R,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      REAL, DIMENSION(:,:) :: R
      TYPE (ZM), DIMENSION(SIZE(R,DIM=1),SIZE(R,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,R
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA,DIM=1) /= SIZE(R,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(R,DIM=2)) THEN
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                CALL ZMST2M(' UNKNOWN + UNKNOWN i ',RETURN_VALUE(J,K)%MZM)
             ENDDO
          ENDDO
          RETURN
      ENDIF
      CALL FMI2M(0,MULVFM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMSP2M(R(J,K),MTLVFM)
            CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
            CALL ZMADD(MTLVZM,MA(J,K)%MZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_R2ZM2

   FUNCTION FMADD_D2ZM2(D,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      DOUBLE PRECISION, DIMENSION(:,:) :: D
      TYPE (ZM), DIMENSION(SIZE(D,DIM=1),SIZE(D,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,D
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA,DIM=1) /= SIZE(D,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(D,DIM=2)) THEN
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                CALL ZMST2M(' UNKNOWN + UNKNOWN i ',RETURN_VALUE(J,K)%MZM)
             ENDDO
          ENDDO
          RETURN
      ENDIF
      CALL FMI2M(0,MULVFM)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMDP2M(D(J,K),MTLVFM)
            CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
            CALL ZMADD(MTLVZM,MA(J,K)%MZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_D2ZM2

   FUNCTION FMADD_Z2ZM2(Z,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      COMPLEX, DIMENSION(:,:) :: Z
      TYPE (ZM), DIMENSION(SIZE(Z,DIM=1),SIZE(Z,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,Z
      TYPE(MULTI), SAVE :: MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA,DIM=1) /= SIZE(Z,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(Z,DIM=2)) THEN
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                CALL ZMST2M(' UNKNOWN + UNKNOWN i ',RETURN_VALUE(J,K)%MZM)
             ENDDO
          ENDDO
          RETURN
      ENDIF
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMZ2M(Z(J,K),MTLVZM)
            CALL ZMADD(MTLVZM,MA(J,K)%MZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_Z2ZM2

   FUNCTION FMADD_C2ZM2(C,MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      COMPLEX (KIND(0.0D0)), DIMENSION(:,:) :: C
      TYPE (ZM), DIMENSION(SIZE(C,DIM=1),SIZE(C,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,C
      TYPE(MULTI), SAVE :: MTLVFM,MULVFM,MTLVZM(2)
      CALL FM_UNDEF_INP(MA)
      IF (SIZE(MA,DIM=1) /= SIZE(C,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(C,DIM=2)) THEN
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                CALL ZMST2M(' UNKNOWN + UNKNOWN i ',RETURN_VALUE(J,K)%MZM)
             ENDDO
          ENDDO
          RETURN
      ENDIF
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMDP2M(REAL(C(J,K),KIND(0.0D0)),MTLVFM)
            CALL FMDP2M(AIMAG(C(J,K)),MULVFM)
            CALL ZMCMPX(MTLVFM,MULVFM,MTLVZM)
            CALL ZMADD(MTLVZM,MA(J,K)%MZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_C2ZM2

   FUNCTION FMADD_ZM2ZM2(MA,MB)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      TYPE (ZM), DIMENSION(:,:) :: MB
      TYPE (ZM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA,MB
      CALL FM_UNDEF_INP(MA)
      CALL FM_UNDEF_INP(MB)
      IF (SIZE(MA,DIM=1) /= SIZE(MB,DIM=1) .OR. SIZE(MA,DIM=2) /= SIZE(MB,DIM=2)) THEN
          DO J = 1, SIZE(MA,DIM=1)
             DO K = 1, SIZE(MA,DIM=2)
                CALL ZMST2M(' UNKNOWN + UNKNOWN i ',RETURN_VALUE(J,K)%MZM)
             ENDDO
          ENDDO
          RETURN
      ENDIF
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMADD(MA(J,K)%MZM,MB(J,K)%MZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_ZM2ZM2

   FUNCTION FMADD_FM1(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      DO J = 1, N
         CALL FMEQ(MA(J)%MFM,RETURN_VALUE(J)%MFM)
      ENDDO
   END FUNCTION FMADD_FM1

   FUNCTION FMADD_IM1(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:) :: MA
      TYPE (IM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      DO J = 1, N
         CALL IMEQ(MA(J)%MIM,RETURN_VALUE(J)%MIM)
      ENDDO
   END FUNCTION FMADD_IM1

   FUNCTION FMADD_ZM1(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA)) :: RETURN_VALUE
      INTEGER :: J,N
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      N = SIZE(MA)
      DO J = 1, N
         CALL ZMEQ(MA(J)%MZM,RETURN_VALUE(J)%MZM)
      ENDDO
   END FUNCTION FMADD_ZM1

   FUNCTION FMADD_FM2(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (FM), DIMENSION(:,:) :: MA
      TYPE (FM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL FMEQ(MA(J,K)%MFM,RETURN_VALUE(J,K)%MFM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_FM2

   FUNCTION FMADD_IM2(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (IM), DIMENSION(:,:) :: MA
      TYPE (IM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL IMEQ(MA(J,K)%MIM,RETURN_VALUE(J,K)%MIM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_IM2

   FUNCTION FMADD_ZM2(MA)     RESULT (RETURN_VALUE)
      USE ModLib_FMVALS
      IMPLICIT NONE
      TYPE (ZM), DIMENSION(:,:) :: MA
      TYPE (ZM), DIMENSION(SIZE(MA,DIM=1),SIZE(MA,DIM=2)) :: RETURN_VALUE
      INTEGER :: J,K
      INTENT (IN) :: MA
      CALL FM_UNDEF_INP(MA)
      DO J = 1, SIZE(MA,DIM=1)
         DO K = 1, SIZE(MA,DIM=2)
            CALL ZMEQ(MA(J,K)%MZM,RETURN_VALUE(J,K)%MZM)
         ENDDO
      ENDDO
   END FUNCTION FMADD_ZM2

 END MODULE ModLib_FMZM_4
